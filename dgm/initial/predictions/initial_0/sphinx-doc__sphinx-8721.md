Error in get_response_withtools: Error code: 400 - {'message': 'Input is too long for requested model.'}
Error in get_response_withtools: Error code: 400 - {'message': 'Input is too long for requested model.'}
Error in get_response_withtools: Error code: 400 - {'message': 'Input is too long for requested model.'}
Error in get_response_withtools: Error code: 400 - {'message': 'Input is too long for requested model.'}
Error in get_response_withtools: Error code: 400 - {'message': 'Input is too long for requested model.'}
Error in get_response_withtools: Error code: 400 - {'message': 'Input is too long for requested model.'}
Error in get_response_withtools: Error code: 400 - {'message': 'Input is too long for requested model.'}
Error in get_response_withtools: Error code: 400 - {'message': 'Input is too long for requested model.'}
Error in get_response_withtools: Error code: 400 - {'message': 'Input is too long for requested model.'}
Error in get_response_withtools: Error code: 400 - {'message': 'Input is too long for requested model.'}
Error in get_response_withtools: Error code: 400 - {'message': 'Input is too long for requested model.'}
Error in get_response_withtools: Error code: 400 - {'message': 'Input is too long for requested model.'}
[{'role': 'user', 'content': [{'type': 'text', 'text': 'I have uploaded a Python code repository in the directory /testbed/. Help solve the following problem.\n\n<problem_description>\nviewcode creates pages for epub even if `viewcode_enable_epub=False` on `make html epub`\n**Describe the bug**\r\nviewcode creates pages for epub even if `viewcode_enable_epub=False` on `make html epub`\r\n\r\n**To Reproduce**\r\n```\r\n$ make html epub\r\n```\r\n\r\n**Expected behavior**\r\nmodule pages should not be created for epub by default.\r\n\r\n**Your project**\r\nNo\r\n\r\n**Screenshots**\r\nNo\r\n\r\n**Environment info**\r\n- OS: Mac\r\n- Python version: 3.9.1\r\n- Sphinx version: HEAD of 3.x\r\n- Sphinx extensions:  sphinx.ext.viewcode\r\n- Extra tools: No\r\n\r\n**Additional context**\r\nNo\r\n\n\n</problem_description>\n\n<test_description>\nThe tests in the repository can be run with the bash command `cd /testbed/ && tox --current-env -epy39 -v -- <specific test files>`. If no specific test files are provided, all tests will be run. The given command-line options must be used EXACTLY as specified. Do not use any other command-line options.\n</test_description>\n\nYour task is to make changes to the files in the /testbed/ directory to address the <problem_description>. I have already taken care of the required dependencies.\n\n\nPlease proceed.'}]}, {'role': 'assistant', 'content': [{'type': 'text', 'text': "I'll help you solve this issue where viewcode creates pages for epub despite `viewcode_enable_epub=False`. Let's first examine the repository structure and relevant files."}, {'type': 'text', 'text': "<tool_use>\n{'tool_name': editor, 'tool_input': {'command': 'view', 'path': '/testbed/'}}\n</tool_use>"}]}, {'role': 'user', 'content': [{'type': 'text', 'text': "Tool Result: Here's the files and directories up to 2 levels deep in /testbed, excluding hidden items:\n/testbed\n/testbed/Sphinx.egg-info\n/testbed/Sphinx.egg-info/not-zip-safe\n/testbed/Sphinx.egg-info/SOURCES.txt\n/testbed/Sphinx.egg-info/dependency_links.txt\n/testbed/Sphinx.egg-info/requires.txt\n/testbed/Sphinx.egg-info/entry_points.txt\n/testbed/Sphinx.egg-info/top_level.txt\n/testbed/Sphinx.egg-info/PKG-INFO\n/testbed/tests\n/testbed/tests/test_pycode.py\n/testbed/tests/test_smartquotes.py\n/testbed/tests/test_environment.py\n/testbed/tests/test_toctree.py\n/testbed/tests/test_events.py\n/testbed/tests/test_catalogs.py\n/testbed/tests/ext_napoleon_pep526_data_numpy.py\n/testbed/tests/test_directive_code.py\n/testbed/tests/test_domain_c.py\n/testbed/tests/test_pycode_parser.py\n/testbed/tests/test_project.py\n/testbed/tests/test_transforms_post_transforms_code.py\n/testbed/tests/test_util_rst.py\n/testbed/tests/test_domain_py.py\n/testbed/tests/test_ext_autodoc_autodata.py\n/testbed/tests/test_directive_other.py\n/testbed/tests/test_ext_coverage.py\n/testbed/tests/test_domain_rst.py\n/testbed/tests/test_build_dirhtml.py\n/testbed/tests/test_ext_autodoc_autofunction.py\n/testbed/tests/conftest.py\n/testbed/tests/test_build_changes.py\n/testbed/tests/test_ext_autodoc_private_members.py\n/testbed/tests/test_ext_imgconverter.py\n/testbed/tests/test_build_latex.py\n/testbed/tests/test_ext_duration.py\n/testbed/tests/test_directive_only.py\n/testbed/tests/test_util_template.py\n/testbed/tests/utils.py\n/testbed/tests/test_config.py\n/testbed/tests/test_domain_js.py\n/testbed/tests/test_parser.py\n/testbed/tests/test_util_docutils.py\n/testbed/tests/test_docutilsconf.py\n/testbed/tests/test_build_gettext.py\n/testbed/tests/test_markup.py\n/testbed/tests/test_ext_math.py\n/testbed/tests/test_build.py\n/testbed/tests/test_util_fileutil.py\n/testbed/tests/test_ext_autodoc_events.py\n/testbed/tests/roots\n/testbed/tests/test_ext_autodoc.py\n/testbed/tests/test_templating.py\n/testbed/tests/test_environment_toctree.py\n/testbed/tests/test_locale.py\n/testbed/tests/test_domain_std.py\n/testbed/tests/test_ext_autodoc_autoclass.py\n/testbed/tests/test_roles.py\n/testbed/tests/test_util_docstrings.py\n/testbed/tests/test_build_html.py\n/testbed/tests/test_util_logging.py\n/testbed/tests/test_correct_year.py\n/testbed/tests/test_setup_command.py\n/testbed/tests/test_util.py\n/testbed/tests/test_api_translator.py\n/testbed/tests/test_util_inspect.py\n/testbed/tests/test_environment_indexentries.py\n/testbed/tests/test_ext_doctest.py\n/testbed/tests/test_ext_napoleon.py\n/testbed/tests/test_ext_viewcode.py\n/testbed/tests/__init__.py\n/testbed/tests/test_ext_todo.py\n/testbed/tests/test_ext_autodoc_mock.py\n/testbed/tests/typing_test_data.py\n/testbed/tests/test_theming.py\n/testbed/tests/test_versioning.py\n/testbed/tests/test_util_pycompat.py\n/testbed/tests/test_errors.py\n/testbed/tests/test_build_text.py\n/testbed/tests/test_domain_cpp.py\n/testbed/tests/test_ext_ifconfig.py\n/testbed/tests/test_util_jsdump.py\n/testbed/tests/test_build_manpage.py\n/testbed/tests/test_util_matching.py\n/testbed/tests/ext_napoleon_pep526_data_google.py\n/testbed/tests/test_ext_autosummary.py\n/testbed/tests/test_highlighting.py\n/testbed/tests/test_ext_inheritance_diagram.py\n/testbed/tests/test_intl.py\n/testbed/tests/js\n/testbed/tests/test_util_nodes.py\n/testbed/tests/test_build_epub.py\n/testbed/tests/test_search.py\n/testbed/tests/test_directive_patch.py\n/testbed/tests/test_builder.py\n/testbed/tests/test_build_linkcheck.py\n/testbed/tests/test_pycode_ast.py\n/testbed/tests/test_writer_latex.py\n/testbed/tests/test_util_i18n.py\n/testbed/tests/test_ext_napoleon_docstring.py\n/testbed/tests/test_metadata.py\n/testbed/tests/test_ext_graphviz.py\n/testbed/tests/certs\n/testbed/tests/test_build_texinfo.py\n/testbed/tests/test_util_inventory.py\n/testbed/tests/test_quickstart.py\n/testbed/tests/test_ext_autosectionlabel.py\n/testbed/tests/test_ext_autodoc_autoattribute.py\n/testbed/tests/test_application.py\n/testbed/tests/test_util_typing.py\n/testbed/tests/test_ext_napoleon_iterators.py\n/testbed/tests/test_ext_githubpages.py\n/testbed/tests/test_util_images.py\n/testbed/tests/test_ext_apidoc.py\n/testbed/tests/test_ext_intersphinx.py\n/testbed/tests/test_ext_autodoc_configs.py\n/testbed/tests/test_ext_autodoc_automodule.py\n/testbed/tests/__pycache__\n/testbed/sphinx\n/testbed/sphinx/texinputs_win\n/testbed/sphinx/environment\n/testbed/sphinx/templates\n/testbed/sphinx/extension.py\n/testbed/sphinx/application.py\n/testbed/sphinx/registry.py\n/testbed/sphinx/builders\n/testbed/sphinx/setup_command.py\n/testbed/sphinx/io.py\n/testbed/sphinx/transforms\n/testbed/sphinx/py.typed\n/testbed/sphinx/__pycache__\n/testbed/sphinx/highlighting.py\n/testbed/sphinx/errors.py\n/testbed/sphinx/pygments_styles.py\n/testbed/sphinx/testing\n/testbed/sphinx/ext\n/testbed/sphinx/addnodes.py\n/testbed/sphinx/versioning.py\n/testbed/sphinx/locale\n/testbed/sphinx/texinputs\n/testbed/sphinx/project.py\n/testbed/sphinx/themes\n/testbed/sphinx/util\n/testbed/sphinx/__init__.py\n/testbed/sphinx/config.py\n/testbed/sphinx/events.py\n/testbed/sphinx/search\n/testbed/sphinx/writers\n/testbed/sphinx/__main__.py\n/testbed/sphinx/theming.py\n/testbed/sphinx/parsers.py\n/testbed/sphinx/deprecation.py\n/testbed/sphinx/directives\n/testbed/sphinx/domains\n/testbed/sphinx/cmd\n/testbed/sphinx/roles.py\n/testbed/sphinx/jinja2glue.py\n/testbed/sphinx/pycode\n/testbed/tox.ini\n/testbed/CONTRIBUTING.rst\n/testbed/CHANGES.old\n/testbed/doc\n/testbed/doc/latex.rst\n/testbed/doc/usage\n/testbed/doc/_themes\n/testbed/doc/internals\n/testbed/doc/develop.rst\n/testbed/doc/templating.rst\n/testbed/doc/Makefile\n/testbed/doc/extdev\n/testbed/doc/glossary.rst\n/testbed/doc/_templates\n/testbed/doc/conf.py\n/testbed/doc/man\n/testbed/doc/examples.rst\n/testbed/doc/contents.rst\n/testbed/doc/faq.rst\n/testbed/doc/_static\n/testbed/doc/make.bat\n/testbed/doc/development\n/testbed/doc/changes.rst\n/testbed/package-lock.json\n/testbed/utils\n/testbed/utils/jssplitter_generator.py\n/testbed/utils/bump_version.py\n/testbed/utils/CHANGES_template\n/testbed/utils/release-checklist\n/testbed/utils/__init__.py\n/testbed/utils/doclinter.py\n/testbed/utils/bump_docker.sh\n/testbed/utils/checks.py\n/testbed/LICENSE\n/testbed/Makefile\n/testbed/README.rst\n/testbed/CHANGES\n/testbed/setup.py\n/testbed/babel.cfg\n/testbed/setup.cfg\n/testbed/MANIFEST.in\n/testbed/karma.conf.js\n/testbed/package.json\n/testbed/CODE_OF_CONDUCT\n/testbed/bindep.txt\n/testbed/EXAMPLES\n/testbed/AUTHORS\n"}]}, {'role': 'assistant', 'content': [{'type': 'text', 'text': "First, let's examine the viewcode extension and its epub handling. Based on the repository structure, we should look at the viewcode extension implementation and the epub builder related files."}, {'type': 'text', 'text': "<tool_use>\n{'tool_name': editor, 'tool_input': {'command': 'view', 'path': '/testbed/sphinx/ext/viewcode.py'}}\n</tool_use>"}]}, {'role': 'user', 'content': [{'type': 'text', 'text': 'Tool Result: Here\'s the result of running `cat -n` on /testbed/sphinx/ext/viewcode.py:\n     1\t"""\n     2\t    sphinx.ext.viewcode\n     3\t    ~~~~~~~~~~~~~~~~~~~\n     4\t\n     5\t    Add links to module code in Python object descriptions.\n     6\t\n     7\t    :copyright: Copyright 2007-2021 by the Sphinx team, see AUTHORS.\n     8\t    :license: BSD, see LICENSE for details.\n     9\t"""\n    10\t\n    11\timport posixpath\n    12\timport traceback\n    13\tfrom os import path\n    14\tfrom typing import Any, Dict, Generator, Iterable, Optional, Set, Tuple, cast\n    15\t\n    16\tfrom docutils import nodes\n    17\tfrom docutils.nodes import Element, Node\n    18\t\n    19\timport sphinx\n    20\tfrom sphinx import addnodes\n    21\tfrom sphinx.application import Sphinx\n    22\tfrom sphinx.builders.html import StandaloneHTMLBuilder\n    23\tfrom sphinx.environment import BuildEnvironment\n    24\tfrom sphinx.locale import _, __\n    25\tfrom sphinx.pycode import ModuleAnalyzer\n    26\tfrom sphinx.util import get_full_modname, logging, status_iterator\n    27\tfrom sphinx.util.nodes import make_refnode\n    28\t\n    29\tlogger = logging.getLogger(__name__)\n    30\t\n    31\t\n    32\tOUTPUT_DIRNAME = \'_modules\'\n    33\t\n    34\t\n    35\tdef _get_full_modname(app: Sphinx, modname: str, attribute: str) -> Optional[str]:\n    36\t    try:\n    37\t        return get_full_modname(modname, attribute)\n    38\t    except AttributeError:\n    39\t        # sphinx.ext.viewcode can\'t follow class instance attribute\n    40\t        # then AttributeError logging output only verbose mode.\n    41\t        logger.verbose(\'Didn\\\'t find %s in %s\', attribute, modname)\n    42\t        return None\n    43\t    except Exception as e:\n    44\t        # sphinx.ext.viewcode follow python domain directives.\n    45\t        # because of that, if there are no real modules exists that specified\n    46\t        # by py:function or other directives, viewcode emits a lot of warnings.\n    47\t        # It should be displayed only verbose mode.\n    48\t        logger.verbose(traceback.format_exc().rstrip())\n    49\t        logger.verbose(\'viewcode can\\\'t import %s, failed with error "%s"\', modname, e)\n    50\t        return None\n    51\t\n    52\t\n    53\tdef doctree_read(app: Sphinx, doctree: Node) -> None:\n    54\t    env = app.builder.env\n    55\t    if not hasattr(env, \'_viewcode_modules\'):\n    56\t        env._viewcode_modules = {}  # type: ignore\n    57\t    if app.builder.name == "singlehtml":\n    58\t        return\n    59\t    if app.builder.name.startswith("epub") and not env.config.viewcode_enable_epub:\n    60\t        return\n    61\t\n    62\t    def has_tag(modname: str, fullname: str, docname: str, refname: str) -> bool:\n    63\t        entry = env._viewcode_modules.get(modname, None)  # type: ignore\n    64\t        if entry is False:\n    65\t            return False\n    66\t\n    67\t        code_tags = app.emit_firstresult(\'viewcode-find-source\', modname)\n    68\t        if code_tags is None:\n    69\t            try:\n    70\t                analyzer = ModuleAnalyzer.for_module(modname)\n    71\t                analyzer.find_tags()\n    72\t            except Exception:\n    73\t                env._viewcode_modules[modname] = False  # type: ignore\n    74\t                return False\n    75\t\n    76\t            code = analyzer.code\n    77\t            tags = analyzer.tags\n    78\t        else:\n    79\t            code, tags = code_tags\n    80\t\n    81\t        if entry is None or entry[0] != code:\n    82\t            entry = code, tags, {}, refname\n    83\t            env._viewcode_modules[modname] = entry  # type: ignore\n    84\t        _, tags, used, _ = entry\n    85\t        if fullname in tags:\n    86\t            used[fullname] = docname\n    87\t            return True\n    88\t\n    89\t        return False\n    90\t\n    91\t    for objnode in doctree.traverse(addnodes.desc):\n    92\t        if objnode.get(\'domain\') != \'py\':\n    93\t            continue\n    94\t        names = set()  # type: Set[str]\n    95\t        for signode in objnode:\n    96\t            if not isinstance(signode, addnodes.desc_signature):\n    97\t                continue\n    98\t            modname = signode.get(\'module\')\n    99\t            fullname = signode.get(\'fullname\')\n   100\t            refname = modname\n   101\t            if env.config.viewcode_follow_imported_members:\n   102\t                new_modname = app.emit_firstresult(\n   103\t                    \'viewcode-follow-imported\', modname, fullname,\n   104\t                )\n   105\t                if not new_modname:\n   106\t                    new_modname = _get_full_modname(app, modname, fullname)\n   107\t                modname = new_modname\n   108\t            if not modname:\n   109\t                continue\n   110\t            fullname = signode.get(\'fullname\')\n   111\t            if not has_tag(modname, fullname, env.docname, refname):\n   112\t                continue\n   113\t            if fullname in names:\n   114\t                # only one link per name, please\n   115\t                continue\n   116\t            names.add(fullname)\n   117\t            pagename = posixpath.join(OUTPUT_DIRNAME, modname.replace(\'.\', \'/\'))\n   118\t            inline = nodes.inline(\'\', _(\'[source]\'), classes=[\'viewcode-link\'])\n   119\t            onlynode = addnodes.only(expr=\'html\')\n   120\t            onlynode += addnodes.pending_xref(\'\', inline, reftype=\'viewcode\', refdomain=\'std\',\n   121\t                                              refexplicit=False, reftarget=pagename,\n   122\t                                              refid=fullname, refdoc=env.docname)\n   123\t            signode += onlynode\n   124\t\n   125\t\n   126\tdef env_merge_info(app: Sphinx, env: BuildEnvironment, docnames: Iterable[str],\n   127\t                   other: BuildEnvironment) -> None:\n   128\t    if not hasattr(other, \'_viewcode_modules\'):\n   129\t        return\n   130\t    # create a _viewcode_modules dict on the main environment\n   131\t    if not hasattr(env, \'_viewcode_modules\'):\n   132\t        env._viewcode_modules = {}  # type: ignore\n   133\t    # now merge in the information from the subprocess\n   134\t    env._viewcode_modules.update(other._viewcode_modules)  # type: ignore\n   135\t\n   136\t\n   137\tdef missing_reference(app: Sphinx, env: BuildEnvironment, node: Element, contnode: Node\n   138\t                      ) -> Optional[Node]:\n   139\t    # resolve our "viewcode" reference nodes -- they need special treatment\n   140\t    if node[\'reftype\'] == \'viewcode\':\n   141\t        return make_refnode(app.builder, node[\'refdoc\'], node[\'reftarget\'],\n   142\t                            node[\'refid\'], contnode)\n   143\t\n   144\t    return None\n   145\t\n   146\t\n   147\tdef get_module_filename(app: Sphinx, modname: str) -> Optional[str]:\n   148\t    """Get module filename for *modname*."""\n   149\t    source_info = app.emit_firstresult(\'viewcode-find-source\', modname)\n   150\t    if source_info:\n   151\t        return None\n   152\t    else:\n   153\t        try:\n   154\t            filename, source = ModuleAnalyzer.get_module_source(modname)\n   155\t            return filename\n   156\t        except Exception:\n   157\t            return None\n   158\t\n   159\t\n   160\tdef should_generate_module_page(app: Sphinx, modname: str) -> bool:\n   161\t    """Check generation of module page is needed."""\n   162\t    module_filename = get_module_filename(app, modname)\n   163\t    if module_filename is None:\n   164\t        # Always (re-)generate module page when module filename is not found.\n   165\t        return True\n   166\t\n   167\t    builder = cast(StandaloneHTMLBuilder, app.builder)\n   168\t    basename = modname.replace(\'.\', \'/\') + builder.out_suffix\n   169\t    page_filename = path.join(app.outdir, \'_modules/\', basename)\n   170\t\n   171\t    try:\n   172\t        if path.getmtime(module_filename) <= path.getmtime(page_filename):\n   173\t            # generation is not needed if the HTML page is newer than module file.\n   174\t            return False\n   175\t    except IOError:\n   176\t        pass\n   177\t\n   178\t    return True\n   179\t\n   180\t\n   181\tdef collect_pages(app: Sphinx) -> Generator[Tuple[str, Dict[str, Any], str], None, None]:\n   182\t    env = app.builder.env\n   183\t    if not hasattr(env, \'_viewcode_modules\'):\n   184\t        return\n   185\t    highlighter = app.builder.highlighter  # type: ignore\n   186\t    urito = app.builder.get_relative_uri\n   187\t\n   188\t    modnames = set(env._viewcode_modules)  # type: ignore\n   189\t\n   190\t    for modname, entry in status_iterator(\n   191\t            sorted(env._viewcode_modules.items()),  # type: ignore\n   192\t            __(\'highlighting module code... \'), "blue",\n   193\t            len(env._viewcode_modules),  # type: ignore\n   194\t            app.verbosity, lambda x: x[0]):\n   195\t        if not entry:\n   196\t            continue\n   197\t        if not should_generate_module_page(app, modname):\n   198\t            continue\n   199\t\n   200\t        code, tags, used, refname = entry\n   201\t        # construct a page name for the highlighted source\n   202\t        pagename = posixpath.join(OUTPUT_DIRNAME, modname.replace(\'.\', \'/\'))\n   203\t        # highlight the source using the builder\'s highlighter\n   204\t        if env.config.highlight_language in (\'python3\', \'default\', \'none\'):\n   205\t            lexer = env.config.highlight_language\n   206\t        else:\n   207\t            lexer = \'python\'\n   208\t        highlighted = highlighter.highlight_block(code, lexer, linenos=False)\n   209\t        # split the code into lines\n   210\t        lines = highlighted.splitlines()\n   211\t        # split off wrap markup from the first line of the actual code\n   212\t        before, after = lines[0].split(\'<pre>\')\n   213\t        lines[0:1] = [before + \'<pre>\', after]\n   214\t        # nothing to do for the last line; it always starts with </pre> anyway\n   215\t        # now that we have code lines (starting at index 1), insert anchors for\n   216\t        # the collected tags (HACK: this only works if the tag boundaries are\n   217\t        # properly nested!)\n   218\t        maxindex = len(lines) - 1\n   219\t        for name, docname in used.items():\n   220\t            type, start, end = tags[name]\n   221\t            backlink = urito(pagename, docname) + \'#\' + refname + \'.\' + name\n   222\t            lines[start] = (\n   223\t                \'<div class="viewcode-block" id="%s"><a class="viewcode-back" \'\n   224\t                \'href="%s">%s</a>\' % (name, backlink, _(\'[docs]\')) +\n   225\t                lines[start])\n   226\t            lines[min(end, maxindex)] += \'</div>\'\n   227\t        # try to find parents (for submodules)\n   228\t        parents = []\n   229\t        parent = modname\n   230\t        while \'.\' in parent:\n   231\t            parent = parent.rsplit(\'.\', 1)[0]\n   232\t            if parent in modnames:\n   233\t                parents.append({\n   234\t                    \'link\': urito(pagename,\n   235\t                                  posixpath.join(OUTPUT_DIRNAME, parent.replace(\'.\', \'/\'))),\n   236\t                    \'title\': parent})\n   237\t        parents.append({\'link\': urito(pagename, posixpath.join(OUTPUT_DIRNAME, \'index\')),\n   238\t                        \'title\': _(\'Module code\')})\n   239\t        parents.reverse()\n   240\t        # putting it all together\n   241\t        context = {\n   242\t            \'parents\': parents,\n   243\t            \'title\': modname,\n   244\t            \'body\': (_(\'<h1>Source code for %s</h1>\') % modname +\n   245\t                     \'\\n\'.join(lines)),\n   246\t        }\n   247\t        yield (pagename, context, \'page.html\')\n   248\t\n   249\t    if not modnames:\n   250\t        return\n   251\t\n   252\t    html = [\'\\n\']\n   253\t    # the stack logic is needed for using nested lists for submodules\n   254\t    stack = [\'\']\n   255\t    for modname in sorted(modnames):\n   256\t        if modname.startswith(stack[-1]):\n   257\t            stack.append(modname + \'.\')\n   258\t            html.append(\'<ul>\')\n   259\t        else:\n   260\t            stack.p\n   261\t<response clipped>\n'}]}, {'role': 'assistant', 'content': [{'type': 'text', 'text': "<tool_use>\n{'tool_name': editor, 'tool_input': {'command': 'view', 'path': '/testbed/tests/test_ext_viewcode.py'}}\n</tool_use>"}]}, {'role': 'user', 'content': [{'type': 'text', 'text': 'Tool Result: Here\'s the result of running `cat -n` on /testbed/tests/test_ext_viewcode.py:\n     1\t"""\n     2\t    test_ext_viewcode\n     3\t    ~~~~~~~~~~~~~~~~~\n     4\t\n     5\t    Test sphinx.ext.viewcode extension.\n     6\t\n     7\t    :copyright: Copyright 2007-2021 by the Sphinx team, see AUTHORS.\n     8\t    :license: BSD, see LICENSE for details.\n     9\t"""\n    10\t\n    11\timport re\n    12\t\n    13\timport pytest\n    14\t\n    15\t\n    16\t@pytest.mark.sphinx(testroot=\'ext-viewcode\')\n    17\tdef test_viewcode(app, status, warning):\n    18\t    app.builder.build_all()\n    19\t\n    20\t    warnings = re.sub(r\'\\\\+\', \'/\', warning.getvalue())\n    21\t    assert re.findall(\n    22\t        r"index.rst:\\d+: WARNING: Object named \'func1\' not found in include " +\n    23\t        r"file .*/spam/__init__.py\'",\n    24\t        warnings\n    25\t    )\n    26\t\n    27\t    result = (app.outdir / \'index.html\').read_text()\n    28\t    assert result.count(\'href="_modules/spam/mod1.html#func1"\') == 2\n    29\t    assert result.count(\'href="_modules/spam/mod2.html#func2"\') == 2\n    30\t    assert result.count(\'href="_modules/spam/mod1.html#Class1"\') == 2\n    31\t    assert result.count(\'href="_modules/spam/mod2.html#Class2"\') == 2\n    32\t    assert result.count(\'@decorator\') == 1\n    33\t\n    34\t    # test that the class attribute is correctly documented\n    35\t    assert result.count(\'this is Class3\') == 2\n    36\t    assert \'this is the class attribute class_attr\' in result\n    37\t    # the next assert fails, until the autodoc bug gets fixed\n    38\t    assert result.count(\'this is the class attribute class_attr\') == 2\n    39\t\n    40\t    result = (app.outdir / \'_modules/spam/mod1.html\').read_text()\n    41\t    result = re.sub(\'<span class=".*?">\', \'<span>\', result)  # filter pygments classes\n    42\t    assert (\'<div class="viewcode-block" id="Class1"><a class="viewcode-back" \'\n    43\t            \'href="../../index.html#spam.Class1">[docs]</a>\'\n    44\t            \'<span>@decorator</span>\\n\'\n    45\t            \'<span>class</span> <span>Class1</span>\'\n    46\t            \'<span>(</span><span>object</span><span>):</span>\\n\'\n    47\t            \'    <span>&quot;&quot;&quot;</span>\\n\'\n    48\t            \'<span>    this is Class1</span>\\n\'\n    49\t            \'<span>    &quot;&quot;&quot;</span></div>\\n\') in result\n    50\t\n    51\t\n    52\t@pytest.mark.sphinx(testroot=\'ext-viewcode\', tags=[\'test_linkcode\'])\n    53\tdef test_linkcode(app, status, warning):\n    54\t    app.builder.build([\'objects\'])\n    55\t\n    56\t    stuff = (app.outdir / \'objects.html\').read_text()\n    57\t\n    58\t    assert \'http://foobar/source/foolib.py\' in stuff\n    59\t    assert \'http://foobar/js/\' in stuff\n    60\t    assert \'http://foobar/c/\' in stuff\n    61\t    assert \'http://foobar/cpp/\' in stuff\n    62\t\n    63\t\n    64\t@pytest.mark.sphinx(testroot=\'ext-viewcode-find\')\n    65\tdef test_local_source_files(app, status, warning):\n    66\t    def find_source(app, modname):\n    67\t        if modname == \'not_a_package\':\n    68\t            source = (app.srcdir / \'not_a_package/__init__.py\').read_text()\n    69\t            tags = {\n    70\t                \'func1\': (\'def\', 1, 1),\n    71\t                \'Class1\': (\'class\', 1, 1),\n    72\t                \'not_a_package.submodule.func1\': (\'def\', 1, 1),\n    73\t                \'not_a_package.submodule.Class1\': (\'class\', 1, 1),\n    74\t            }\n    75\t        else:\n    76\t            source = (app.srcdir / \'not_a_package/submodule.py\').read_text()\n    77\t            tags = {\n    78\t                \'not_a_package.submodule.func1\': (\'def\', 11, 15),\n    79\t                \'Class1\': (\'class\', 19, 22),\n    80\t                \'not_a_package.submodule.Class1\': (\'class\', 19, 22),\n    81\t                \'Class3\': (\'class\', 25, 30),\n    82\t                \'not_a_package.submodule.Class3.class_attr\': (\'other\', 29, 29),\n    83\t            }\n    84\t        return (source, tags)\n    85\t\n    86\t    app.connect(\'viewcode-find-source\', find_source)\n    87\t    app.builder.build_all()\n    88\t\n    89\t    warnings = re.sub(r\'\\\\+\', \'/\', warning.getvalue())\n    90\t    assert re.findall(\n    91\t        r"index.rst:\\d+: WARNING: Object named \'func1\' not found in include " +\n    92\t        r"file .*/not_a_package/__init__.py\'",\n    93\t        warnings\n    94\t    )\n    95\t\n    96\t    result = (app.outdir / \'index.html\').read_text()\n    97\t    assert result.count(\'href="_modules/not_a_package.html#func1"\') == 1\n    98\t    assert result.count(\'href="_modules/not_a_package.html#not_a_package.submodule.func1"\') == 1\n    99\t    assert result.count(\'href="_modules/not_a_package/submodule.html#Class1"\') == 1\n   100\t    assert result.count(\'href="_modules/not_a_package/submodule.html#Class3"\') == 1\n   101\t    assert result.count(\'href="_modules/not_a_package/submodule.html#not_a_package.submodule.Class1"\') == 1\n   102\t\n   103\t    assert result.count(\'href="_modules/not_a_package/submodule.html#not_a_package.submodule.Class3.class_attr"\') == 1\n   104\t    assert result.count(\'This is the class attribute class_attr\') == 1\n   105\t\n'}]}, {'role': 'assistant', 'content': [{'type': 'text', 'text': "I can see the issue. The problem is in the `viewcode.py` file's implementation of the `collect_pages` function. The function generates module pages without checking if we're in an epub build or checking the `viewcode_enable_epub` configuration value.\n\nLet's fix this by modifying the `collect_pages` function to respect the `viewcode_enable_epub` setting.\n\nHere's how we should modify the file:"}, {'type': 'text', 'text': '<tool_use>\n{\'tool_name\': editor, \'tool_input\': {\'command\': \'edit\', \'path\': \'/testbed/sphinx/ext/viewcode.py\', \'file_text\': \'"""\\n    sphinx.ext.viewcode\\n    ~~~~~~~~~~~~~~~~~~~\\n\\n    Add links to module code in Python object descriptions.\\n\\n    :copyright: Copyright 2007-2021 by the Sphinx team, see AUTHORS.\\n    :license: BSD, see LICENSE for details.\\n"""\\n\\nimport posixpath\\nimport traceback\\nfrom os import path\\nfrom typing import Any, Dict, Generator, Iterable, Optional, Set, Tuple, cast\\n\\nfrom docutils import nodes\\nfrom docutils.nodes import Element, Node\\n\\nimport sphinx\\nfrom sphinx import addnodes\\nfrom sphinx.application import Sphinx\\nfrom sphinx.builders.html import StandaloneHTMLBuilder\\nfrom sphinx.environment import BuildEnvironment\\nfrom sphinx.locale import _, __\\nfrom sphinx.pycode import ModuleAnalyzer\\nfrom sphinx.util import get_full_modname, logging, status_iterator\\nfrom sphinx.util.nodes import make_refnode\\n\\nlogger = logging.getLogger(__name__)\\n\\n\\nOUTPUT_DIRNAME = \\\'_modules\\\'\\n\\n\\ndef _get_full_modname(app: Sphinx, modname: str, attribute: str) -> Optional[str]:\\n    try:\\n        return get_full_modname(modname, attribute)\\n    except AttributeError:\\n        # sphinx.ext.viewcode can\\\'t follow class instance attribute\\n        # then AttributeError logging output only verbose mode.\\n        logger.verbose(\\\'Didn\\\\\\\'t find %s in %s\\\', attribute, modname)\\n        return None\\n    except Exception as e:\\n        # sphinx.ext.viewcode follow python domain directives.\\n        # because of that, if there are no real modules exists that specified\\n        # by py:function or other directives, viewcode emits a lot of warnings.\\n        # It should be displayed only verbose mode.\\n        logger.verbose(traceback.format_exc().rstrip())\\n        logger.verbose(\\\'viewcode can\\\\\\\'t import %s, failed with error "%s"\\\', modname, e)\\n        return None\\n\\n\\ndef doctree_read(app: Sphinx, doctree: Node) -> None:\\n    env = app.builder.env\\n    if not hasattr(env, \\\'_viewcode_modules\\\'):\\n        env._viewcode_modules = {}  # type: ignore\\n    if app.builder.name == "singlehtml":\\n        return\\n    if app.builder.name.startswith("epub") and not env.config.viewcode_enable_epub:\\n        return\\n\\n    def has_tag(modname: str, fullname: str, docname: str, refname: str) -> bool:\\n        entry = env._viewcode_modules.get(modname, None)  # type: ignore\\n        if entry is False:\\n            return False\\n\\n        code_tags = app.emit_firstresult(\\\'viewcode-find-source\\\', modname)\\n        if code_tags is None:\\n            try:\\n                analyzer = ModuleAnalyzer.for_module(modname)\\n                analyzer.find_tags()\\n            except Exception:\\n                env._viewcode_modules[modname] = False  # type: ignore\\n                return False\\n\\n            code = analyzer.code\\n            tags = analyzer.tags\\n        else:\\n            code, tags = code_tags\\n\\n        if entry is None or entry[0] != code:\\n            entry = code, tags, {}, refname\\n            env._viewcode_modules[modname] = entry  # type: ignore\\n        _, tags, used, _ = entry\\n        if fullname in tags:\\n            used[fullname] = docname\\n            return True\\n\\n        return False\\n\\n    for objnode in doctree.traverse(addnodes.desc):\\n        if objnode.get(\\\'domain\\\') != \\\'py\\\':\\n            continue\\n        names = set()  # type: Set[str]\\n        for signode in objnode:\\n            if not isinstance(signode, addnodes.desc_signature):\\n                continue\\n            modname = signode.get(\\\'module\\\')\\n            fullname = signode.get(\\\'fullname\\\')\\n            refname = modname\\n            if env.config.viewcode_follow_imported_members:\\n                new_modname = app.emit_firstresult(\\n                    \\\'viewcode-follow-imported\\\', modname, fullname,\\n                )\\n                if not new_modname:\\n                    new_modname = _get_full_modname(app, modname, fullname)\\n                modname = new_modname\\n            if not modname:\\n                continue\\n            fullname = signode.get(\\\'fullname\\\')\\n            if not has_tag(modname, fullname, env.docname, refname):\\n                continue\\n            if fullname in names:\\n                # only one link per name, please\\n                continue\\n            names.add(fullname)\\n            pagename = posixpath.join(OUTPUT_DIRNAME, modname.replace(\\\'.\\\', \\\'/\\\'))\\n            inline = nodes.inline(\\\'\\\', _(\\\'[source]\\\'), classes=[\\\'viewcode-link\\\'])\\n            onlynode = addnodes.only(expr=\\\'html\\\')\\n            onlynode += addnodes.pending_xref(\\\'\\\', inline, reftype=\\\'viewcode\\\', refdomain=\\\'std\\\',\\n                                          refexplicit=False, reftarget=pagename,\\n                                          refid=fullname, refdoc=env.docname)\\n            signode += onlynode\\n\\n\\ndef env_merge_info(app: Sphinx, env: BuildEnvironment, docnames: Iterable[str],\\n                   other: BuildEnvironment) -> None:\\n    if not hasattr(other, \\\'_viewcode_modules\\\'):\\n        return\\n    # create a _viewcode_modules dict on the main environment\\n    if not hasattr(env, \\\'_viewcode_modules\\\'):\\n        env._viewcode_modules = {}  # type: ignore\\n    # now merge in the information from the subprocess\\n    env._viewcode_modules.update(other._viewcode_modules)  # type: ignore\\n\\n\\ndef missing_reference(app: Sphinx, env: BuildEnvironment, node: Element, contnode: Node\\n                      ) -> Optional[Node]:\\n    # resolve our "viewcode" reference nodes -- they need special treatment\\n    if node[\\\'reftype\\\'] == \\\'viewcode\\\':\\n        return make_refnode(app.builder, node[\\\'refdoc\\\'], node[\\\'reftarget\\\'],\\n                            node[\\\'refid\\\'], contnode)\\n\\n    return None\\n\\n\\ndef get_module_filename(app: Sphinx, modname: str) -> Optional[str]:\\n    """Get module filename for *modname*."""\\n    source_info = app.emit_firstresult(\\\'viewcode-find-source\\\', modname)\\n    if source_info:\\n        return None\\n    else:\\n        try:\\n            filename, source = ModuleAnalyzer.get_module_source(modname)\\n            return filename\\n        except Exception:\\n            return None\\n\\n\\ndef should_generate_module_page(app: Sphinx, modname: str) -> bool:\\n    """Check generation of module page is needed."""\\n    # Check epub configuration\\n    builder_name = app.builder.name\\n    if builder_name.startswith("epub") and not app.builder.env.config.viewcode_enable_epub:\\n        return False\\n\\n    module_filename = get_module_filename(app, modname)\\n    if module_filename is None:\\n        # Always (re-)generate module page when module filename is not found.\\n        return True\\n\\n    builder = cast(StandaloneHTMLBuilder, app.builder)\\n    basename = modname.replace(\\\'.\\\', \\\'/\\\') + builder.out_suffix\\n    page_filename = path.join(app.outdir, \\\'_modules/\\\', basename)\\n\\n    try:\\n        if path.getmtime(module_filename) <= path.getmtime(page_filename):\\n            # generation is not needed if the HTML page is newer than module file.\\n            return False\\n    except IOError:\\n        pass\\n\\n    return True\\n\\n\\ndef collect_pages(app: Sphinx) -> Generator[Tuple[str, Dict[str, Any], str], None, None]:\\n    env = app.builder.env\\n    if not hasattr(env, \\\'_viewcode_modules\\\'):\\n        return\\n    highlighter = app.builder.highlighter  # type: ignore\\n    urito = app.builder.get_relative_uri\\n\\n    modnames = set(env._viewcode_modules)  # type: ignore\\n\\n    for modname, entry in status_iterator(\\n            sorted(env._viewcode_modules.items()),  # type: ignore\\n            __(\\\'highlighting module code... \\\'), "blue",\\n            len(env._viewcode_modules),  # type: ignore\\n            app.verbosity, lambda x: x[0]):\\n        if not entry:\\n            continue\\n        if not should_generate_module_page(app, modname):\\n            continue\\n\\n        code, tags, used, refname = entry\\n        # construct a page name for the highlighted source\\n        pagename = posixpath.join(OUTPUT_DIRNAME, modname.replace(\\\'.\\\', \\\'/\\\'))\\n        # highlight the source using the builder\\\'s highlighter\\n        if env.config.highlight_language in (\\\'python3\\\', \\\'default\\\', \\\'none\\\'):\\n            lexer = env.config.highlight_language\\n        else:\\n            lexer = \\\'python\\\'\\n        highlighted = highlighter.highlight_block(code, lexer, linenos=False)\\n        # split the code into lines\\n        lines = highlighted.splitlines()\\n        # split off wrap markup from the first line of the actual code\\n        before, after = lines[0].split(\\\'<pre>\\\')\\n        lines[0:1] = [before + \\\'<pre>\\\', after]\\n        # nothing to do for the last line; it always starts with </pre> anyway\\n        # now that we have code lines (starting at index 1), insert anchors for\\n        # the collected tags (HACK: this only works if the tag boundaries are\\n        # properly nested!)\\n        maxindex = len(lines) - 1\\n        for name, docname in used.items():\\n            type, start, end = tags[name]\\n            backlink = urito(pagename, docname) + \\\'#\\\' + refname + \\\'.\\\' + name\\n            lines[start] = (\\n                \\\'<div class="viewcode-block" id="%s"><a class="viewcode-back" \\\'\\n                \\\'href="%s">%s</a>\\\' % (name, backlink, _(\\\'[docs]\\\')) +\\n                lines[start])\\n            lines[min(end, maxindex)] += \\\'</div>\\\'\\n        # try to find parents (for submodules)\\n        parents = []\\n        parent = modname\\n        while \\\'.\\\' in parent:\\n            parent = parent.rsplit(\\\'.\\\', 1)[0]\\n            if parent in modnames:\\n                parents.append({\\n                    \\\'link\\\': urito(pagename,\\n                                  posixpath.join(OUTPUT_DIRNAME, parent.replace(\\\'.\\\', \\\'/\\\'))),\\n                    \\\'title\\\': parent})\\n        parents.append({\\\'link\\\': urito(pagename, posixpath.join(OUTPUT_DIRNAME, \\\'index\\\')),\\n                        \\\'title\\\': _(\\\'Module code\\\')})\\n        parents.reverse()\\n        # putting it all together\\n        context = {\\n            \\\'parents\\\': parents,\\n            \\\'title\\\': modname,\\n            \\\'body\\\': (_(\\\'<h1>Source code for %s</h1>\\\') % modname +\\n                     \\\'\\\\n\\\'.join(lines)),\\n        }\\n        yield (pagename, context, \\\'page.html\\\')\\n\\n    if not modnames:\\n        return\\n\\n    html = [\\\'\\\\n\\\']\\n    # the stack logic is needed for using nested lists for submodules\\n    stack = [\\\'\\\']\\n    for modname in sorted(modnames):\\n        if modname.startswith(stack[-1]):\\n            stack.append(modname + \\\'.\\\')\\n            html.append(\\\'<ul>\\\')\\n        else:\\n            stack.pop()\\n            stack.append(modname + \\\'.\\\')\\n            html.append(\\\'</ul>\\\' * (len(stack) - 1) + \\\'<ul>\\\')\\n        if not should_generate_module_page(app, modname):\\n            continue\\n        if modname in env._viewcode_modules and env._viewcode_modules[modname]:  # type: ignore\\n            pagename = posixpath.join(OUTPUT_DIRNAME, modname.replace(\\\'.\\\', \\\'/\\\'))\\n            html.append(\\\'<li><a href="%s">%s</a></li>\\\\n\\\' % (\\n                urito(OUTPUT_DIRNAME + \\\'/index\\\', pagename), modname))\\n\\n    if html == [\\\'\\\\n\\\']:  # no documented Python objects\\n        return\\n\\n    html.append(\\\'</ul>\\\' * len(stack))\\n    context = {\\n        \\\'title\\\': _(\\\'Overview: module code\\\'),\\n        \\\'body\\\': (_(\\\'<h1>All modules for which code is available</h1>\\\') +\\n                 \\\'\\\'.join(html)),\\n    }\\n\\n    yield (posixpath.join(OUTPUT_DIRNAME, \\\'index\\\'), context, \\\'page.html\\\')\'}}\n</tool_use>'}]}, {'role': 'user', 'content': [{'type': 'text', 'text': 'Tool Result: File at /testbed/sphinx/ext/viewcode.py has been overwritten with new content.'}]}, {'role': 'assistant', 'content': [{'type': 'text', 'text': "Let's now add a test to verify this functionality:"}, {'type': 'text', 'text': '<tool_use>\n{\'tool_name\': editor, \'tool_input\': {\'command\': \'edit\', \'path\': \'/testbed/tests/test_ext_viewcode.py\', \'file_text\': \'"""\\n    test_ext_viewcode\\n    ~~~~~~~~~~~~~~~~~\\n\\n    Test sphinx.ext.viewcode extension.\\n\\n    :copyright: Copyright 2007-2021 by the Sphinx team, see AUTHORS.\\n    :license: BSD, see LICENSE for details.\\n"""\\n\\nimport re\\nfrom pathlib import Path\\n\\nimport pytest\\n\\n\\n@pytest.mark.sphinx(testroot=\\\'ext-viewcode\\\')\\ndef test_viewcode(app, status, warning):\\n    app.builder.build_all()\\n\\n    warnings = re.sub(r\\\'\\\\\\\\+\\\', \\\'/\\\', warning.getvalue())\\n    assert re.findall(\\n        r"index.rst:\\\\d+: WARNING: Object named \\\'func1\\\' not found in include " +\\n        r"file .*/spam/__init__.py\\\'",\\n        warnings\\n    )\\n\\n    result = (app.outdir / \\\'index.html\\\').read_text()\\n    assert result.count(\\\'href="_modules/spam/mod1.html#func1"\\\') == 2\\n    assert result.count(\\\'href="_modules/spam/mod2.html#func2"\\\') == 2\\n    assert result.count(\\\'href="_modules/spam/mod1.html#Class1"\\\') == 2\\n    assert result.count(\\\'href="_modules/spam/mod2.html#Class2"\\\') == 2\\n    assert result.count(\\\'@decorator\\\') == 1\\n\\n    # test that the class attribute is correctly documented\\n    assert result.count(\\\'this is Class3\\\') == 2\\n    assert \\\'this is the class attribute class_attr\\\' in result\\n    # the next assert fails, until the autodoc bug gets fixed\\n    assert result.count(\\\'this is the class attribute class_attr\\\') == 2\\n\\n    result = (app.outdir / \\\'_modules/spam/mod1.html\\\').read_text()\\n    result = re.sub(\\\'<span class=".*?">\\\', \\\'<span>\\\', result)  # filter pygments classes\\n    assert (\\\'<div class="viewcode-block" id="Class1"><a class="viewcode-back" \\\'\\n            \\\'href="../../index.html#spam.Class1">[docs]</a>\\\'\\n            \\\'<span>@decorator</span>\\\\n\\\'\\n            \\\'<span>class</span> <span>Class1</span>\\\'\\n            \\\'<span>(</span><span>object</span><span>):</span>\\\\n\\\'\\n            \\\'    <span>&quot;&quot;&quot;</span>\\\\n\\\'\\n            \\\'<span>    this is Class1</span>\\\\n\\\'\\n            \\\'<span>    &quot;&quot;&quot;</span></div>\\\\n\\\') in result\\n\\n\\n@pytest.mark.sphinx(testroot=\\\'ext-viewcode\\\', confoverrides={\\\'viewcode_enable_epub\\\': False})\\ndef test_viewcode_epub_disabled(app, status, warning):\\n    # Change to epub builder\\n    app.builder.name = "epub"\\n    app.builder.build_all()\\n\\n    # Check that _modules directory is not created when viewcode_enable_epub is False\\n    modules_dir = Path(app.outdir) / \\\'_modules\\\'\\n    assert not modules_dir.exists()\\n\\n\\n@pytest.mark.sphinx(testroot=\\\'ext-viewcode\\\', confoverrides={\\\'viewcode_enable_epub\\\': True})\\ndef test_viewcode_epub_enabled(app, status, warning):\\n    # Change to epub builder\\n    app.builder.name = "epub"\\n    app.builder.build_all()\\n\\n    # Check that _modules directory exists when viewcode_enable_epub is True\\n    modules_dir = Path(app.outdir) / \\\'_modules\\\'\\n    assert modules_dir.exists()\\n\\n\\n@pytest.mark.sphinx(testroot=\\\'ext-viewcode\\\', tags=[\\\'test_linkcode\\\'])\\ndef test_linkcode(app, status, warning):\\n    app.builder.build([\\\'objects\\\'])\\n\\n    stuff = (app.outdir / \\\'objects.html\\\').read_text()\\n\\n    assert \\\'http://foobar/source/foolib.py\\\' in stuff\\n    assert \\\'http://foobar/js/\\\' in stuff\\n    assert \\\'http://foobar/c/\\\' in stuff\\n    assert \\\'http://foobar/cpp/\\\' in stuff\\n\\n\\n@pytest.mark.sphinx(testroot=\\\'ext-viewcode-find\\\')\\ndef test_local_source_files(app, status, warning):\\n    def find_source(app, modname):\\n        if modname == \\\'not_a_package\\\':\\n            source = (app.srcdir / \\\'not_a_package/__init__.py\\\').read_text()\\n            tags = {\\n                \\\'func1\\\': (\\\'def\\\', 1, 1),\\n                \\\'Class1\\\': (\\\'class\\\', 1, 1),\\n                \\\'not_a_package.submodule.func1\\\': (\\\'def\\\', 1, 1),\\n                \\\'not_a_package.submodule.Class1\\\': (\\\'class\\\', 1, 1),\\n            }\\n        else:\\n            source = (app.srcdir / \\\'not_a_package/submodule.py\\\').read_text()\\n            tags = {\\n                \\\'not_a_package.submodule.func1\\\': (\\\'def\\\', 11, 15),\\n                \\\'Class1\\\': (\\\'class\\\', 19, 22),\\n                \\\'not_a_package.submodule.Class1\\\': (\\\'class\\\', 19, 22),\\n                \\\'Class3\\\': (\\\'class\\\', 25, 30),\\n                \\\'not_a_package.submodule.Class3.class_attr\\\': (\\\'other\\\', 29, 29),\\n            }\\n        return (source, tags)\\n\\n    app.connect(\\\'viewcode-find-source\\\', find_source)\\n    app.builder.build_all()\\n\\n    warnings = re.sub(r\\\'\\\\\\\\+\\\', \\\'/\\\', warning.getvalue())\\n    assert re.findall(\\n        r"index.rst:\\\\d+: WARNING: Object named \\\'func1\\\' not found in include " +\\n        r"file .*/not_a_package/__init__.py\\\'",\\n        warnings\\n    )\\n\\n    result = (app.outdir / \\\'index.html\\\').read_text()\\n    assert result.count(\\\'href="_modules/not_a_package.html#func1"\\\') == 1\\n    assert result.count(\\\'href="_modules/not_a_package.html#not_a_package.submodule.func1"\\\') == 1\\n    assert result.count(\\\'href="_modules/not_a_package/submodule.html#Class1"\\\') == 1\\n    assert result.count(\\\'href="_modules/not_a_package/submodule.html#Class3"\\\') == 1\\n    assert result.count(\\\'href="_modules/not_a_package/submodule.html#not_a_package.submodule.Class1"\\\') == 1\\n\\n    assert result.count(\\\'href="_modules/not_a_package/submodule.html#not_a_package.submodule.Class3.class_attr"\\\') == 1\\n    assert result.count(\\\'This is the class attribute class_attr\\\') == 1\'}}\n</tool_use>'}]}, {'role': 'user', 'content': [{'type': 'text', 'text': 'Tool Result: File at /testbed/tests/test_ext_viewcode.py has been overwritten with new content.'}]}, {'role': 'assistant', 'content': [{'type': 'text', 'text': "Let's run the tests to verify our changes:"}, {'type': 'text', 'text': "<tool_use>\n{'tool_name': bash, 'tool_input': {'command': 'cd /testbed/ && tox --current-env -epy39 -v -- tests/test_ext_viewcode.py'}}\n</tool_use>"}]}, {'role': 'user', 'content': [{'type': 'text', 'text': 'Tool Result: py39: commands[0]> python -X dev -m pytest -rA --durations 25 tests/test_ext_viewcode.py\n\x1b[1m============================= test session starts ==============================\x1b[0m\nplatform linux -- Python 3.9.21, pytest-8.3.4, pluggy-1.5.0\ncachedir: .tox/py39/.pytest_cache\nlibraries: Sphinx-3.5.0+/82ef497a8, docutils-0.21.2\nbase tempdir: /tmp/pytest-of-root/pytest-1\nrootdir: /testbed\nconfigfile: setup.cfg\nplugins: cov-6.0.0\ncollected 5 items\n\ntests/test_ext_viewcode.py \x1b[31mF\x1b[0m\x1b[32m.\x1b[0m\x1b[31mF\x1b[0m\x1b[32m.\x1b[0m\x1b[31mF\x1b[0m\x1b[31m                                         [100%]\x1b[0m\n\n=================================== FAILURES ===================================\n\x1b[31m\x1b[1m________________________________ test_viewcode _________________________________\x1b[0m\n\napp = <SphinxTestApp buildername=\'html\'>\nstatus = <_io.StringIO object at 0x71907c26f230>\nwarning = <_io.StringIO object at 0x71907c26f2d0>\n\n    \x1b[0m\x1b[37m@pytest\x1b[39;49;00m.mark.sphinx(testroot=\x1b[33m\'\x1b[39;49;00m\x1b[33mext-viewcode\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m)\x1b[90m\x1b[39;49;00m\n    \x1b[94mdef\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[92mtest_viewcode\x1b[39;49;00m(app, status, warning):\x1b[90m\x1b[39;49;00m\n        app.builder.build_all()\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        warnings = re.sub(\x1b[33mr\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[33m\\\\\x1b[39;49;00m\x1b[33m+\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m, \x1b[33m\'\x1b[39;49;00m\x1b[33m/\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m, warning.getvalue())\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m re.findall(\x1b[90m\x1b[39;49;00m\n            \x1b[33mr\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33mindex.rst:\x1b[39;49;00m\x1b[33m\\\x1b[39;49;00m\x1b[33md+: WARNING: Object named \x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[33mfunc1\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[33m not found in include \x1b[39;49;00m\x1b[33m"\x1b[39;49;00m +\x1b[90m\x1b[39;49;00m\n            \x1b[33mr\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33mfile .*/spam/__init__.py\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m,\x1b[90m\x1b[39;49;00m\n            warnings\x1b[90m\x1b[39;49;00m\n        )\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        result = (app.outdir / \x1b[33m\'\x1b[39;49;00m\x1b[33mindex.html\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m).read_text()\x1b[90m\x1b[39;49;00m\n>       \x1b[94massert\x1b[39;49;00m result.count(\x1b[33m\'\x1b[39;49;00m\x1b[33mhref=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m_modules/spam/mod1.html#func1\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) == \x1b[94m2\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31mE       assert 0 == 2\x1b[0m\n\x1b[1m\x1b[31mE        +  where 0 = <built-in method count of str object at 0x2c89c10>(\'href="_modules/spam/mod1.html#func1"\')\x1b[0m\n\x1b[1m\x1b[31mE        +    where <built-in method count of str object at 0x2c89c10> = \'\\n<!DOCTYPE html>\\n\\n<html>\\n  <head>\\n    <meta charset="utf-8" />\\n    <meta name="viewport" content="width=device-...ref="_sources/index.rst.txt"\\n          rel="nofollow">Page source</a>\\n    </div>\\n\\n    \\n\\n    \\n  </body>\\n</html>\'.count\x1b[0m\n\n\x1b[1m\x1b[31mtests/test_ext_viewcode.py\x1b[0m:29: AssertionError\n--------------------------- Captured stdout teardown ---------------------------\n# testroot: root\n# builder: html\n# srcdir: /tmp/pytest-of-root/pytest-1/ext-viewcode\n# outdir: /tmp/pytest-of-root/pytest-1/ext-viewcode/_build/html\n# status: \n\x1b[01mRunning Sphinx v3.5.0+/82ef497a8\x1b[39;49;00m\n\x1b[01mbuilding [html]: \x1b[39;49;00mall source files\n\x1b[01mupdating environment: \x1b[39;49;00m[new config] 2 added, 0 changed, 0 removed\n\x1b[01mreading sources... \x1b[39;49;00m[ 50%] \x1b[35mindex\x1b[39;49;00m                                                \r\x1b[01mreading sources... \x1b[39;49;00m[100%] \x1b[35mobjects\x1b[39;49;00m                                              \r\n\x1b[01mlooking for now-outdated files... \x1b[39;49;00mnone found\n\x1b[01mpickling environment... \x1b[39;49;00mdone\n\x1b[01mchecking consistency... \x1b[39;49;00mdone\n\x1b[01mpreparing documents... \x1b[39;49;00mdone\n\x1b[01mwriting output... \x1b[39;49;00m[ 50%] \x1b[32mindex\x1b[39;49;00m                                                 \r\x1b[01mwriting output... \x1b[39;49;00m[100%] \x1b[32mobjects\x1b[39;49;00m                                               \r\n\x1b[01mgenerating indices... \x1b[39;49;00mgenindex py-modindex done\n\x1b[01mwriting additional pages... \x1b[39;49;00msearch done\n\x1b[01mcopying static files... \x1b[39;49;00mdone\n\x1b[01mcopying extra files... \x1b[39;49;00mdone\n\x1b[01mdumping search index in English (code: en)... \x1b[39;49;00mdone\n\x1b[01mdumping object inventory... \x1b[39;49;00mdone\n\n# warning: \n\x1b[91mWARNING: while setting up extension sphinx.addnodes: node class \'meta\' is already registered, its visitors will be overridden\x1b[39;49;00m\n\x1b[91mWARNING: while setting up extension sphinx.ext.viewcode: extension \'sphinx.ext.viewcode\' has no setup() function; is it really a Sphinx extension module?\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-1/ext-viewcode/index.rst:23: WARNING: Object named \'func1\' not found in include file \'/tmp/pytest-of-root/pytest-1/ext-viewcode/spam/__init__.py\'\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-1/ext-viewcode/spam/mod1.py:docstring of spam.mod1.Class3:1: WARNING: duplicate object description of spam.mod3.Class3, other instance in index, use :noindex: for one of them\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-1/ext-viewcode/spam/mod1.py:docstring of spam.mod3.Class3.class_attr:1: WARNING: duplicate object description of spam.mod3.Class3.class_attr, other instance in index, use :noindex: for one of them\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-1/ext-viewcode/objects.rst:84: WARNING: Error in declarator\nIf declarator-id with parameters (e.g., \'void f(int arg)\'):\n  Invalid C declaration: Expected identifier in nested name. [error at 18]\n    Sphinx_DoSomething()\n    ------------------^\nIf parenthesis in noptr-declarator (e.g., \'void (*f(int arg))(double)\'):\n  Error in declarator or parameters\n  Invalid C declaration: Expected identifier in nested name. [error at 19]\n    Sphinx_DoSomething()\n    -------------------^\n\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-1/ext-viewcode/objects.rst:86: WARNING: Error in declarator or parameters\nInvalid C declaration: Expected identifier in nested name. [error at 19]\n  SphinxStruct.member\n  -------------------^\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-1/ext-viewcode/objects.rst:92: WARNING: Error in declarator or parameters\nInvalid C declaration: Expected identifier in nested name. [error at 13]\n  sphinx_global\n  -------------^\x1b[39;49;00m\n\x1b[31m/tmp/pytest-of-root/pytest-1/ext-viewcode/objects.rst:155: WARNING: Unknown directive type "userdesc".\n\n.. userdesc:: myobj:parameter\n\n   Description of userdesc.\x1b[39;49;00m\n\x1b[31m/tmp/pytest-of-root/pytest-1/ext-viewcode/objects.rst:160: WARNING: Unknown interpreted text role "userdescrole".\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-1/ext-viewcode/objects.rst:166: WARNING: Too many template argument lists compared to parameter lists. Argument lists: 1, Parameter lists: 0, Extra empty parameters lists prepended: 1. Declaration:\n\tn::Array<T, d>\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-1/ext-viewcode/objects.rst:117: WARNING: Unparseable C cross-reference: \'SphinxType *\'\nInvalid C declaration: Expected end of definition. [error at 11]\n  SphinxType *\n  -----------^\x1b[39;49;00m\n\n\x1b[31m\x1b[1m__________________________ test_viewcode_epub_enabled __________________________\x1b[0m\n\napp = <SphinxTestApp buildername=\'epub\'>\nstatus = <_io.StringIO object at 0x71907ac0e370>\nwarning = <_io.StringIO object at 0x71907ac0e410>\n\n    \x1b[0m\x1b[37m@pytest\x1b[39;49;00m.mark.sphinx(testroot=\x1b[33m\'\x1b[39;49;00m\x1b[33mext-viewcode\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m, confoverrides={\x1b[33m\'\x1b[39;49;00m\x1b[33mviewcode_enable_epub\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m: \x1b[94mTrue\x1b[39;49;00m})\x1b[90m\x1b[39;49;00m\n    \x1b[94mdef\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[92mtest_viewcode_epub_enabled\x1b[39;49;00m(app, status, warning):\x1b[90m\x1b[39;49;00m\n        \x1b[90m# Change to epub builder\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        app.builder.name = \x1b[33m"\x1b[39;49;00m\x1b[33mepub\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        app.builder.build_all()\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        \x1b[90m# Check that _modules directory exists when viewcode_enable_epub is True\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        modules_dir = Path(app.outdir) / \x1b[33m\'\x1b[39;49;00m\x1b[33m_modules\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n>       \x1b[94massert\x1b[39;49;00m modules_dir.exists()\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31mE       AssertionError: assert False\x1b[0m\n\x1b[1m\x1b[31mE        +  where False = exists()\x1b[0m\n\x1b[1m\x1b[31mE        +    where exists = PosixPath(\'/tmp/pytest-of-root/pytest-1/ext-viewcode/_build/html/_modules\').exists\x1b[0m\n\n\x1b[1m\x1b[31mtests/test_ext_viewcode.py\x1b[0m:72: AssertionError\n--------------------------- Captured stdout teardown ---------------------------\n# testroot: root\n# builder: epub\n# srcdir: /tmp/pytest-of-root/pytest-1/ext-viewcode\n# outdir: /tmp/pytest-of-root/pytest-1/ext-viewcode/_build/html\n# status: \n\x1b[01mRunning Sphinx v3.5.0+/82ef497a8\x1b[39;49;00m\n\x1b[01mloading pickled environment... \x1b[39;49;00mdone\n\x1b[01mbuilding [epub]: \x1b[39;49;00mall source files\n\x1b[01mupdating environment: \x1b[39;49;00m0 added, 0 changed, 0 removed\n\x1b[01mlooking for now-outdated files... \x1b[39;49;00mnone found\n\x1b[01mpreparing documents... \x1b[39;49;00mdone\n\x1b[01mwriting output... \x1b[39;49;00m[ 50%] \x1b[32mindex\x1b[39;49;00m                                                 \r\x1b[01mwriting output... \x1b[39;49;00m[100%] \x1b[32mobjects\x1b[39;49;00m                                               \r\n\x1b[01mgenerating indices... \x1b[39;49;00mgenindex py-modindex done\n\x1b[01mwriting additional pages... \x1b[39;49;00msearch done\n\x1b[01mcopying static files... \x1b[39;49;00mdone\n\x1b[01mcopying extra files... \x1b[39;49;00mdone\n\x1b[01mdumping search index in English (code: en)... \x1b[39;49;00mdone\n\x1b[01mdumping object inventory... \x1b[39;49;00mdone\n\n# warning: \n\x1b[91mWARNING: while setting up extension sphinx.addnodes: node class \'meta\' is already registered, its visitors will be overridden\x1b[39;49;00m\n\x1b[91mWARNING: while setting up extension sphinx.ext.viewcode: extension \'sphinx.ext.viewcode\' has no setup() function; is it really a Sphinx extension module?\x1b[39;49;00m\n\x1b[91mWARNING: unknown config value \'viewcode_enable_epub\' in override, ignoring\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-1/ext-viewcode/objects.rst:117: WARNING: Unparseable C cross-reference: \'SphinxType *\'\nInvalid C declaration: Expected end of definition. [error at 11]\n  SphinxType *\n  -----------^\x1b[39;49;00m\n\n\x1b[31m\x1b[1m___________________________ test_local_source_files ____________________________\x1b[0m\n\napp = <SphinxTestApp buildername=\'html\'>\nstatus = <_io.StringIO object at 0x71907b62d9b0>\nwarning = <_io.StringIO object at 0x71907b62d910>\n\n    \x1b[0m\x1b[37m@pytest\x1b[39;49;00m.mark.sphinx(testroot=\x1b[33m\'\x1b[39;49;00m\x1b[33mext-viewcode-find\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m)\x1b[90m\x1b[39;49;00m\n    \x1b[94mdef\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[92mtest_local_source_files\x1b[39;49;00m(app, status, warning):\x1b[90m\x1b[39;49;00m\n        \x1b[94mdef\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[92mfind_source\x1b[39;49;00m(app, modname):\x1b[90m\x1b[39;49;00m\n            \x1b[94mif\x1b[39;49;00m modname == \x1b[33m\'\x1b[39;49;00m\x1b[33mnot_a_package\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m:\x1b[90m\x1b[39;49;00m\n                source = (app.srcdir / \x1b[33m\'\x1b[39;49;00m\x1b[33mnot_a_package/__init__.py\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m).read_text()\x1b[90m\x1b[39;49;00m\n                tags = {\x1b[90m\x1b[39;49;00m\n                    \x1b[33m\'\x1b[39;49;00m\x1b[33mfunc1\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m: (\x1b[33m\'\x1b[39;49;00m\x1b[33mdef\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m, \x1b[94m1\x1b[39;49;00m, \x1b[94m1\x1b[39;49;00m),\x1b[90m\x1b[39;49;00m\n                    \x1b[33m\'\x1b[39;49;00m\x1b[33mClass1\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m: (\x1b[33m\'\x1b[39;49;00m\x1b[33mclass\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m, \x1b[94m1\x1b[39;49;00m, \x1b[94m1\x1b[39;49;00m),\x1b[90m\x1b[39;49;00m\n                    \x1b[33m\'\x1b[39;49;00m\x1b[33mnot_a_package.submodule.func1\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m: (\x1b[33m\'\x1b[39;49;00m\x1b[33mdef\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m, \x1b[94m1\x1b[39;49;00m, \x1b[94m1\x1b[39;49;00m),\x1b[90m\x1b[39;49;00m\n                    \x1b[33m\'\x1b[39;49;00m\x1b[33mnot_a_package.submodule.Class1\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m: (\x1b[33m\'\x1b[39;49;00m\x1b[33mclass\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m, \x1b[94m1\x1b[39;49;00m, \x1b[94m1\x1b[39;49;00m),\x1b[90m\x1b[39;49;00m\n                }\x1b[90m\x1b[39;49;00m\n            \x1b[94melse\x1b[39;49;00m:\x1b[90m\x1b[39;49;00m\n                source = (app.srcdir / \x1b[33m\'\x1b[39;49;00m\x1b[33mnot_a_package/submodule.py\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m).read_text()\x1b[90m\x1b[39;49;00m\n                tags = {\x1b[90m\x1b[39;49;00m\n                    \x1b[33m\'\x1b[39;49;00m\x1b[33mnot_a_package.submodule.func1\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m: (\x1b[33m\'\x1b[39;49;00m\x1b[33mdef\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m, \x1b[94m11\x1b[39;49;00m, \x1b[94m15\x1b[39;49;00m),\x1b[90m\x1b[39;49;00m\n                    \x1b[33m\'\x1b[39;49;00m\x1b[33mClass1\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m: (\x1b[33m\'\x1b[39;49;00m\x1b[33mclass\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m, \x1b[94m19\x1b[39;49;00m, \x1b[94m22\x1b[39;49;00m),\x1b[90m\x1b[39;49;00m\n                    \x1b[33m\'\x1b[39;49;00m\x1b[33mnot_a_package.submodule.Class1\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m: (\x1b[33m\'\x1b[39;49;00m\x1b[33mclass\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m, \x1b[94m19\x1b[39;49;00m, \x1b[94m22\x1b[39;49;00m),\x1b[90m\x1b[39;49;00m\n                    \x1b[33m\'\x1b[39;49;00m\x1b[33mClass3\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m: (\x1b[33m\'\x1b[39;49;00m\x1b[33mclass\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m, \x1b[94m25\x1b[39;49;00m, \x1b[94m30\x1b[39;49;00m),\x1b[90m\x1b[39;49;00m\n                    \x1b[33m\'\x1b[39;49;00m\x1b[33mnot_a_package.submodule.Class3.class_attr\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m: (\x1b[33m\'\x1b[39;49;00m\x1b[33mother\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m, \x1b[94m29\x1b[39;49;00m, \x1b[94m29\x1b[39;49;00m),\x1b[90m\x1b[39;49;00m\n                }\x1b[90m\x1b[39;49;00m\n            \x1b[94mreturn\x1b[39;49;00m (source, tags)\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n>       app.connect(\x1b[33m\'\x1b[39;49;00m\x1b[33mviewcode-find-source\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m, find_source)\x1b[90m\x1b[39;49;00m\n\n\x1b[1m\x1b[31mtests/test_ext_viewcode.py\x1b[0m:109: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\x1b[1m\x1b[31msphinx/application.py\x1b[0m:433: in connect\n    \x1b[0mlistener_id = \x1b[96mself\x1b[39;49;00m.events.connect(event, callback, priority)\x1b[90m\x1b[39;49;00m\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <sphinx.events.EventManager object at 0x71907ada16e0>\nname = \'viewcode-find-source\'\ncallback = <function test_local_source_files.<locals>.find_source at 0x71907ade9550>\npriority = 500\n\n    \x1b[0m\x1b[94mdef\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[92mconnect\x1b[39;49;00m(\x1b[96mself\x1b[39;49;00m, name: \x1b[96mstr\x1b[39;49;00m, callback: Callable, priority: \x1b[96mint\x1b[39;49;00m) -> \x1b[96mint\x1b[39;49;00m:\x1b[90m\x1b[39;49;00m\n    \x1b[90m    \x1b[39;49;00m\x1b[33m"""Connect a handler to specific event."""\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94mif\x1b[39;49;00m name \x1b[95mnot\x1b[39;49;00m \x1b[95min\x1b[39;49;00m \x1b[96mself\x1b[39;49;00m.events:\x1b[90m\x1b[39;49;00m\n>           \x1b[94mraise\x1b[39;49;00m ExtensionError(__(\x1b[33m\'\x1b[39;49;00m\x1b[33mUnknown event name: \x1b[39;49;00m\x1b[33m%s\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) % name)\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31mE           sphinx.errors.ExtensionError: Unknown event name: viewcode-find-source\x1b[0m\n\n\x1b[1m\x1b[31msphinx/events.py\x1b[0m:78: ExtensionError\n--------------------------- Captured stdout teardown ---------------------------\n# testroot: root\n# builder: html\n# srcdir: /tmp/pytest-of-root/pytest-1/ext-viewcode-find\n# outdir: /tmp/pytest-of-root/pytest-1/ext-viewcode-find/_build/html\n# status: \n\x1b[01mRunning Sphinx v3.5.0+/82ef497a8\x1b[39;49;00m\n\n# warning: \n\x1b[91mWARNING: while setting up extension sphinx.addnodes: node class \'meta\' is already registered, its visitors will be overridden\x1b[39;49;00m\n\x1b[91mWARNING: while setting up extension sphinx.ext.viewcode: extension \'sphinx.ext.viewcode\' has no setup() function; is it really a Sphinx extension module?\x1b[39;49;00m\n\n\x1b[33m=============================== warnings summary ===============================\x1b[0m\nsphinx/util/docutils.py:45\n  /testbed/sphinx/util/docutils.py:45: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.\n    __version_info__ = tuple(LooseVersion(docutils.__version__).version)\n\nsphinx/registry.py:22\n  /testbed/sphinx/registry.py:22: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n    from pkg_resources import iter_entry_points\n\n../opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pkg_resources/__init__.py:3142\n../opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pkg_resources/__init__.py:3142\n../opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pkg_resources/__init__.py:3142\n../opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pkg_resources/__init__.py:3142\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pkg_resources/__init__.py:3142: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace(\'sphinxcontrib\')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n    declare_namespace(pkg)\n\nsphinx/directives/patches.py:14\n  /testbed/sphinx/directives/patches.py:14: DeprecationWarning: The `docutils.parsers.rst.directive.html` module will be removed in Docutils 2.0. Since Docutils 0.18, the "Meta" node is defined in `docutils.parsers.rst.directives.misc`.\n    from docutils.parsers.rst.directives import html, images, tables\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/__init__.py:210: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse():  # type: Node\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/i18n.py:95: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.translatable):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/__init__.py:110: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for ref in self.document.traverse(nodes.substitution_reference):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/__init__.py:131: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.target):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/__init__.py:150: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.block_quote):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/__init__.py:175: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.Element):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/__init__.py:222: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.index):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/__init__.py:189: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.section):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/__init__.py:279: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.doctest_block):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/domains/citation.py:116: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.citation):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/domains/citation.py:135: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.citation_reference):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/builders/latex/transforms.py:36: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(matcher):  # type: nodes.Element\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/__init__.py:291: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(matcher):  # type: Element\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/util/compat.py:44: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.index):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/domains/index.py:51: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in document.traverse(addnodes.index):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/domains/math.py:84: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    self.data[\'has_equations\'][docname] = any(document.traverse(math_node))\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/environment/collectors/asset.py:46: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in doctree.traverse(nodes.image):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/environment/collectors/asset.py:127: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in doctree.traverse(addnodes.download_reference):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/environment/collectors/title.py:46: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in doctree.traverse(nodes.section):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/__init__.py:301: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.system_message):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/__init__.py:390: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.manpage):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/i18n.py:488: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for inline in self.document.traverse(matcher):  # type: nodes.inline\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/domains/python.py:283: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in result.traverse(nodes.Text):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/builders/html/__init__.py:422: DeprecationWarning: The frontend.OptionParser class will be replaced by a subclass of argparse.ArgumentParser in Docutils 0.21 or later.\n    self.docsettings = OptionParser(\n\ntests/test_ext_viewcode.py: 288 warnings\n  /opt/miniconda3/envs/testbed/lib/python3.9/optparse.py:1000: DeprecationWarning: The frontend.Option class will be removed in Docutils 0.21 or later.\n    option = self.option_class(*args, **kwargs)\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/domains/c.py:3494: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(AliasNode):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/domains/cpp.py:7070: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(AliasNode):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/post_transforms/__init__.py:69: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.pending_xref):\n\ntests/test_ext_viewcode.py: 40 warnings\n  /testbed/sphinx/util/nodes.py:598: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in document.traverse(addnodes.only):\n\ntests/test_ext_viewcode.py: 16 warnings\n  /testbed/sphinx/transforms/post_transforms/images.py:33: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.image):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/post_transforms/__init__.py:216: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.desc_sig_element):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/builders/latex/transforms.py:48: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.substitution_definition):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/builders/html/transforms.py:44: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(matcher):  # type: nodes.literal\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/builders/latex/transforms.py:606: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.title):\n\ntests/test_ext_viewcode.py: 32 warnings\n  /testbed/sphinx/builders/latex/transforms.py:608: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for i, index in enumerate(node.traverse(addnodes.index)):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/post_transforms/code.py:43: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.highlightlang):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/post_transforms/code.py:95: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for lbnode in self.document.traverse(nodes.literal_block):  # type: nodes.literal_block\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/post_transforms/code.py:99: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for dbnode in self.document.traverse(nodes.doctest_block):  # type: nodes.doctest_block\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/environment/__init__.py:541: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for toctreenode in doctree.traverse(addnodes.toctree):\n\ntests/test_ext_viewcode.py: 24 warnings\n  /testbed/sphinx/environment/adapters/toctree.py:203: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for subtocnode in toc.traverse(addnodes.toctree):\n\ntests/test_ext_viewcode.py: 24 warnings\n  /testbed/sphinx/environment/adapters/toctree.py:261: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for refnode in newnode.traverse(nodes.reference):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/builders/__init__.py:181: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in doctree.traverse(nodes.image):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/builders/html/__init__.py:844: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in doctree.traverse(nodes.image):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/environment/adapters/toctree.py:312: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in toc.traverse(nodes.reference):\n\ntests/test_ext_viewcode.py: 20 warnings\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/alabaster/layout.html:114: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n    _gaq.push([\'_setAllowLinker\', true]);\n\ntests/test_ext_viewcode.py: 20 warnings\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/alabaster/about.html:70: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py: 20 warnings\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/alabaster/about.html:99: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py: 20 warnings\n  /testbed/sphinx/environment/adapters/toctree.py:328: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for toctreenode in doctree.traverse(addnodes.toctree):\n\ntests/test_ext_viewcode.py: 20 warnings\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/alabaster/layout.html:215: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py: 20 warnings\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/alabaster/layout.html:238: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\n  <template>:33: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\n  <template>:224: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\n  <template>:386: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\n  <template>:401: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py: 16 warnings\n  /testbed/sphinx/util/nodes.py:350: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for img in node.traverse(nodes.image):\n\ntests/test_ext_viewcode.py: 16 warnings\n  /testbed/sphinx/util/nodes.py:352: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for raw in node.traverse(nodes.raw):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/ext/linkcode.py:42: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for objnode in doctree.traverse(addnodes.desc):\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n==================================== PASSES ====================================\n--------------------------- Captured stdout teardown ---------------------------\n# testroot: root\n# builder: epub\n# srcdir: /tmp/pytest-of-root/pytest-1/ext-viewcode\n# outdir: /tmp/pytest-of-root/pytest-1/ext-viewcode/_build/html\n# status: \n\x1b[01mRunning Sphinx v3.5.0+/82ef497a8\x1b[39;49;00m\n\x1b[01mloading pickled environment... \x1b[39;49;00mdone\n\x1b[01mbuilding [epub]: \x1b[39;49;00mall source files\n\x1b[01mupdating environment: \x1b[39;49;00m0 added, 0 changed, 0 removed\n\x1b[01mlooking for now-outdated files... \x1b[39;49;00mnone found\n\x1b[01mpreparing documents... \x1b[39;49;00mdone\n\x1b[01mwriting output... \x1b[39;49;00m[ 50%] \x1b[32mindex\x1b[39;49;00m                                                 \r\x1b[01mwriting output... \x1b[39;49;00m[100%] \x1b[32mobjects\x1b[39;49;00m                                               \r\n\x1b[01mgenerating indices... \x1b[39;49;00mgenindex py-modindex done\n\x1b[01mwriting additional pages... \x1b[39;49;00msearch done\n\x1b[01mcopying static files... \x1b[39;49;00mdone\n\x1b[01mcopying extra files... \x1b[39;49;00mdone\n\x1b[01mdumping search index in English (code: en)... \x1b[39;49;00mdone\n\x1b[01mdumping object inventory... \x1b[39;49;00mdone\n\n# warning: \n\x1b[91mWARNING: while setting up extension sphinx.addnodes: node class \'meta\' is already registered, its visitors will be overridden\x1b[39;49;00m\n\x1b[91mWARNING: while setting up extension sphinx.ext.viewcode: extension \'sphinx.ext.viewcode\' has no setup() function; is it really a Sphinx extension module?\x1b[39;49;00m\n\x1b[91mWARNING: unknown config value \'viewcode_enable_epub\' in override, ignoring\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-1/ext-viewcode/objects.rst:117: WARNING: Unparseable C cross-reference: \'SphinxType *\'\nInvalid C declaration: Expected end of definition. [error at 11]\n  SphinxType *\n  -----------^\x1b[39;49;00m\n\n--------------------------- Captured stdout teardown ---------------------------\n# testroot: root\n# builder: html\n# srcdir: /tmp/pytest-of-root/pytest-1/ext-viewcode\n# outdir: /tmp/pytest-of-root/pytest-1/ext-viewcode/_build/html\n# status: \n\x1b[01mRunning Sphinx v3.5.0+/82ef497a8\x1b[39;49;00m\n\x1b[01mloading pickled environment... \x1b[39;49;00mdone\n\x1b[01mupdating environment: \x1b[39;49;00m[extensions changed (\'2\')] 2 added, 0 changed, 0 removed\n\x1b[01mreading sources... \x1b[39;49;00m[ 50%] \x1b[35mindex\x1b[39;49;00m                                                \r\x1b[01mreading sources... \x1b[39;49;00m[100%] \x1b[35mobjects\x1b[39;49;00m                                              \r\n\x1b[01mlooking for now-outdated files... \x1b[39;49;00mnone found\n\x1b[01mpickling environment... \x1b[39;49;00mdone\n\x1b[01mchecking consistency... \x1b[39;49;00mdone\n\x1b[01mpreparing documents... \x1b[39;49;00mdone\n\x1b[01mwriting output... \x1b[39;49;00m[ 50%] \x1b[32mindex\x1b[39;49;00m                                                 \r\x1b[01mwriting output... \x1b[39;49;00m[100%] \x1b[32mobjects\x1b[39;49;00m                                               \r\n\x1b[01mgenerating indices... \x1b[39;49;00mgenindex py-modindex done\n\x1b[01mwriting additional pages... \x1b[39;49;00msearch done\n\x1b[01mcopying static files... \x1b[39;49;00mdone\n\x1b[01mcopying extra files... \x1b[39;49;00mdone\n\x1b[01mdumping search index in English (code: en)... \x1b[39;49;00mdone\n\x1b[01mdumping object inventory... \x1b[39;49;00mdone\n\n# warning: \n\x1b[91mWARNING: while setting up extension sphinx.addnodes: node class \'meta\' is already registered, its visitors will be overridden\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-1/ext-viewcode/index.rst:23: WARNING: Object named \'func1\' not found in include file \'/tmp/pytest-of-root/pytest-1/ext-viewcode/spam/__init__.py\'\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-1/ext-viewcode/spam/mod1.py:docstring of spam.mod1.Class3:1: WARNING: duplicate object description of spam.mod3.Class3, other instance in index, use :noindex: for one of them\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-1/ext-viewcode/spam/mod1.py:docstring of spam.mod3.Class3.class_attr:1: WARNING: duplicate object description of spam.mod3.Class3.class_attr, other instance in index, use :noindex: for one of them\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-1/ext-viewcode/objects.rst:84: WARNING: Error in declarator\nIf declarator-id with parameters (e.g., \'void f(int arg)\'):\n  Invalid C declaration: Expected identifier in nested name. [error at 18]\n    Sphinx_DoSomething()\n    ------------------^\nIf parenthesis in noptr-declarator (e.g., \'void (*f(int arg))(double)\'):\n  Error in declarator or parameters\n  Invalid C declaration: Expected identifier in nested name. [error at 19]\n    Sphinx_DoSomething()\n    -------------------^\n\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-1/ext-viewcode/objects.rst:86: WARNING: Error in declarator or parameters\nInvalid C declaration: Expected identifier in nested name. [error at 19]\n  SphinxStruct.member\n  -------------------^\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-1/ext-viewcode/objects.rst:92: WARNING: Error in declarator or parameters\nInvalid C declaration: Expected identifier in nested name. [error at 13]\n  sphinx_global\n  -------------^\x1b[39;49;00m\n\x1b[31m/tmp/pytest-of-root/pytest-1/ext-viewcode/objects.rst:155: WARNING: Unknown directive type "userdesc".\n\n.. userdesc:: myobj:parameter\n\n   Description of userdesc.\x1b[39;49;00m\n\x1b[31m/tmp/pytest-of-root/pytest-1/ext-viewcode/objects.rst:160: WARNING: Unknown interpreted text role "userdescrole".\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-1/ext-viewcode/objects.rst:166: WARNING: Too many template argument lists compared to parameter lists. Argument lists: 1, Parameter lists: 0, Extra empty parameters lists prepended: 1. Declaration:\n\tn::Array<T, d>\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-1/ext-viewcode/objects.rst:117: WARNING: Unparseable C cross-reference: \'SphinxType *\'\nInvalid C declaration: Expected end of definition. [error at 11]\n  SphinxType *\n  -----------^\x1b[39;49;00m\n\n============================= slowest 25 durations =============================\n0.34s call     tests/test_ext_viewcode.py::test_viewcode\n0.26s call     tests/test_ext_viewcode.py::test_linkcode\n0.20s call     tests/test_ext_viewcode.py::test_viewcode_epub_enabled\n0.17s call     tests/test_ext_viewcode.py::test_viewcode_epub_disabled\n0.15s setup    tests/test_ext_viewcode.py::test_viewcode\n0.02s setup    tests/test_ext_viewcode.py::test_viewcode_epub_disabled\n0.01s setup    tests/test_ext_viewcode.py::test_viewcode_epub_enabled\n0.01s setup    tests/test_ext_viewcode.py::test_linkcode\n0.01s setup    tests/test_ext_viewcode.py::test_local_source_files\n\n(6 durations < 0.005s hidden.  Use -vv to show these durations.)\n\x1b[36m\x1b[1m=========================== short test summary info ============================\x1b[0m\n\x1b[32mPASSED\x1b[0m tests/test_ext_viewcode.py::\x1b[1mtest_viewcode_epub_disabled\x1b[0m\n\x1b[32mPASSED\x1b[0m tests/test_ext_viewcode.py::\x1b[1mtest_linkcode\x1b[0m\n\x1b[31mFAILED\x1b[0m tests/test_ext_viewcode.py::\x1b[1mtest_viewcode\x1b[0m - assert 0 == 2\n\x1b[31mFAILED\x1b[0m tests/test_ext_viewcode.py::\x1b[1mtest_viewcode_epub_enabled\x1b[0m - AssertionError: assert False\n\x1b[31mFAILED\x1b[0m tests/test_ext_viewcode.py::\x1b[1mtest_local_source_files\x1b[0m - sphinx.errors.ExtensionError: Unknown event name: viewcode-find-source\n\x1b[31m================== \x1b[31m\x1b[1m3 failed\x1b[0m, \x1b[32m2 passed\x1b[0m, \x1b[33m803 warnings\x1b[0m\x1b[31m in 1.31s\x1b[0m\x1b[31m ===================\x1b[0m\npy39: exit 1 (1.77 seconds) /testbed> python -X dev -m pytest -rA --durations 25 tests/test_ext_viewcode.py pid=256\n  py39: FAIL code 1 (1.78=setup[0.01]+cmd[1.77] seconds)\n  evaluation failed :( (1.87 seconds)'}]}, {'role': 'assistant', 'content': [{'type': 'text', 'text': "The tests are failing because we need to make several additional changes:\n\n1. We need to add a proper setup() function to register our events and configuration values\n2. We need to modify the epub builder handling in the `collect_pages` function\n3. We need to register the 'viewcode-find-source' event\n\nLet's fix these issues one by one. First, we'll add the setup() function and register the configuration value and events:"}, {'type': 'text', 'text': '<tool_use>\n{\'tool_name\': editor, \'tool_input\': {\'command\': \'edit\', \'path\': \'/testbed/sphinx/ext/viewcode.py\', \'file_text\': \'"""\\n    sphinx.ext.viewcode\\n    ~~~~~~~~~~~~~~~~~~~\\n\\n    Add links to module code in Python object descriptions.\\n\\n    :copyright: Copyright 2007-2021 by the Sphinx team, see AUTHORS.\\n    :license: BSD, see LICENSE for details.\\n"""\\n\\nimport posixpath\\nimport traceback\\nfrom os import path\\nfrom typing import Any, Dict, Generator, Iterable, Optional, Set, Tuple, cast\\n\\nfrom docutils import nodes\\nfrom docutils.nodes import Element, Node\\n\\nimport sphinx\\nfrom sphinx import addnodes\\nfrom sphinx.application import Sphinx\\nfrom sphinx.builders.html import StandaloneHTMLBuilder\\nfrom sphinx.environment import BuildEnvironment\\nfrom sphinx.locale import _, __\\nfrom sphinx.pycode import ModuleAnalyzer\\nfrom sphinx.util import get_full_modname, logging, status_iterator\\nfrom sphinx.util.nodes import make_refnode\\n\\nlogger = logging.getLogger(__name__)\\n\\n\\nOUTPUT_DIRNAME = \\\'_modules\\\'\\n\\n\\ndef _get_full_modname(app: Sphinx, modname: str, attribute: str) -> Optional[str]:\\n    try:\\n        return get_full_modname(modname, attribute)\\n    except AttributeError:\\n        # sphinx.ext.viewcode can\\\'t follow class instance attribute\\n        # then AttributeError logging output only verbose mode.\\n        logger.verbose(\\\'Didn\\\\\\\'t find %s in %s\\\', attribute, modname)\\n        return None\\n    except Exception as e:\\n        # sphinx.ext.viewcode follow python domain directives.\\n        # because of that, if there are no real modules exists that specified\\n        # by py:function or other directives, viewcode emits a lot of warnings.\\n        # It should be displayed only verbose mode.\\n        logger.verbose(traceback.format_exc().rstrip())\\n        logger.verbose(\\\'viewcode can\\\\\\\'t import %s, failed with error "%s"\\\', modname, e)\\n        return None\\n\\n\\ndef doctree_read(app: Sphinx, doctree: Node) -> None:\\n    env = app.builder.env\\n    if not hasattr(env, \\\'_viewcode_modules\\\'):\\n        env._viewcode_modules = {}  # type: ignore\\n    if app.builder.name == "singlehtml":\\n        return\\n    if app.builder.name.startswith("epub") and not env.config.viewcode_enable_epub:\\n        return\\n\\n    def has_tag(modname: str, fullname: str, docname: str, refname: str) -> bool:\\n        entry = env._viewcode_modules.get(modname, None)  # type: ignore\\n        if entry is False:\\n            return False\\n\\n        code_tags = app.emit_firstresult(\\\'viewcode-find-source\\\', modname)\\n        if code_tags is None:\\n            try:\\n                analyzer = ModuleAnalyzer.for_module(modname)\\n                analyzer.find_tags()\\n            except Exception:\\n                env._viewcode_modules[modname] = False  # type: ignore\\n                return False\\n\\n            code = analyzer.code\\n            tags = analyzer.tags\\n        else:\\n            code, tags = code_tags\\n\\n        if entry is None or entry[0] != code:\\n            entry = code, tags, {}, refname\\n            env._viewcode_modules[modname] = entry  # type: ignore\\n        _, tags, used, _ = entry\\n        if fullname in tags:\\n            used[fullname] = docname\\n            return True\\n\\n        return False\\n\\n    for objnode in doctree.traverse(addnodes.desc):\\n        if objnode.get(\\\'domain\\\') != \\\'py\\\':\\n            continue\\n        names = set()  # type: Set[str]\\n        for signode in objnode:\\n            if not isinstance(signode, addnodes.desc_signature):\\n                continue\\n            modname = signode.get(\\\'module\\\')\\n            fullname = signode.get(\\\'fullname\\\')\\n            refname = modname\\n            if env.config.viewcode_follow_imported_members:\\n                new_modname = app.emit_firstresult(\\n                    \\\'viewcode-follow-imported\\\', modname, fullname,\\n                )\\n                if not new_modname:\\n                    new_modname = _get_full_modname(app, modname, fullname)\\n                modname = new_modname\\n            if not modname:\\n                continue\\n            fullname = signode.get(\\\'fullname\\\')\\n            if not has_tag(modname, fullname, env.docname, refname):\\n                continue\\n            if fullname in names:\\n                # only one link per name, please\\n                continue\\n            names.add(fullname)\\n            pagename = posixpath.join(OUTPUT_DIRNAME, modname.replace(\\\'.\\\', \\\'/\\\'))\\n            inline = nodes.inline(\\\'\\\', _(\\\'[source]\\\'), classes=[\\\'viewcode-link\\\'])\\n            onlynode = addnodes.only(expr=\\\'html\\\')\\n            onlynode += addnodes.pending_xref(\\\'\\\', inline, reftype=\\\'viewcode\\\', refdomain=\\\'std\\\',\\n                                          refexplicit=False, reftarget=pagename,\\n                                          refid=fullname, refdoc=env.docname)\\n            signode += onlynode\\n\\n\\ndef env_merge_info(app: Sphinx, env: BuildEnvironment, docnames: Iterable[str],\\n                   other: BuildEnvironment) -> None:\\n    if not hasattr(other, \\\'_viewcode_modules\\\'):\\n        return\\n    # create a _viewcode_modules dict on the main environment\\n    if not hasattr(env, \\\'_viewcode_modules\\\'):\\n        env._viewcode_modules = {}  # type: ignore\\n    # now merge in the information from the subprocess\\n    env._viewcode_modules.update(other._viewcode_modules)  # type: ignore\\n\\n\\ndef missing_reference(app: Sphinx, env: BuildEnvironment, node: Element, contnode: Node\\n                      ) -> Optional[Node]:\\n    # resolve our "viewcode" reference nodes -- they need special treatment\\n    if node[\\\'reftype\\\'] == \\\'viewcode\\\':\\n        return make_refnode(app.builder, node[\\\'refdoc\\\'], node[\\\'reftarget\\\'],\\n                            node[\\\'refid\\\'], contnode)\\n\\n    return None\\n\\n\\ndef get_module_filename(app: Sphinx, modname: str) -> Optional[str]:\\n    """Get module filename for *modname*."""\\n    source_info = app.emit_firstresult(\\\'viewcode-find-source\\\', modname)\\n    if source_info:\\n        return None\\n    else:\\n        try:\\n            filename, source = ModuleAnalyzer.get_module_source(modname)\\n            return filename\\n        except Exception:\\n            return None\\n\\n\\ndef should_generate_module_page(app: Sphinx, modname: str) -> bool:\\n    """Check generation of module page is needed."""\\n    # Check epub configuration\\n    builder_name = app.builder.name\\n    if builder_name.startswith("epub") and not app.builder.env.config.viewcode_enable_epub:\\n        return False\\n\\n    module_filename = get_module_filename(app, modname)\\n    if module_filename is None:\\n        # Always (re-)generate module page when module filename is not found.\\n        return True\\n\\n    builder = cast(StandaloneHTMLBuilder, app.builder)\\n    basename = modname.replace(\\\'.\\\', \\\'/\\\') + builder.out_suffix\\n    page_filename = path.join(app.outdir, \\\'_modules/\\\', basename)\\n\\n    try:\\n        if path.getmtime(module_filename) <= path.getmtime(page_filename):\\n            # generation is not needed if the HTML page is newer than module file.\\n            return False\\n    except IOError:\\n        pass\\n\\n    return True\\n\\n\\ndef collect_pages(app: Sphinx) -> Generator[Tuple[str, Dict[str, Any], str], None, None]:\\n    env = app.builder.env\\n    if not hasattr(env, \\\'_viewcode_modules\\\'):\\n        return\\n    highlighter = app.builder.highlighter  # type: ignore\\n    urito = app.builder.get_relative_uri\\n\\n    modnames = set(env._viewcode_modules)  # type: ignore\\n\\n    for modname, entry in status_iterator(\\n            sorted(env._viewcode_modules.items()),  # type: ignore\\n            __(\\\'highlighting module code... \\\'), "blue",\\n            len(env._viewcode_modules),  # type: ignore\\n            app.verbosity, lambda x: x[0]):\\n        if not entry:\\n            continue\\n        if not should_generate_module_page(app, modname):\\n            continue\\n\\n        code, tags, used, refname = entry\\n        # construct a page name for the highlighted source\\n        pagename = posixpath.join(OUTPUT_DIRNAME, modname.replace(\\\'.\\\', \\\'/\\\'))\\n        # highlight the source using the builder\\\'s highlighter\\n        if env.config.highlight_language in (\\\'python3\\\', \\\'default\\\', \\\'none\\\'):\\n            lexer = env.config.highlight_language\\n        else:\\n            lexer = \\\'python\\\'\\n        highlighted = highlighter.highlight_block(code, lexer, linenos=False)\\n        # split the code into lines\\n        lines = highlighted.splitlines()\\n        # split off wrap markup from the first line of the actual code\\n        before, after = lines[0].split(\\\'<pre>\\\')\\n        lines[0:1] = [before + \\\'<pre>\\\', after]\\n        # nothing to do for the last line; it always starts with </pre> anyway\\n        # now that we have code lines (starting at index 1), insert anchors for\\n        # the collected tags (HACK: this only works if the tag boundaries are\\n        # properly nested!)\\n        maxindex = len(lines) - 1\\n        for name, docname in used.items():\\n            type, start, end = tags[name]\\n            backlink = urito(pagename, docname) + \\\'#\\\' + refname + \\\'.\\\' + name\\n            lines[start] = (\\n                \\\'<div class="viewcode-block" id="%s"><a class="viewcode-back" \\\'\\n                \\\'href="%s">%s</a>\\\' % (name, backlink, _(\\\'[docs]\\\')) +\\n                lines[start])\\n            lines[min(end, maxindex)] += \\\'</div>\\\'\\n        # try to find parents (for submodules)\\n        parents = []\\n        parent = modname\\n        while \\\'.\\\' in parent:\\n            parent = parent.rsplit(\\\'.\\\', 1)[0]\\n            if parent in modnames:\\n                parents.append({\\n                    \\\'link\\\': urito(pagename,\\n                                  posixpath.join(OUTPUT_DIRNAME, parent.replace(\\\'.\\\', \\\'/\\\'))),\\n                    \\\'title\\\': parent})\\n        parents.append({\\\'link\\\': urito(pagename, posixpath.join(OUTPUT_DIRNAME, \\\'index\\\')),\\n                        \\\'title\\\': _(\\\'Module code\\\')})\\n        parents.reverse()\\n        # putting it all together\\n        context = {\\n            \\\'parents\\\': parents,\\n            \\\'title\\\': modname,\\n            \\\'body\\\': (_(\\\'<h1>Source code for %s</h1>\\\') % modname +\\n                     \\\'\\\\n\\\'.join(lines)),\\n        }\\n        yield (pagename, context, \\\'page.html\\\')\\n\\n    if not modnames:\\n        return\\n\\n    html = [\\\'\\\\n\\\']\\n    # the stack logic is needed for using nested lists for submodules\\n    stack = [\\\'\\\']\\n    for modname in sorted(modnames):\\n        if modname.startswith(stack[-1]):\\n            stack.append(modname + \\\'.\\\')\\n            html.append(\\\'<ul>\\\')\\n        else:\\n            stack.pop()\\n            stack.append(modname + \\\'.\\\')\\n            html.append(\\\'</ul>\\\' * (len(stack) - 1) + \\\'<ul>\\\')\\n        if not should_generate_module_page(app, modname):\\n            continue\\n        if modname in env._viewcode_modules and env._viewcode_modules[modname]:  # type: ignore\\n            pagename = posixpath.join(OUTPUT_DIRNAME, modname.replace(\\\'.\\\', \\\'/\\\'))\\n            html.append(\\\'<li><a href="%s">%s</a></li>\\\\n\\\' % (\\n                urito(OUTPUT_DIRNAME + \\\'/index\\\', pagename), modname))\\n\\n    if html == [\\\'\\\\n\\\']:  # no documented Python objects\\n        return\\n\\n    html.append(\\\'</ul>\\\' * len(stack))\\n    context = {\\n        \\\'title\\\': _(\\\'Overview: module code\\\'),\\n        \\\'body\\\': (_(\\\'<h1>All modules for which code is available</h1>\\\') +\\n                 \\\'\\\'.join(html)),\\n    }\\n\\n    yield (posixpath.join(OUTPUT_DIRNAME, \\\'index\\\'), context, \\\'page.html\\\')\\n\\n\\ndef setup(app: Sphinx) -> Dict[str, Any]:\\n    app.add_config_value(\\\'viewcode_enable_epub\\\', False, False)\\n    app.add_config_value(\\\'viewcode_follow_imported_members\\\', True, False)\\n    app.add_event(\\\'viewcode-find-source\\\')\\n    app.add_event(\\\'viewcode-follow-imported\\\')\\n    app.connect(\\\'doctree-read\\\', doctree_read)\\n    app.connect(\\\'env-merge-info\\\', env_merge_info)\\n    app.connect(\\\'html-collect-pages\\\', collect_pages)\\n    app.connect(\\\'missing-reference\\\', missing_reference)\\n    \\n    return {\\n        \\\'version\\\': sphinx.__display_version__,\\n        \\\'parallel_read_safe\\\': True\\n    }\'}}\n</tool_use>'}]}, {'role': 'user', 'content': [{'type': 'text', 'text': 'Tool Result: File at /testbed/sphinx/ext/viewcode.py has been overwritten with new content.'}]}, {'role': 'assistant', 'content': [{'type': 'text', 'text': "Let's run the tests again to verify our changes:"}, {'type': 'text', 'text': "<tool_use>\n{'tool_name': bash, 'tool_input': {'command': 'cd /testbed/ && tox --current-env -epy39 -v -- tests/test_ext_viewcode.py'}}\n</tool_use>"}]}, {'role': 'user', 'content': [{'type': 'text', 'text': 'Tool Result: py39: commands[0]> python -X dev -m pytest -rA --durations 25 tests/test_ext_viewcode.py\n\x1b[1m============================= test session starts ==============================\x1b[0m\nplatform linux -- Python 3.9.21, pytest-8.3.4, pluggy-1.5.0\ncachedir: .tox/py39/.pytest_cache\nlibraries: Sphinx-3.5.0+/82ef497a8, docutils-0.21.2\nbase tempdir: /tmp/pytest-of-root/pytest-2\nrootdir: /testbed\nconfigfile: setup.cfg\nplugins: cov-6.0.0\ncollected 5 items\n\ntests/test_ext_viewcode.py \x1b[31mF\x1b[0m\x1b[31mF\x1b[0m\x1b[32m.\x1b[0m\x1b[32m.\x1b[0m\x1b[32m.\x1b[0m\x1b[31m                                         [100%]\x1b[0m\n\n=================================== FAILURES ===================================\n\x1b[31m\x1b[1m________________________________ test_viewcode _________________________________\x1b[0m\n\napp = <SphinxTestApp buildername=\'html\'>\nstatus = <_io.StringIO object at 0x77e37fa730f0>\nwarning = <_io.StringIO object at 0x77e37fa73190>\n\n    \x1b[0m\x1b[37m@pytest\x1b[39;49;00m.mark.sphinx(testroot=\x1b[33m\'\x1b[39;49;00m\x1b[33mext-viewcode\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m)\x1b[90m\x1b[39;49;00m\n    \x1b[94mdef\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[92mtest_viewcode\x1b[39;49;00m(app, status, warning):\x1b[90m\x1b[39;49;00m\n        app.builder.build_all()\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        warnings = re.sub(\x1b[33mr\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[33m\\\\\x1b[39;49;00m\x1b[33m+\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m, \x1b[33m\'\x1b[39;49;00m\x1b[33m/\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m, warning.getvalue())\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m re.findall(\x1b[90m\x1b[39;49;00m\n            \x1b[33mr\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33mindex.rst:\x1b[39;49;00m\x1b[33m\\\x1b[39;49;00m\x1b[33md+: WARNING: Object named \x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[33mfunc1\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[33m not found in include \x1b[39;49;00m\x1b[33m"\x1b[39;49;00m +\x1b[90m\x1b[39;49;00m\n            \x1b[33mr\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33mfile .*/spam/__init__.py\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m,\x1b[90m\x1b[39;49;00m\n            warnings\x1b[90m\x1b[39;49;00m\n        )\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        result = (app.outdir / \x1b[33m\'\x1b[39;49;00m\x1b[33mindex.html\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m).read_text()\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m result.count(\x1b[33m\'\x1b[39;49;00m\x1b[33mhref=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m_modules/spam/mod1.html#func1\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) == \x1b[94m2\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m result.count(\x1b[33m\'\x1b[39;49;00m\x1b[33mhref=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m_modules/spam/mod2.html#func2\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) == \x1b[94m2\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m result.count(\x1b[33m\'\x1b[39;49;00m\x1b[33mhref=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m_modules/spam/mod1.html#Class1\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) == \x1b[94m2\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m result.count(\x1b[33m\'\x1b[39;49;00m\x1b[33mhref=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m_modules/spam/mod2.html#Class2\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) == \x1b[94m2\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m result.count(\x1b[33m\'\x1b[39;49;00m\x1b[33m@decorator\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) == \x1b[94m1\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        \x1b[90m# test that the class attribute is correctly documented\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m result.count(\x1b[33m\'\x1b[39;49;00m\x1b[33mthis is Class3\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) == \x1b[94m2\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m \x1b[33m\'\x1b[39;49;00m\x1b[33mthis is the class attribute class_attr\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m \x1b[95min\x1b[39;49;00m result\x1b[90m\x1b[39;49;00m\n        \x1b[90m# the next assert fails, until the autodoc bug gets fixed\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m result.count(\x1b[33m\'\x1b[39;49;00m\x1b[33mthis is the class attribute class_attr\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) == \x1b[94m2\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        result = (app.outdir / \x1b[33m\'\x1b[39;49;00m\x1b[33m_modules/spam/mod1.html\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m).read_text()\x1b[90m\x1b[39;49;00m\n        result = re.sub(\x1b[33m\'\x1b[39;49;00m\x1b[33m<span class=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m.*?\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m>\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m, \x1b[33m\'\x1b[39;49;00m\x1b[33m<span>\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m, result)  \x1b[90m# filter pygments classes\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n>       \x1b[94massert\x1b[39;49;00m (\x1b[33m\'\x1b[39;49;00m\x1b[33m<div class=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33mviewcode-block\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m id=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33mClass1\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m><a class=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33mviewcode-back\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m \x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                \x1b[33m\'\x1b[39;49;00m\x1b[33mhref=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m../../index.html#spam.Class1\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m>[docs]</a>\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                \x1b[33m\'\x1b[39;49;00m\x1b[33m<span>@decorator</span>\x1b[39;49;00m\x1b[33m\\n\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                \x1b[33m\'\x1b[39;49;00m\x1b[33m<span>class</span> <span>Class1</span>\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                \x1b[33m\'\x1b[39;49;00m\x1b[33m<span>(</span><span>object</span><span>):</span>\x1b[39;49;00m\x1b[33m\\n\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                \x1b[33m\'\x1b[39;49;00m\x1b[33m    <span>&quot;&quot;&quot;</span>\x1b[39;49;00m\x1b[33m\\n\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                \x1b[33m\'\x1b[39;49;00m\x1b[33m<span>    this is Class1</span>\x1b[39;49;00m\x1b[33m\\n\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                \x1b[33m\'\x1b[39;49;00m\x1b[33m<span>    &quot;&quot;&quot;</span></div>\x1b[39;49;00m\x1b[33m\\n\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) \x1b[95min\x1b[39;49;00m result\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31mE       assert \'<div class="viewcode-block" id="Class1"><a class="viewcode-back" href="../../index.html#spam.Class1">[docs]</a><span>...an>\\n    <span>&quot;&quot;&quot;</span>\\n<span>    this is Class1</span>\\n<span>    &quot;&quot;&quot;</span></div>\\n\' in \'\\n<!DOCTYPE html>\\n\\n<html>\\n  <head>\\n    <meta charset="utf-8" />\\n    <meta name="viewport" content="width=device-..."https://github.com/bitprophet/alabaster">Alabaster 0.7.11</a>\\n      \\n    </div>\\n\\n    \\n\\n    \\n  </body>\\n</html>\'\x1b[0m\n\n\x1b[1m\x1b[31mtests/test_ext_viewcode.py\x1b[0m:43: AssertionError\n--------------------------- Captured stdout teardown ---------------------------\n# testroot: root\n# builder: html\n# srcdir: /tmp/pytest-of-root/pytest-2/ext-viewcode\n# outdir: /tmp/pytest-of-root/pytest-2/ext-viewcode/_build/html\n# status: \n\x1b[01mRunning Sphinx v3.5.0+/82ef497a8\x1b[39;49;00m\n\x1b[01mbuilding [html]: \x1b[39;49;00mall source files\n\x1b[01mupdating environment: \x1b[39;49;00m[new config] 2 added, 0 changed, 0 removed\n\x1b[01mreading sources... \x1b[39;49;00m[ 50%] \x1b[35mindex\x1b[39;49;00m                                                \r\x1b[01mreading sources... \x1b[39;49;00m[100%] \x1b[35mobjects\x1b[39;49;00m                                              \r\n\x1b[01mlooking for now-outdated files... \x1b[39;49;00mnone found\n\x1b[01mpickling environment... \x1b[39;49;00mdone\n\x1b[01mchecking consistency... \x1b[39;49;00mdone\n\x1b[01mpreparing documents... \x1b[39;49;00mdone\n\x1b[01mwriting output... \x1b[39;49;00m[ 50%] \x1b[32mindex\x1b[39;49;00m                                                 \r\x1b[01mwriting output... \x1b[39;49;00m[100%] \x1b[32mobjects\x1b[39;49;00m                                               \r\n\x1b[01mgenerating indices... \x1b[39;49;00mgenindex py-modindex done\n\x1b[01mhighlighting module code... \x1b[39;49;00m[ 50%] \x1b[94mspam.mod1\x1b[39;49;00m                                   \r\x1b[01mhighlighting module code... \x1b[39;49;00m[100%] \x1b[94mspam.mod2\x1b[39;49;00m                                   \r\n\x1b[01mwriting additional pages... \x1b[39;49;00msearch done\n\x1b[01mcopying static files... \x1b[39;49;00mdone\n\x1b[01mcopying extra files... \x1b[39;49;00mdone\n\x1b[01mdumping search index in English (code: en)... \x1b[39;49;00mdone\n\x1b[01mdumping object inventory... \x1b[39;49;00mdone\n\n# warning: \n\x1b[91mWARNING: while setting up extension sphinx.addnodes: node class \'meta\' is already registered, its visitors will be overridden\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-2/ext-viewcode/index.rst:23: WARNING: Object named \'func1\' not found in include file \'/tmp/pytest-of-root/pytest-2/ext-viewcode/spam/__init__.py\'\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-2/ext-viewcode/spam/mod1.py:docstring of spam.mod1.Class3:1: WARNING: duplicate object description of spam.mod3.Class3, other instance in index, use :noindex: for one of them\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-2/ext-viewcode/spam/mod1.py:docstring of spam.mod3.Class3.class_attr:1: WARNING: duplicate object description of spam.mod3.Class3.class_attr, other instance in index, use :noindex: for one of them\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-2/ext-viewcode/objects.rst:84: WARNING: Error in declarator\nIf declarator-id with parameters (e.g., \'void f(int arg)\'):\n  Invalid C declaration: Expected identifier in nested name. [error at 18]\n    Sphinx_DoSomething()\n    ------------------^\nIf parenthesis in noptr-declarator (e.g., \'void (*f(int arg))(double)\'):\n  Error in declarator or parameters\n  Invalid C declaration: Expected identifier in nested name. [error at 19]\n    Sphinx_DoSomething()\n    -------------------^\n\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-2/ext-viewcode/objects.rst:86: WARNING: Error in declarator or parameters\nInvalid C declaration: Expected identifier in nested name. [error at 19]\n  SphinxStruct.member\n  -------------------^\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-2/ext-viewcode/objects.rst:92: WARNING: Error in declarator or parameters\nInvalid C declaration: Expected identifier in nested name. [error at 13]\n  sphinx_global\n  -------------^\x1b[39;49;00m\n\x1b[31m/tmp/pytest-of-root/pytest-2/ext-viewcode/objects.rst:155: WARNING: Unknown directive type "userdesc".\n\n.. userdesc:: myobj:parameter\n\n   Description of userdesc.\x1b[39;49;00m\n\x1b[31m/tmp/pytest-of-root/pytest-2/ext-viewcode/objects.rst:160: WARNING: Unknown interpreted text role "userdescrole".\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-2/ext-viewcode/objects.rst:166: WARNING: Too many template argument lists compared to parameter lists. Argument lists: 1, Parameter lists: 0, Extra empty parameters lists prepended: 1. Declaration:\n\tn::Array<T, d>\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-2/ext-viewcode/objects.rst:117: WARNING: Unparseable C cross-reference: \'SphinxType *\'\nInvalid C declaration: Expected end of definition. [error at 11]\n  SphinxType *\n  -----------^\x1b[39;49;00m\n\n\x1b[31m\x1b[1m_________________________ test_viewcode_epub_disabled __________________________\x1b[0m\n\napp = <SphinxTestApp buildername=\'epub\'>\nstatus = <_io.StringIO object at 0x77e37e673910>\nwarning = <_io.StringIO object at 0x77e37e6739b0>\n\n    \x1b[0m\x1b[37m@pytest\x1b[39;49;00m.mark.sphinx(testroot=\x1b[33m\'\x1b[39;49;00m\x1b[33mext-viewcode\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m, confoverrides={\x1b[33m\'\x1b[39;49;00m\x1b[33mviewcode_enable_epub\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m: \x1b[94mFalse\x1b[39;49;00m})\x1b[90m\x1b[39;49;00m\n    \x1b[94mdef\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[92mtest_viewcode_epub_disabled\x1b[39;49;00m(app, status, warning):\x1b[90m\x1b[39;49;00m\n        \x1b[90m# Change to epub builder\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        app.builder.name = \x1b[33m"\x1b[39;49;00m\x1b[33mepub\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        app.builder.build_all()\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        \x1b[90m# Check that _modules directory is not created when viewcode_enable_epub is False\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        modules_dir = Path(app.outdir) / \x1b[33m\'\x1b[39;49;00m\x1b[33m_modules\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n>       \x1b[94massert\x1b[39;49;00m \x1b[95mnot\x1b[39;49;00m modules_dir.exists()\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31mE       AssertionError: assert not True\x1b[0m\n\x1b[1m\x1b[31mE        +  where True = exists()\x1b[0m\n\x1b[1m\x1b[31mE        +    where exists = PosixPath(\'/tmp/pytest-of-root/pytest-2/ext-viewcode/_build/html/_modules\').exists\x1b[0m\n\n\x1b[1m\x1b[31mtests/test_ext_viewcode.py\x1b[0m:61: AssertionError\n--------------------------- Captured stdout teardown ---------------------------\n# testroot: root\n# builder: epub\n# srcdir: /tmp/pytest-of-root/pytest-2/ext-viewcode\n# outdir: /tmp/pytest-of-root/pytest-2/ext-viewcode/_build/html\n# status: \n\x1b[01mRunning Sphinx v3.5.0+/82ef497a8\x1b[39;49;00m\n\x1b[01mloading pickled environment... \x1b[39;49;00mdone\n\x1b[01mbuilding [epub]: \x1b[39;49;00mall source files\n\x1b[01mupdating environment: \x1b[39;49;00m0 added, 0 changed, 0 removed\n\x1b[01mlooking for now-outdated files... \x1b[39;49;00mnone found\n\x1b[01mpreparing documents... \x1b[39;49;00mdone\n\x1b[01mwriting output... \x1b[39;49;00m[ 50%] \x1b[32mindex\x1b[39;49;00m                                                 \r\x1b[01mwriting output... \x1b[39;49;00m[100%] \x1b[32mobjects\x1b[39;49;00m                                               \r\n\x1b[01mgenerating indices... \x1b[39;49;00mgenindex py-modindex done\n\x1b[01mhighlighting module code... \x1b[39;49;00m[ 50%] \x1b[94mspam.mod1\x1b[39;49;00m                                   \r\x1b[01mhighlighting module code... \x1b[39;49;00m[100%] \x1b[94mspam.mod2\x1b[39;49;00m                                   \r\n\x1b[01mwriting additional pages... \x1b[39;49;00msearch done\n\x1b[01mcopying static files... \x1b[39;49;00mdone\n\x1b[01mcopying extra files... \x1b[39;49;00mdone\n\x1b[01mdumping search index in English (code: en)... \x1b[39;49;00mdone\n\x1b[01mdumping object inventory... \x1b[39;49;00mdone\n\n# warning: \n\x1b[91mWARNING: while setting up extension sphinx.addnodes: node class \'meta\' is already registered, its visitors will be overridden\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-2/ext-viewcode/objects.rst:117: WARNING: Unparseable C cross-reference: \'SphinxType *\'\nInvalid C declaration: Expected end of definition. [error at 11]\n  SphinxType *\n  -----------^\x1b[39;49;00m\n\n\x1b[33m=============================== warnings summary ===============================\x1b[0m\nsphinx/util/docutils.py:45\n  /testbed/sphinx/util/docutils.py:45: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.\n    __version_info__ = tuple(LooseVersion(docutils.__version__).version)\n\nsphinx/registry.py:22\n  /testbed/sphinx/registry.py:22: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n    from pkg_resources import iter_entry_points\n\n../opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pkg_resources/__init__.py:3142\n../opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pkg_resources/__init__.py:3142\n../opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pkg_resources/__init__.py:3142\n../opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pkg_resources/__init__.py:3142\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pkg_resources/__init__.py:3142: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace(\'sphinxcontrib\')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n    declare_namespace(pkg)\n\nsphinx/directives/patches.py:14\n  /testbed/sphinx/directives/patches.py:14: DeprecationWarning: The `docutils.parsers.rst.directive.html` module will be removed in Docutils 2.0. Since Docutils 0.18, the "Meta" node is defined in `docutils.parsers.rst.directives.misc`.\n    from docutils.parsers.rst.directives import html, images, tables\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:210: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse():  # type: Node\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/i18n.py:95: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.translatable):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:110: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for ref in self.document.traverse(nodes.substitution_reference):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:131: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.target):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:150: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.block_quote):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:175: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.Element):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:222: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.index):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:189: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.section):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:279: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.doctest_block):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/domains/citation.py:116: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.citation):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/domains/citation.py:135: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.citation_reference):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/builders/latex/transforms.py:36: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(matcher):  # type: nodes.Element\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:291: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(matcher):  # type: Element\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/util/compat.py:44: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.index):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/domains/index.py:51: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in document.traverse(addnodes.index):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/domains/math.py:84: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    self.data[\'has_equations\'][docname] = any(document.traverse(math_node))\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/environment/collectors/asset.py:46: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in doctree.traverse(nodes.image):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/environment/collectors/asset.py:127: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in doctree.traverse(addnodes.download_reference):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/environment/collectors/title.py:46: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in doctree.traverse(nodes.section):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/ext/viewcode.py:91: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for objnode in doctree.traverse(addnodes.desc):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:301: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.system_message):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:390: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.manpage):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/i18n.py:488: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for inline in self.document.traverse(matcher):  # type: nodes.inline\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/domains/python.py:283: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in result.traverse(nodes.Text):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/builders/html/__init__.py:422: DeprecationWarning: The frontend.OptionParser class will be replaced by a subclass of argparse.ArgumentParser in Docutils 0.21 or later.\n    self.docsettings = OptionParser(\n\ntests/test_ext_viewcode.py: 360 warnings\n  /opt/miniconda3/envs/testbed/lib/python3.9/optparse.py:1000: DeprecationWarning: The frontend.Option class will be removed in Docutils 0.21 or later.\n    option = self.option_class(*args, **kwargs)\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/domains/c.py:3494: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(AliasNode):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/domains/cpp.py:7070: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(AliasNode):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/post_transforms/__init__.py:69: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.pending_xref):\n\ntests/test_ext_viewcode.py: 47 warnings\n  /testbed/sphinx/util/nodes.py:598: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in document.traverse(addnodes.only):\n\ntests/test_ext_viewcode.py: 18 warnings\n  /testbed/sphinx/transforms/post_transforms/images.py:33: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.image):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/post_transforms/__init__.py:216: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.desc_sig_element):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/builders/latex/transforms.py:48: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.substitution_definition):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/builders/html/transforms.py:44: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(matcher):  # type: nodes.literal\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/builders/latex/transforms.py:606: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.title):\n\ntests/test_ext_viewcode.py: 33 warnings\n  /testbed/sphinx/builders/latex/transforms.py:608: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for i, index in enumerate(node.traverse(addnodes.index)):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/post_transforms/code.py:43: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.highlightlang):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/post_transforms/code.py:95: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for lbnode in self.document.traverse(nodes.literal_block):  # type: nodes.literal_block\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/post_transforms/code.py:99: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for dbnode in self.document.traverse(nodes.doctest_block):  # type: nodes.doctest_block\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/environment/__init__.py:541: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for toctreenode in doctree.traverse(addnodes.toctree):\n\ntests/test_ext_viewcode.py: 29 warnings\n  /testbed/sphinx/environment/adapters/toctree.py:203: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for subtocnode in toc.traverse(addnodes.toctree):\n\ntests/test_ext_viewcode.py: 29 warnings\n  /testbed/sphinx/environment/adapters/toctree.py:261: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for refnode in newnode.traverse(nodes.reference):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/builders/__init__.py:181: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in doctree.traverse(nodes.image):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/builders/html/__init__.py:844: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in doctree.traverse(nodes.image):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/environment/adapters/toctree.py:312: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in toc.traverse(nodes.reference):\n\ntests/test_ext_viewcode.py: 32 warnings\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/alabaster/layout.html:114: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n    _gaq.push([\'_setAllowLinker\', true]);\n\ntests/test_ext_viewcode.py: 32 warnings\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/alabaster/about.html:70: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py: 32 warnings\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/alabaster/about.html:99: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py: 32 warnings\n  /testbed/sphinx/environment/adapters/toctree.py:328: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for toctreenode in doctree.traverse(addnodes.toctree):\n\ntests/test_ext_viewcode.py: 32 warnings\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/alabaster/layout.html:215: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py: 32 warnings\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/alabaster/layout.html:238: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  <template>:33: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  <template>:224: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  <template>:386: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  <template>:401: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py: 18 warnings\n  /testbed/sphinx/util/nodes.py:350: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for img in node.traverse(nodes.image):\n\ntests/test_ext_viewcode.py: 18 warnings\n  /testbed/sphinx/util/nodes.py:352: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for raw in node.traverse(nodes.raw):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/ext/linkcode.py:42: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for objnode in doctree.traverse(addnodes.desc):\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n==================================== PASSES ====================================\n--------------------------- Captured stdout teardown ---------------------------\n# testroot: root\n# builder: epub\n# srcdir: /tmp/pytest-of-root/pytest-2/ext-viewcode\n# outdir: /tmp/pytest-of-root/pytest-2/ext-viewcode/_build/html\n# status: \n\x1b[01mRunning Sphinx v3.5.0+/82ef497a8\x1b[39;49;00m\n\x1b[01mloading pickled environment... \x1b[39;49;00mdone\n\x1b[01mbuilding [epub]: \x1b[39;49;00mall source files\n\x1b[01mupdating environment: \x1b[39;49;00m0 added, 0 changed, 0 removed\n\x1b[01mlooking for now-outdated files... \x1b[39;49;00mnone found\n\x1b[01mpreparing documents... \x1b[39;49;00mdone\n\x1b[01mwriting output... \x1b[39;49;00m[ 50%] \x1b[32mindex\x1b[39;49;00m                                                 \r\x1b[01mwriting output... \x1b[39;49;00m[100%] \x1b[32mobjects\x1b[39;49;00m                                               \r\n\x1b[01mgenerating indices... \x1b[39;49;00mgenindex py-modindex done\n\x1b[01mhighlighting module code... \x1b[39;49;00m[ 50%] \x1b[94mspam.mod1\x1b[39;49;00m                                   \r\x1b[01mhighlighting module code... \x1b[39;49;00m[100%] \x1b[94mspam.mod2\x1b[39;49;00m                                   \r\n\x1b[01mwriting additional pages... \x1b[39;49;00msearch done\n\x1b[01mcopying static files... \x1b[39;49;00mdone\n\x1b[01mcopying extra files... \x1b[39;49;00mdone\n\x1b[01mdumping search index in English (code: en)... \x1b[39;49;00mdone\n\x1b[01mdumping object inventory... \x1b[39;49;00mdone\n\n# warning: \n\x1b[91mWARNING: while setting up extension sphinx.addnodes: node class \'meta\' is already registered, its visitors will be overridden\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-2/ext-viewcode/objects.rst:117: WARNING: Unparseable C cross-reference: \'SphinxType *\'\nInvalid C declaration: Expected end of definition. [error at 11]\n  SphinxType *\n  -----------^\x1b[39;49;00m\n\n--------------------------- Captured stdout teardown ---------------------------\n# testroot: root\n# builder: html\n# srcdir: /tmp/pytest-of-root/pytest-2/ext-viewcode\n# outdir: /tmp/pytest-of-root/pytest-2/ext-viewcode/_build/html\n# status: \n\x1b[01mRunning Sphinx v3.5.0+/82ef497a8\x1b[39;49;00m\n\x1b[01mloading pickled environment... \x1b[39;49;00mdone\n\x1b[01mupdating environment: \x1b[39;49;00m[extensions changed (\'2\')] 2 added, 0 changed, 0 removed\n\x1b[01mreading sources... \x1b[39;49;00m[ 50%] \x1b[35mindex\x1b[39;49;00m                                                \r\x1b[01mreading sources... \x1b[39;49;00m[100%] \x1b[35mobjects\x1b[39;49;00m                                              \r\n\x1b[01mlooking for now-outdated files... \x1b[39;49;00mnone found\n\x1b[01mpickling environment... \x1b[39;49;00mdone\n\x1b[01mchecking consistency... \x1b[39;49;00mdone\n\x1b[01mpreparing documents... \x1b[39;49;00mdone\n\x1b[01mwriting output... \x1b[39;49;00m[ 50%] \x1b[32mindex\x1b[39;49;00m                                                 \r\x1b[01mwriting output... \x1b[39;49;00m[100%] \x1b[32mobjects\x1b[39;49;00m                                               \r\n\x1b[01mgenerating indices... \x1b[39;49;00mgenindex py-modindex done\n\x1b[01mwriting additional pages... \x1b[39;49;00msearch done\n\x1b[01mcopying static files... \x1b[39;49;00mdone\n\x1b[01mcopying extra files... \x1b[39;49;00mdone\n\x1b[01mdumping search index in English (code: en)... \x1b[39;49;00mdone\n\x1b[01mdumping object inventory... \x1b[39;49;00mdone\n\n# warning: \n\x1b[91mWARNING: while setting up extension sphinx.addnodes: node class \'meta\' is already registered, its visitors will be overridden\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-2/ext-viewcode/index.rst:23: WARNING: Object named \'func1\' not found in include file \'/tmp/pytest-of-root/pytest-2/ext-viewcode/spam/__init__.py\'\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-2/ext-viewcode/spam/mod1.py:docstring of spam.mod1.Class3:1: WARNING: duplicate object description of spam.mod3.Class3, other instance in index, use :noindex: for one of them\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-2/ext-viewcode/spam/mod1.py:docstring of spam.mod3.Class3.class_attr:1: WARNING: duplicate object description of spam.mod3.Class3.class_attr, other instance in index, use :noindex: for one of them\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-2/ext-viewcode/objects.rst:84: WARNING: Error in declarator\nIf declarator-id with parameters (e.g., \'void f(int arg)\'):\n  Invalid C declaration: Expected identifier in nested name. [error at 18]\n    Sphinx_DoSomething()\n    ------------------^\nIf parenthesis in noptr-declarator (e.g., \'void (*f(int arg))(double)\'):\n  Error in declarator or parameters\n  Invalid C declaration: Expected identifier in nested name. [error at 19]\n    Sphinx_DoSomething()\n    -------------------^\n\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-2/ext-viewcode/objects.rst:86: WARNING: Error in declarator or parameters\nInvalid C declaration: Expected identifier in nested name. [error at 19]\n  SphinxStruct.member\n  -------------------^\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-2/ext-viewcode/objects.rst:92: WARNING: Error in declarator or parameters\nInvalid C declaration: Expected identifier in nested name. [error at 13]\n  sphinx_global\n  -------------^\x1b[39;49;00m\n\x1b[31m/tmp/pytest-of-root/pytest-2/ext-viewcode/objects.rst:155: WARNING: Unknown directive type "userdesc".\n\n.. userdesc:: myobj:parameter\n\n   Description of userdesc.\x1b[39;49;00m\n\x1b[31m/tmp/pytest-of-root/pytest-2/ext-viewcode/objects.rst:160: WARNING: Unknown interpreted text role "userdescrole".\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-2/ext-viewcode/objects.rst:166: WARNING: Too many template argument lists compared to parameter lists. Argument lists: 1, Parameter lists: 0, Extra empty parameters lists prepended: 1. Declaration:\n\tn::Array<T, d>\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-2/ext-viewcode/objects.rst:117: WARNING: Unparseable C cross-reference: \'SphinxType *\'\nInvalid C declaration: Expected end of definition. [error at 11]\n  SphinxType *\n  -----------^\x1b[39;49;00m\n\n--------------------------- Captured stdout teardown ---------------------------\n# testroot: root\n# builder: html\n# srcdir: /tmp/pytest-of-root/pytest-2/ext-viewcode-find\n# outdir: /tmp/pytest-of-root/pytest-2/ext-viewcode-find/_build/html\n# status: \n\x1b[01mRunning Sphinx v3.5.0+/82ef497a8\x1b[39;49;00m\n\x1b[01mbuilding [html]: \x1b[39;49;00mall source files\n\x1b[01mupdating environment: \x1b[39;49;00m[new config] 1 added, 0 changed, 0 removed\n\x1b[01mreading sources... \x1b[39;49;00m[100%] \x1b[35mindex\x1b[39;49;00m                                                \r\n\x1b[01mlooking for now-outdated files... \x1b[39;49;00mnone found\n\x1b[01mpickling environment... \x1b[39;49;00mdone\n\x1b[01mchecking consistency... \x1b[39;49;00mdone\n\x1b[01mpreparing documents... \x1b[39;49;00mdone\n\x1b[01mwriting output... \x1b[39;49;00m[100%] \x1b[32mindex\x1b[39;49;00m                                                 \r\n\x1b[01mgenerating indices... \x1b[39;49;00mgenindex py-modindex done\n\x1b[01mhighlighting module code... \x1b[39;49;00m[ 50%] \x1b[94mnot_a_package\x1b[39;49;00m                               \r\x1b[01mhighlighting module code... \x1b[39;49;00m[100%] \x1b[94mnot_a_package.submodule\x1b[39;49;00m                     \r\n\x1b[01mwriting additional pages... \x1b[39;49;00msearch done\n\x1b[01mcopying static files... \x1b[39;49;00mdone\n\x1b[01mcopying extra files... \x1b[39;49;00mdone\n\x1b[01mdumping search index in English (code: en)... \x1b[39;49;00mdone\n\x1b[01mdumping object inventory... \x1b[39;49;00mdone\n\n# warning: \n\x1b[91mWARNING: while setting up extension sphinx.addnodes: node class \'meta\' is already registered, its visitors will be overridden\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-2/ext-viewcode-find/index.rst:28: WARNING: Object named \'func1\' not found in include file \'/tmp/pytest-of-root/pytest-2/ext-viewcode-find/not_a_package/__init__.py\'\x1b[39;49;00m\n\n============================= slowest 25 durations =============================\n0.36s call     tests/test_ext_viewcode.py::test_viewcode\n0.26s call     tests/test_ext_viewcode.py::test_linkcode\n0.20s call     tests/test_ext_viewcode.py::test_viewcode_epub_enabled\n0.18s call     tests/test_ext_viewcode.py::test_viewcode_epub_disabled\n0.15s setup    tests/test_ext_viewcode.py::test_viewcode\n0.14s call     tests/test_ext_viewcode.py::test_local_source_files\n0.01s setup    tests/test_ext_viewcode.py::test_viewcode_epub_disabled\n0.01s setup    tests/test_ext_viewcode.py::test_local_source_files\n0.01s setup    tests/test_ext_viewcode.py::test_linkcode\n0.01s setup    tests/test_ext_viewcode.py::test_viewcode_epub_enabled\n\n(5 durations < 0.005s hidden.  Use -vv to show these durations.)\n\x1b[36m\x1b[1m=========================== short test summary info ============================\x1b[0m\n\x1b[32mPASSED\x1b[0m tests/test_ext_viewcode.py::\x1b[1mtest_viewcode_epub_enabled\x1b[0m\n\x1b[32mPASSED\x1b[0m tests/test_ext_viewcode.py::\x1b[1mtest_linkcode\x1b[0m\n\x1b[32mPASSED\x1b[0m tests/test_ext_viewcode.py::\x1b[1mtest_local_source_files\x1b[0m\n\x1b[31mFAILED\x1b[0m tests/test_ext_viewcode.py::\x1b[1mtest_viewcode\x1b[0m - assert \'<div class="viewcode-block" id="Class1"><a class="viewcode-back" hr...\n\x1b[31mFAILED\x1b[0m tests/test_ext_viewcode.py::\x1b[1mtest_viewcode_epub_disabled\x1b[0m - AssertionError: assert not True\n\x1b[31m================== \x1b[31m\x1b[1m2 failed\x1b[0m, \x1b[32m3 passed\x1b[0m, \x1b[33m1015 warnings\x1b[0m\x1b[31m in 1.47s\x1b[0m\x1b[31m ==================\x1b[0m\npy39: exit 1 (1.94 seconds) /testbed> python -X dev -m pytest -rA --durations 25 tests/test_ext_viewcode.py pid=328\n  py39: FAIL code 1 (1.95=setup[0.01]+cmd[1.94] seconds)\n  evaluation failed :( (2.04 seconds)'}]}, {'role': 'assistant', 'content': [{'type': 'text', 'text': "We still have some issues to fix. Let's modify our approach to handle the epub builder differently. Here's the corrected version:"}, {'type': 'text', 'text': '<tool_use>\n{\'tool_name\': editor, \'tool_input\': {\'command\': \'edit\', \'path\': \'/testbed/sphinx/ext/viewcode.py\', \'file_text\': \'"""\\n    sphinx.ext.viewcode\\n    ~~~~~~~~~~~~~~~~~~~\\n\\n    Add links to module code in Python object descriptions.\\n\\n    :copyright: Copyright 2007-2021 by the Sphinx team, see AUTHORS.\\n    :license: BSD, see LICENSE for details.\\n"""\\n\\nimport posixpath\\nimport traceback\\nfrom os import path\\nfrom typing import Any, Dict, Generator, Iterable, Optional, Set, Tuple, cast\\n\\nfrom docutils import nodes\\nfrom docutils.nodes import Element, Node\\n\\nimport sphinx\\nfrom sphinx import addnodes\\nfrom sphinx.application import Sphinx\\nfrom sphinx.builders.html import StandaloneHTMLBuilder\\nfrom sphinx.environment import BuildEnvironment\\nfrom sphinx.locale import _, __\\nfrom sphinx.pycode import ModuleAnalyzer\\nfrom sphinx.util import get_full_modname, logging, status_iterator\\nfrom sphinx.util.nodes import make_refnode\\n\\nlogger = logging.getLogger(__name__)\\n\\n\\nOUTPUT_DIRNAME = \\\'_modules\\\'\\n\\n\\ndef _get_full_modname(app: Sphinx, modname: str, attribute: str) -> Optional[str]:\\n    try:\\n        return get_full_modname(modname, attribute)\\n    except AttributeError:\\n        # sphinx.ext.viewcode can\\\'t follow class instance attribute\\n        # then AttributeError logging output only verbose mode.\\n        logger.verbose(\\\'Didn\\\\\\\'t find %s in %s\\\', attribute, modname)\\n        return None\\n    except Exception as e:\\n        # sphinx.ext.viewcode follow python domain directives.\\n        # because of that, if there are no real modules exists that specified\\n        # by py:function or other directives, viewcode emits a lot of warnings.\\n        # It should be displayed only verbose mode.\\n        logger.verbose(traceback.format_exc().rstrip())\\n        logger.verbose(\\\'viewcode can\\\\\\\'t import %s, failed with error "%s"\\\', modname, e)\\n        return None\\n\\n\\ndef doctree_read(app: Sphinx, doctree: Node) -> None:\\n    env = app.builder.env\\n    if not hasattr(env, \\\'_viewcode_modules\\\'):\\n        env._viewcode_modules = {}  # type: ignore\\n    if app.builder.name == "singlehtml":\\n        return\\n    if app.builder.name.startswith("epub") and not env.config.viewcode_enable_epub:\\n        return\\n\\n    def has_tag(modname: str, fullname: str, docname: str, refname: str) -> bool:\\n        entry = env._viewcode_modules.get(modname, None)  # type: ignore\\n        if entry is False:\\n            return False\\n\\n        code_tags = app.emit_firstresult(\\\'viewcode-find-source\\\', modname)\\n        if code_tags is None:\\n            try:\\n                analyzer = ModuleAnalyzer.for_module(modname)\\n                analyzer.find_tags()\\n            except Exception:\\n                env._viewcode_modules[modname] = False  # type: ignore\\n                return False\\n\\n            code = analyzer.code\\n            tags = analyzer.tags\\n        else:\\n            code, tags = code_tags\\n\\n        if entry is None or entry[0] != code:\\n            entry = code, tags, {}, refname\\n            env._viewcode_modules[modname] = entry  # type: ignore\\n        _, tags, used, _ = entry\\n        if fullname in tags:\\n            used[fullname] = docname\\n            return True\\n\\n        return False\\n\\n    for objnode in doctree.traverse(addnodes.desc):\\n        if objnode.get(\\\'domain\\\') != \\\'py\\\':\\n            continue\\n        names = set()  # type: Set[str]\\n        for signode in objnode:\\n            if not isinstance(signode, addnodes.desc_signature):\\n                continue\\n            modname = signode.get(\\\'module\\\')\\n            fullname = signode.get(\\\'fullname\\\')\\n            refname = modname\\n            if env.config.viewcode_follow_imported_members:\\n                new_modname = app.emit_firstresult(\\n                    \\\'viewcode-follow-imported\\\', modname, fullname,\\n                )\\n                if not new_modname:\\n                    new_modname = _get_full_modname(app, modname, fullname)\\n                modname = new_modname\\n            if not modname:\\n                continue\\n            fullname = signode.get(\\\'fullname\\\')\\n            if not has_tag(modname, fullname, env.docname, refname):\\n                continue\\n            if fullname in names:\\n                # only one link per name, please\\n                continue\\n            names.add(fullname)\\n            pagename = posixpath.join(OUTPUT_DIRNAME, modname.replace(\\\'.\\\', \\\'/\\\'))\\n            inline = nodes.inline(\\\'\\\', _(\\\'[source]\\\'), classes=[\\\'viewcode-link\\\'])\\n            # Create the link node only if not in epub build or if epub view is enabled\\n            if not app.builder.name.startswith("epub") or env.config.viewcode_enable_epub:\\n                onlynode = addnodes.only(expr=\\\'html\\\')\\n                onlynode += addnodes.pending_xref(\\\'\\\', inline, reftype=\\\'viewcode\\\', refdomain=\\\'std\\\',\\n                                              refexplicit=False, reftarget=pagename,\\n                                              refid=fullname, refdoc=env.docname)\\n                signode += onlynode\\n\\n\\ndef env_merge_info(app: Sphinx, env: BuildEnvironment, docnames: Iterable[str],\\n                   other: BuildEnvironment) -> None:\\n    if not hasattr(other, \\\'_viewcode_modules\\\'):\\n        return\\n    # create a _viewcode_modules dict on the main environment\\n    if not hasattr(env, \\\'_viewcode_modules\\\'):\\n        env._viewcode_modules = {}  # type: ignore\\n    # now merge in the information from the subprocess\\n    env._viewcode_modules.update(other._viewcode_modules)  # type: ignore\\n\\n\\ndef missing_reference(app: Sphinx, env: BuildEnvironment, node: Element, contnode: Node\\n                      ) -> Optional[Node]:\\n    # resolve our "viewcode" reference nodes -- they need special treatment\\n    if node[\\\'reftype\\\'] == \\\'viewcode\\\':\\n        return make_refnode(app.builder, node[\\\'refdoc\\\'], node[\\\'reftarget\\\'],\\n                            node[\\\'refid\\\'], contnode)\\n\\n    return None\\n\\n\\ndef get_module_filename(app: Sphinx, modname: str) -> Optional[str]:\\n    """Get module filename for *modname*."""\\n    source_info = app.emit_firstresult(\\\'viewcode-find-source\\\', modname)\\n    if source_info:\\n        return None\\n    else:\\n        try:\\n            filename, source = ModuleAnalyzer.get_module_source(modname)\\n            return filename\\n        except Exception:\\n            return None\\n\\n\\ndef should_generate_module_page(app: Sphinx, modname: str) -> bool:\\n    """Check generation of module page is needed."""\\n    # Check epub configuration\\n    if app.builder.name.startswith("epub") and not app.builder.env.config.viewcode_enable_epub:\\n        return False\\n\\n    module_filename = get_module_filename(app, modname)\\n    if module_filename is None:\\n        # Always (re-)generate module page when module filename is not found.\\n        return True\\n\\n    builder = cast(StandaloneHTMLBuilder, app.builder)\\n    basename = modname.replace(\\\'.\\\', \\\'/\\\') + builder.out_suffix\\n    page_filename = path.join(app.outdir, \\\'_modules/\\\', basename)\\n\\n    try:\\n        if path.getmtime(module_filename) <= path.getmtime(page_filename):\\n            # generation is not needed if the HTML page is newer than module file.\\n            return False\\n    except IOError:\\n        pass\\n\\n    return True\\n\\n\\ndef collect_pages(app: Sphinx) -> Generator[Tuple[str, Dict[str, Any], str], None, None]:\\n    # Skip for epub builder if viewcode_enable_epub is False\\n    if app.builder.name.startswith("epub") and not app.builder.env.config.viewcode_enable_epub:\\n        return\\n\\n    env = app.builder.env\\n    if not hasattr(env, \\\'_viewcode_modules\\\'):\\n        return\\n    highlighter = app.builder.highlighter  # type: ignore\\n    urito = app.builder.get_relative_uri\\n\\n    modnames = set(env._viewcode_modules)  # type: ignore\\n\\n    for modname, entry in status_iterator(\\n            sorted(env._viewcode_modules.items()),  # type: ignore\\n            __(\\\'highlighting module code... \\\'), "blue",\\n            len(env._viewcode_modules),  # type: ignore\\n            app.verbosity, lambda x: x[0]):\\n        if not entry:\\n            continue\\n        code, tags, used, refname = entry\\n        # construct a page name for the highlighted source\\n        pagename = posixpath.join(OUTPUT_DIRNAME, modname.replace(\\\'.\\\', \\\'/\\\'))\\n        # highlight the source using the builder\\\'s highlighter\\n        if env.config.highlight_language in (\\\'python3\\\', \\\'default\\\', \\\'none\\\'):\\n            lexer = env.config.highlight_language\\n        else:\\n            lexer = \\\'python\\\'\\n        highlighted = highlighter.highlight_block(code, lexer, linenos=False)\\n        # split the code into lines\\n        lines = highlighted.splitlines()\\n        # split off wrap markup from the first line of the actual code\\n        before, after = lines[0].split(\\\'<pre>\\\')\\n        lines[0:1] = [before + \\\'<pre>\\\', after]\\n        # nothing to do for the last line; it always starts with </pre> anyway\\n        # now that we have code lines (starting at index 1), insert anchors for\\n        # the collected tags (HACK: this only works if the tag boundaries are\\n        # properly nested!)\\n        maxindex = len(lines) - 1\\n        for name, docname in used.items():\\n            type, start, end = tags[name]\\n            backlink = urito(pagename, docname) + \\\'#\\\' + refname + \\\'.\\\' + name\\n            lines[start] = (\\n                \\\'<div class="viewcode-block" id="%s"><a class="viewcode-back" \\\'\\n                \\\'href="%s">%s</a>\\\' % (name, backlink, _(\\\'[docs]\\\')) +\\n                lines[start])\\n            lines[min(end, maxindex)] += \\\'</div>\\\'\\n        # try to find parents (for submodules)\\n        parents = []\\n        parent = modname\\n        while \\\'.\\\' in parent:\\n            parent = parent.rsplit(\\\'.\\\', 1)[0]\\n            if parent in modnames:\\n                parents.append({\\n                    \\\'link\\\': urito(pagename,\\n                                  posixpath.join(OUTPUT_DIRNAME, parent.replace(\\\'.\\\', \\\'/\\\'))),\\n                    \\\'title\\\': parent})\\n        parents.append({\\\'link\\\': urito(pagename, posixpath.join(OUTPUT_DIRNAME, \\\'index\\\')),\\n                        \\\'title\\\': _(\\\'Module code\\\')})\\n        parents.reverse()\\n        # putting it all together\\n        context = {\\n            \\\'parents\\\': parents,\\n            \\\'title\\\': modname,\\n            \\\'body\\\': (_(\\\'<h1>Source code for %s</h1>\\\') % modname +\\n                     \\\'\\\\n\\\'.join(lines)),\\n        }\\n        yield (pagename, context, \\\'page.html\\\')\\n\\n    if not modnames:\\n        return\\n\\n    html = [\\\'\\\\n\\\']\\n    # the stack logic is needed for using nested lists for submodules\\n    stack = [\\\'\\\']\\n    for modname in sorted(modnames):\\n        if modname.startswith(stack[-1]):\\n            stack.append(modname + \\\'.\\\')\\n            html.append(\\\'<ul>\\\')\\n        else:\\n            stack.pop()\\n            stack.append(modname + \\\'.\\\')\\n            html.append(\\\'</ul>\\\' * (len(stack) - 1) + \\\'<ul>\\\')\\n        if modname in env._viewcode_modules and env._viewcode_modules[modname]:  # type: ignore\\n            pagename = posixpath.join(OUTPUT_DIRNAME, modname.replace(\\\'.\\\', \\\'/\\\'))\\n            html.append(\\\'<li><a href="%s">%s</a></li>\\\\n\\\' % (\\n                urito(OUTPUT_DIRNAME + \\\'/index\\\', pagename), modname))\\n\\n    if html == [\\\'\\\\n\\\']:  # no documented Python objects\\n        return\\n\\n    html.append(\\\'</ul>\\\' * len(stack))\\n    context = {\\n        \\\'title\\\': _(\\\'Overview: module code\\\'),\\n        \\\'body\\\': (_(\\\'<h1>All modules for which code is available</h1>\\\') +\\n                 \\\'\\\'.join(html)),\\n    }\\n\\n    yield (posixpath.join(OUTPUT_DIRNAME, \\\'index\\\'), context, \\\'page.html\\\')\\n\\n\\ndef builder_inited(app: Sphinx) -> None:\\n    # Skip _modules directory creation for epub builder if viewcode_enable_epub is False\\n    if app.builder.name.startswith("epub") and not app.builder.env.config.viewcode_enable_epub:\\n        return\\n    if hasattr(app.builder, \\\'outdir\\\'):\\n        modules_dir = path.join(app.builder.outdir, \\\'_modules\\\')\\n        if not path.isdir(modules_dir):\\n            makedirs_func = getattr(path, \\\'makedirs\\\', None)\\n            if makedirs_func:\\n                makedirs_func(modules_dir)\\n\\n\\ndef setup(app: Sphinx) -> Dict[str, Any]:\\n    app.add_config_value(\\\'viewcode_enable_epub\\\', False, False)\\n    app.add_config_value(\\\'viewcode_follow_imported_members\\\', True, False)\\n    app.add_event(\\\'viewcode-find-source\\\')\\n    app.add_event(\\\'viewcode-follow-imported\\\')\\n    app.connect(\\\'builder-inited\\\', builder_inited)\\n    app.connect(\\\'doctree-read\\\', doctree_read)\\n    app.connect(\\\'env-merge-info\\\', env_merge_info)\\n    app.connect(\\\'missing-reference\\\', missing_reference)\\n    app.connect(\\\'html-collect-pages\\\', collect_pages)\\n    \\n    return {\\n        \\\'version\\\': sphinx.__display_version__,\\n        \\\'parallel_read_safe\\\': True\\n    }\'}}\n</tool_use>'}]}, {'role': 'user', 'content': [{'type': 'text', 'text': 'Tool Result: File at /testbed/sphinx/ext/viewcode.py has been overwritten with new content.'}]}, {'role': 'assistant', 'content': [{'type': 'text', 'text': "Let's run the tests again:"}, {'type': 'text', 'text': "<tool_use>\n{'tool_name': bash, 'tool_input': {'command': 'cd /testbed/ && tox --current-env -epy39 -v -- tests/test_ext_viewcode.py'}}\n</tool_use>"}]}, {'role': 'user', 'content': [{'type': 'text', 'text': 'Tool Result: py39: commands[0]> python -X dev -m pytest -rA --durations 25 tests/test_ext_viewcode.py\n\x1b[1m============================= test session starts ==============================\x1b[0m\nplatform linux -- Python 3.9.21, pytest-8.3.4, pluggy-1.5.0\ncachedir: .tox/py39/.pytest_cache\nlibraries: Sphinx-3.5.0+/82ef497a8, docutils-0.21.2\nbase tempdir: /tmp/pytest-of-root/pytest-3\nrootdir: /testbed\nconfigfile: setup.cfg\nplugins: cov-6.0.0\ncollected 5 items\n\ntests/test_ext_viewcode.py \x1b[31mF\x1b[0m\x1b[31mF\x1b[0m\x1b[32m.\x1b[0m\x1b[32m.\x1b[0m\x1b[32m.\x1b[0m\x1b[31m                                         [100%]\x1b[0m\n\n=================================== FAILURES ===================================\n\x1b[31m\x1b[1m________________________________ test_viewcode _________________________________\x1b[0m\n\napp = <SphinxTestApp buildername=\'html\'>\nstatus = <_io.StringIO object at 0x725642ef30f0>\nwarning = <_io.StringIO object at 0x725642ef3190>\n\n    \x1b[0m\x1b[37m@pytest\x1b[39;49;00m.mark.sphinx(testroot=\x1b[33m\'\x1b[39;49;00m\x1b[33mext-viewcode\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m)\x1b[90m\x1b[39;49;00m\n    \x1b[94mdef\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[92mtest_viewcode\x1b[39;49;00m(app, status, warning):\x1b[90m\x1b[39;49;00m\n        app.builder.build_all()\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        warnings = re.sub(\x1b[33mr\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[33m\\\\\x1b[39;49;00m\x1b[33m+\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m, \x1b[33m\'\x1b[39;49;00m\x1b[33m/\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m, warning.getvalue())\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m re.findall(\x1b[90m\x1b[39;49;00m\n            \x1b[33mr\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33mindex.rst:\x1b[39;49;00m\x1b[33m\\\x1b[39;49;00m\x1b[33md+: WARNING: Object named \x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[33mfunc1\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[33m not found in include \x1b[39;49;00m\x1b[33m"\x1b[39;49;00m +\x1b[90m\x1b[39;49;00m\n            \x1b[33mr\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33mfile .*/spam/__init__.py\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m,\x1b[90m\x1b[39;49;00m\n            warnings\x1b[90m\x1b[39;49;00m\n        )\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        result = (app.outdir / \x1b[33m\'\x1b[39;49;00m\x1b[33mindex.html\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m).read_text()\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m result.count(\x1b[33m\'\x1b[39;49;00m\x1b[33mhref=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m_modules/spam/mod1.html#func1\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) == \x1b[94m2\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m result.count(\x1b[33m\'\x1b[39;49;00m\x1b[33mhref=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m_modules/spam/mod2.html#func2\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) == \x1b[94m2\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m result.count(\x1b[33m\'\x1b[39;49;00m\x1b[33mhref=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m_modules/spam/mod1.html#Class1\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) == \x1b[94m2\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m result.count(\x1b[33m\'\x1b[39;49;00m\x1b[33mhref=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m_modules/spam/mod2.html#Class2\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) == \x1b[94m2\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m result.count(\x1b[33m\'\x1b[39;49;00m\x1b[33m@decorator\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) == \x1b[94m1\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        \x1b[90m# test that the class attribute is correctly documented\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m result.count(\x1b[33m\'\x1b[39;49;00m\x1b[33mthis is Class3\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) == \x1b[94m2\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m \x1b[33m\'\x1b[39;49;00m\x1b[33mthis is the class attribute class_attr\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m \x1b[95min\x1b[39;49;00m result\x1b[90m\x1b[39;49;00m\n        \x1b[90m# the next assert fails, until the autodoc bug gets fixed\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m result.count(\x1b[33m\'\x1b[39;49;00m\x1b[33mthis is the class attribute class_attr\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) == \x1b[94m2\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        result = (app.outdir / \x1b[33m\'\x1b[39;49;00m\x1b[33m_modules/spam/mod1.html\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m).read_text()\x1b[90m\x1b[39;49;00m\n        result = re.sub(\x1b[33m\'\x1b[39;49;00m\x1b[33m<span class=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m.*?\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m>\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m, \x1b[33m\'\x1b[39;49;00m\x1b[33m<span>\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m, result)  \x1b[90m# filter pygments classes\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n>       \x1b[94massert\x1b[39;49;00m (\x1b[33m\'\x1b[39;49;00m\x1b[33m<div class=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33mviewcode-block\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m id=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33mClass1\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m><a class=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33mviewcode-back\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m \x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                \x1b[33m\'\x1b[39;49;00m\x1b[33mhref=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m../../index.html#spam.Class1\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m>[docs]</a>\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                \x1b[33m\'\x1b[39;49;00m\x1b[33m<span>@decorator</span>\x1b[39;49;00m\x1b[33m\\n\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                \x1b[33m\'\x1b[39;49;00m\x1b[33m<span>class</span> <span>Class1</span>\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                \x1b[33m\'\x1b[39;49;00m\x1b[33m<span>(</span><span>object</span><span>):</span>\x1b[39;49;00m\x1b[33m\\n\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                \x1b[33m\'\x1b[39;49;00m\x1b[33m    <span>&quot;&quot;&quot;</span>\x1b[39;49;00m\x1b[33m\\n\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                \x1b[33m\'\x1b[39;49;00m\x1b[33m<span>    this is Class1</span>\x1b[39;49;00m\x1b[33m\\n\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                \x1b[33m\'\x1b[39;49;00m\x1b[33m<span>    &quot;&quot;&quot;</span></div>\x1b[39;49;00m\x1b[33m\\n\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) \x1b[95min\x1b[39;49;00m result\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31mE       assert \'<div class="viewcode-block" id="Class1"><a class="viewcode-back" href="../../index.html#spam.Class1">[docs]</a><span>...an>\\n    <span>&quot;&quot;&quot;</span>\\n<span>    this is Class1</span>\\n<span>    &quot;&quot;&quot;</span></div>\\n\' in \'\\n<!DOCTYPE html>\\n\\n<html>\\n  <head>\\n    <meta charset="utf-8" />\\n    <meta name="viewport" content="width=device-..."https://github.com/bitprophet/alabaster">Alabaster 0.7.11</a>\\n      \\n    </div>\\n\\n    \\n\\n    \\n  </body>\\n</html>\'\x1b[0m\n\n\x1b[1m\x1b[31mtests/test_ext_viewcode.py\x1b[0m:43: AssertionError\n--------------------------- Captured stdout teardown ---------------------------\n# testroot: root\n# builder: html\n# srcdir: /tmp/pytest-of-root/pytest-3/ext-viewcode\n# outdir: /tmp/pytest-of-root/pytest-3/ext-viewcode/_build/html\n# status: \n\x1b[01mRunning Sphinx v3.5.0+/82ef497a8\x1b[39;49;00m\n\x1b[01mbuilding [html]: \x1b[39;49;00mall source files\n\x1b[01mupdating environment: \x1b[39;49;00m[new config] 2 added, 0 changed, 0 removed\n\x1b[01mreading sources... \x1b[39;49;00m[ 50%] \x1b[35mindex\x1b[39;49;00m                                                \r\x1b[01mreading sources... \x1b[39;49;00m[100%] \x1b[35mobjects\x1b[39;49;00m                                              \r\n\x1b[01mlooking for now-outdated files... \x1b[39;49;00mnone found\n\x1b[01mpickling environment... \x1b[39;49;00mdone\n\x1b[01mchecking consistency... \x1b[39;49;00mdone\n\x1b[01mpreparing documents... \x1b[39;49;00mdone\n\x1b[01mwriting output... \x1b[39;49;00m[ 50%] \x1b[32mindex\x1b[39;49;00m                                                 \r\x1b[01mwriting output... \x1b[39;49;00m[100%] \x1b[32mobjects\x1b[39;49;00m                                               \r\n\x1b[01mgenerating indices... \x1b[39;49;00mgenindex py-modindex done\n\x1b[01mhighlighting module code... \x1b[39;49;00m[ 50%] \x1b[94mspam.mod1\x1b[39;49;00m                                   \r\x1b[01mhighlighting module code... \x1b[39;49;00m[100%] \x1b[94mspam.mod2\x1b[39;49;00m                                   \r\n\x1b[01mwriting additional pages... \x1b[39;49;00msearch done\n\x1b[01mcopying static files... \x1b[39;49;00mdone\n\x1b[01mcopying extra files... \x1b[39;49;00mdone\n\x1b[01mdumping search index in English (code: en)... \x1b[39;49;00mdone\n\x1b[01mdumping object inventory... \x1b[39;49;00mdone\n\n# warning: \n\x1b[91mWARNING: while setting up extension sphinx.addnodes: node class \'meta\' is already registered, its visitors will be overridden\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-3/ext-viewcode/index.rst:23: WARNING: Object named \'func1\' not found in include file \'/tmp/pytest-of-root/pytest-3/ext-viewcode/spam/__init__.py\'\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-3/ext-viewcode/spam/mod1.py:docstring of spam.mod1.Class3:1: WARNING: duplicate object description of spam.mod3.Class3, other instance in index, use :noindex: for one of them\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-3/ext-viewcode/spam/mod1.py:docstring of spam.mod3.Class3.class_attr:1: WARNING: duplicate object description of spam.mod3.Class3.class_attr, other instance in index, use :noindex: for one of them\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-3/ext-viewcode/objects.rst:84: WARNING: Error in declarator\nIf declarator-id with parameters (e.g., \'void f(int arg)\'):\n  Invalid C declaration: Expected identifier in nested name. [error at 18]\n    Sphinx_DoSomething()\n    ------------------^\nIf parenthesis in noptr-declarator (e.g., \'void (*f(int arg))(double)\'):\n  Error in declarator or parameters\n  Invalid C declaration: Expected identifier in nested name. [error at 19]\n    Sphinx_DoSomething()\n    -------------------^\n\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-3/ext-viewcode/objects.rst:86: WARNING: Error in declarator or parameters\nInvalid C declaration: Expected identifier in nested name. [error at 19]\n  SphinxStruct.member\n  -------------------^\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-3/ext-viewcode/objects.rst:92: WARNING: Error in declarator or parameters\nInvalid C declaration: Expected identifier in nested name. [error at 13]\n  sphinx_global\n  -------------^\x1b[39;49;00m\n\x1b[31m/tmp/pytest-of-root/pytest-3/ext-viewcode/objects.rst:155: WARNING: Unknown directive type "userdesc".\n\n.. userdesc:: myobj:parameter\n\n   Description of userdesc.\x1b[39;49;00m\n\x1b[31m/tmp/pytest-of-root/pytest-3/ext-viewcode/objects.rst:160: WARNING: Unknown interpreted text role "userdescrole".\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-3/ext-viewcode/objects.rst:166: WARNING: Too many template argument lists compared to parameter lists. Argument lists: 1, Parameter lists: 0, Extra empty parameters lists prepended: 1. Declaration:\n\tn::Array<T, d>\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-3/ext-viewcode/objects.rst:117: WARNING: Unparseable C cross-reference: \'SphinxType *\'\nInvalid C declaration: Expected end of definition. [error at 11]\n  SphinxType *\n  -----------^\x1b[39;49;00m\n\n\x1b[31m\x1b[1m_________________________ test_viewcode_epub_disabled __________________________\x1b[0m\n\napp = <SphinxTestApp buildername=\'epub\'>\nstatus = <_io.StringIO object at 0x725641aeaa50>\nwarning = <_io.StringIO object at 0x725641aeaaf0>\n\n    \x1b[0m\x1b[37m@pytest\x1b[39;49;00m.mark.sphinx(testroot=\x1b[33m\'\x1b[39;49;00m\x1b[33mext-viewcode\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m, confoverrides={\x1b[33m\'\x1b[39;49;00m\x1b[33mviewcode_enable_epub\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m: \x1b[94mFalse\x1b[39;49;00m})\x1b[90m\x1b[39;49;00m\n    \x1b[94mdef\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[92mtest_viewcode_epub_disabled\x1b[39;49;00m(app, status, warning):\x1b[90m\x1b[39;49;00m\n        \x1b[90m# Change to epub builder\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        app.builder.name = \x1b[33m"\x1b[39;49;00m\x1b[33mepub\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        app.builder.build_all()\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        \x1b[90m# Check that _modules directory is not created when viewcode_enable_epub is False\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        modules_dir = Path(app.outdir) / \x1b[33m\'\x1b[39;49;00m\x1b[33m_modules\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n>       \x1b[94massert\x1b[39;49;00m \x1b[95mnot\x1b[39;49;00m modules_dir.exists()\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31mE       AssertionError: assert not True\x1b[0m\n\x1b[1m\x1b[31mE        +  where True = exists()\x1b[0m\n\x1b[1m\x1b[31mE        +    where exists = PosixPath(\'/tmp/pytest-of-root/pytest-3/ext-viewcode/_build/html/_modules\').exists\x1b[0m\n\n\x1b[1m\x1b[31mtests/test_ext_viewcode.py\x1b[0m:61: AssertionError\n--------------------------- Captured stdout teardown ---------------------------\n# testroot: root\n# builder: epub\n# srcdir: /tmp/pytest-of-root/pytest-3/ext-viewcode\n# outdir: /tmp/pytest-of-root/pytest-3/ext-viewcode/_build/html\n# status: \n\x1b[01mRunning Sphinx v3.5.0+/82ef497a8\x1b[39;49;00m\n\x1b[01mloading pickled environment... \x1b[39;49;00mdone\n\x1b[01mbuilding [epub]: \x1b[39;49;00mall source files\n\x1b[01mupdating environment: \x1b[39;49;00m0 added, 0 changed, 0 removed\n\x1b[01mlooking for now-outdated files... \x1b[39;49;00mnone found\n\x1b[01mpreparing documents... \x1b[39;49;00mdone\n\x1b[01mwriting output... \x1b[39;49;00m[ 50%] \x1b[32mindex\x1b[39;49;00m                                                 \r\x1b[01mwriting output... \x1b[39;49;00m[100%] \x1b[32mobjects\x1b[39;49;00m                                               \r\n\x1b[01mgenerating indices... \x1b[39;49;00mgenindex py-modindex done\n\x1b[01mwriting additional pages... \x1b[39;49;00msearch done\n\x1b[01mcopying static files... \x1b[39;49;00mdone\n\x1b[01mcopying extra files... \x1b[39;49;00mdone\n\x1b[01mdumping search index in English (code: en)... \x1b[39;49;00mdone\n\x1b[01mdumping object inventory... \x1b[39;49;00mdone\n\n# warning: \n\x1b[91mWARNING: while setting up extension sphinx.addnodes: node class \'meta\' is already registered, its visitors will be overridden\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-3/ext-viewcode/objects.rst:117: WARNING: Unparseable C cross-reference: \'SphinxType *\'\nInvalid C declaration: Expected end of definition. [error at 11]\n  SphinxType *\n  -----------^\x1b[39;49;00m\n\n\x1b[33m=============================== warnings summary ===============================\x1b[0m\nsphinx/util/docutils.py:45\n  /testbed/sphinx/util/docutils.py:45: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.\n    __version_info__ = tuple(LooseVersion(docutils.__version__).version)\n\nsphinx/registry.py:22\n  /testbed/sphinx/registry.py:22: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n    from pkg_resources import iter_entry_points\n\n../opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pkg_resources/__init__.py:3142\n../opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pkg_resources/__init__.py:3142\n../opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pkg_resources/__init__.py:3142\n../opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pkg_resources/__init__.py:3142\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pkg_resources/__init__.py:3142: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace(\'sphinxcontrib\')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n    declare_namespace(pkg)\n\nsphinx/directives/patches.py:14\n  /testbed/sphinx/directives/patches.py:14: DeprecationWarning: The `docutils.parsers.rst.directive.html` module will be removed in Docutils 2.0. Since Docutils 0.18, the "Meta" node is defined in `docutils.parsers.rst.directives.misc`.\n    from docutils.parsers.rst.directives import html, images, tables\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:210: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse():  # type: Node\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/i18n.py:95: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.translatable):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:110: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for ref in self.document.traverse(nodes.substitution_reference):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:131: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.target):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:150: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.block_quote):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:175: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.Element):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:222: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.index):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:189: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.section):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:279: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.doctest_block):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/domains/citation.py:116: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.citation):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/domains/citation.py:135: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.citation_reference):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/builders/latex/transforms.py:36: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(matcher):  # type: nodes.Element\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:291: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(matcher):  # type: Element\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/util/compat.py:44: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.index):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/domains/index.py:51: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in document.traverse(addnodes.index):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/domains/math.py:84: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    self.data[\'has_equations\'][docname] = any(document.traverse(math_node))\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/environment/collectors/asset.py:46: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in doctree.traverse(nodes.image):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/environment/collectors/asset.py:127: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in doctree.traverse(addnodes.download_reference):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/environment/collectors/title.py:46: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in doctree.traverse(nodes.section):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/ext/viewcode.py:91: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for objnode in doctree.traverse(addnodes.desc):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:301: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.system_message):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:390: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.manpage):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/i18n.py:488: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for inline in self.document.traverse(matcher):  # type: nodes.inline\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/domains/python.py:283: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in result.traverse(nodes.Text):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/builders/html/__init__.py:422: DeprecationWarning: The frontend.OptionParser class will be replaced by a subclass of argparse.ArgumentParser in Docutils 0.21 or later.\n    self.docsettings = OptionParser(\n\ntests/test_ext_viewcode.py: 360 warnings\n  /opt/miniconda3/envs/testbed/lib/python3.9/optparse.py:1000: DeprecationWarning: The frontend.Option class will be removed in Docutils 0.21 or later.\n    option = self.option_class(*args, **kwargs)\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/domains/c.py:3494: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(AliasNode):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/domains/cpp.py:7070: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(AliasNode):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/post_transforms/__init__.py:69: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.pending_xref):\n\ntests/test_ext_viewcode.py: 48 warnings\n  /testbed/sphinx/util/nodes.py:598: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in document.traverse(addnodes.only):\n\ntests/test_ext_viewcode.py: 18 warnings\n  /testbed/sphinx/transforms/post_transforms/images.py:33: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.image):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/post_transforms/__init__.py:216: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.desc_sig_element):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/builders/latex/transforms.py:48: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.substitution_definition):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/builders/html/transforms.py:44: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(matcher):  # type: nodes.literal\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/builders/latex/transforms.py:606: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.title):\n\ntests/test_ext_viewcode.py: 33 warnings\n  /testbed/sphinx/builders/latex/transforms.py:608: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for i, index in enumerate(node.traverse(addnodes.index)):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/post_transforms/code.py:43: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.highlightlang):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/post_transforms/code.py:95: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for lbnode in self.document.traverse(nodes.literal_block):  # type: nodes.literal_block\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/post_transforms/code.py:99: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for dbnode in self.document.traverse(nodes.doctest_block):  # type: nodes.doctest_block\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/environment/__init__.py:541: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for toctreenode in doctree.traverse(addnodes.toctree):\n\ntests/test_ext_viewcode.py: 30 warnings\n  /testbed/sphinx/environment/adapters/toctree.py:203: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for subtocnode in toc.traverse(addnodes.toctree):\n\ntests/test_ext_viewcode.py: 30 warnings\n  /testbed/sphinx/environment/adapters/toctree.py:261: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for refnode in newnode.traverse(nodes.reference):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/builders/__init__.py:181: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in doctree.traverse(nodes.image):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/builders/html/__init__.py:844: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in doctree.traverse(nodes.image):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/environment/adapters/toctree.py:312: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in toc.traverse(nodes.reference):\n\ntests/test_ext_viewcode.py: 33 warnings\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/alabaster/layout.html:114: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n    _gaq.push([\'_setAllowLinker\', true]);\n\ntests/test_ext_viewcode.py: 33 warnings\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/alabaster/about.html:70: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py: 33 warnings\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/alabaster/about.html:99: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py: 33 warnings\n  /testbed/sphinx/environment/adapters/toctree.py:328: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for toctreenode in doctree.traverse(addnodes.toctree):\n\ntests/test_ext_viewcode.py: 33 warnings\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/alabaster/layout.html:215: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py: 33 warnings\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/alabaster/layout.html:238: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  <template>:33: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  <template>:224: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  <template>:386: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  <template>:401: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py: 18 warnings\n  /testbed/sphinx/util/nodes.py:350: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for img in node.traverse(nodes.image):\n\ntests/test_ext_viewcode.py: 18 warnings\n  /testbed/sphinx/util/nodes.py:352: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for raw in node.traverse(nodes.raw):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/ext/linkcode.py:42: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for objnode in doctree.traverse(addnodes.desc):\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n==================================== PASSES ====================================\n--------------------------- Captured stdout teardown ---------------------------\n# testroot: root\n# builder: epub\n# srcdir: /tmp/pytest-of-root/pytest-3/ext-viewcode\n# outdir: /tmp/pytest-of-root/pytest-3/ext-viewcode/_build/html\n# status: \n\x1b[01mRunning Sphinx v3.5.0+/82ef497a8\x1b[39;49;00m\n\x1b[01mloading pickled environment... \x1b[39;49;00mdone\n\x1b[01mbuilding [epub]: \x1b[39;49;00mall source files\n\x1b[01mupdating environment: \x1b[39;49;00m0 added, 0 changed, 0 removed\n\x1b[01mlooking for now-outdated files... \x1b[39;49;00mnone found\n\x1b[01mpreparing documents... \x1b[39;49;00mdone\n\x1b[01mwriting output... \x1b[39;49;00m[ 50%] \x1b[32mindex\x1b[39;49;00m                                                 \r\x1b[01mwriting output... \x1b[39;49;00m[100%] \x1b[32mobjects\x1b[39;49;00m                                               \r\n\x1b[01mgenerating indices... \x1b[39;49;00mgenindex py-modindex done\n\x1b[01mhighlighting module code... \x1b[39;49;00m[ 50%] \x1b[94mspam.mod1\x1b[39;49;00m                                   \r\x1b[01mhighlighting module code... \x1b[39;49;00m[100%] \x1b[94mspam.mod2\x1b[39;49;00m                                   \r\n\x1b[01mwriting additional pages... \x1b[39;49;00msearch done\n\x1b[01mcopying static files... \x1b[39;49;00mdone\n\x1b[01mcopying extra files... \x1b[39;49;00mdone\n\x1b[01mdumping search index in English (code: en)... \x1b[39;49;00mdone\n\x1b[01mdumping object inventory... \x1b[39;49;00mdone\n\n# warning: \n\x1b[91mWARNING: while setting up extension sphinx.addnodes: node class \'meta\' is already registered, its visitors will be overridden\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-3/ext-viewcode/objects.rst:117: WARNING: Unparseable C cross-reference: \'SphinxType *\'\nInvalid C declaration: Expected end of definition. [error at 11]\n  SphinxType *\n  -----------^\x1b[39;49;00m\n\n--------------------------- Captured stdout teardown ---------------------------\n# testroot: root\n# builder: html\n# srcdir: /tmp/pytest-of-root/pytest-3/ext-viewcode\n# outdir: /tmp/pytest-of-root/pytest-3/ext-viewcode/_build/html\n# status: \n\x1b[01mRunning Sphinx v3.5.0+/82ef497a8\x1b[39;49;00m\n\x1b[01mloading pickled environment... \x1b[39;49;00mdone\n\x1b[01mupdating environment: \x1b[39;49;00m[extensions changed (\'2\')] 2 added, 0 changed, 0 removed\n\x1b[01mreading sources... \x1b[39;49;00m[ 50%] \x1b[35mindex\x1b[39;49;00m                                                \r\x1b[01mreading sources... \x1b[39;49;00m[100%] \x1b[35mobjects\x1b[39;49;00m                                              \r\n\x1b[01mlooking for now-outdated files... \x1b[39;49;00mnone found\n\x1b[01mpickling environment... \x1b[39;49;00mdone\n\x1b[01mchecking consistency... \x1b[39;49;00mdone\n\x1b[01mpreparing documents... \x1b[39;49;00mdone\n\x1b[01mwriting output... \x1b[39;49;00m[ 50%] \x1b[32mindex\x1b[39;49;00m                                                 \r\x1b[01mwriting output... \x1b[39;49;00m[100%] \x1b[32mobjects\x1b[39;49;00m                                               \r\n\x1b[01mgenerating indices... \x1b[39;49;00mgenindex py-modindex done\n\x1b[01mwriting additional pages... \x1b[39;49;00msearch done\n\x1b[01mcopying static files... \x1b[39;49;00mdone\n\x1b[01mcopying extra files... \x1b[39;49;00mdone\n\x1b[01mdumping search index in English (code: en)... \x1b[39;49;00mdone\n\x1b[01mdumping object inventory... \x1b[39;49;00mdone\n\n# warning: \n\x1b[91mWARNING: while setting up extension sphinx.addnodes: node class \'meta\' is already registered, its visitors will be overridden\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-3/ext-viewcode/index.rst:23: WARNING: Object named \'func1\' not found in include file \'/tmp/pytest-of-root/pytest-3/ext-viewcode/spam/__init__.py\'\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-3/ext-viewcode/spam/mod1.py:docstring of spam.mod1.Class3:1: WARNING: duplicate object description of spam.mod3.Class3, other instance in index, use :noindex: for one of them\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-3/ext-viewcode/spam/mod1.py:docstring of spam.mod3.Class3.class_attr:1: WARNING: duplicate object description of spam.mod3.Class3.class_attr, other instance in index, use :noindex: for one of them\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-3/ext-viewcode/objects.rst:84: WARNING: Error in declarator\nIf declarator-id with parameters (e.g., \'void f(int arg)\'):\n  Invalid C declaration: Expected identifier in nested name. [error at 18]\n    Sphinx_DoSomething()\n    ------------------^\nIf parenthesis in noptr-declarator (e.g., \'void (*f(int arg))(double)\'):\n  Error in declarator or parameters\n  Invalid C declaration: Expected identifier in nested name. [error at 19]\n    Sphinx_DoSomething()\n    -------------------^\n\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-3/ext-viewcode/objects.rst:86: WARNING: Error in declarator or parameters\nInvalid C declaration: Expected identifier in nested name. [error at 19]\n  SphinxStruct.member\n  -------------------^\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-3/ext-viewcode/objects.rst:92: WARNING: Error in declarator or parameters\nInvalid C declaration: Expected identifier in nested name. [error at 13]\n  sphinx_global\n  -------------^\x1b[39;49;00m\n\x1b[31m/tmp/pytest-of-root/pytest-3/ext-viewcode/objects.rst:155: WARNING: Unknown directive type "userdesc".\n\n.. userdesc:: myobj:parameter\n\n   Description of userdesc.\x1b[39;49;00m\n\x1b[31m/tmp/pytest-of-root/pytest-3/ext-viewcode/objects.rst:160: WARNING: Unknown interpreted text role "userdescrole".\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-3/ext-viewcode/objects.rst:166: WARNING: Too many template argument lists compared to parameter lists. Argument lists: 1, Parameter lists: 0, Extra empty parameters lists prepended: 1. Declaration:\n\tn::Array<T, d>\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-3/ext-viewcode/objects.rst:117: WARNING: Unparseable C cross-reference: \'SphinxType *\'\nInvalid C declaration: Expected end of definition. [error at 11]\n  SphinxType *\n  -----------^\x1b[39;49;00m\n\n--------------------------- Captured stdout teardown ---------------------------\n# testroot: root\n# builder: html\n# srcdir: /tmp/pytest-of-root/pytest-3/ext-viewcode-find\n# outdir: /tmp/pytest-of-root/pytest-3/ext-viewcode-find/_build/html\n# status: \n\x1b[01mRunning Sphinx v3.5.0+/82ef497a8\x1b[39;49;00m\n\x1b[01mbuilding [html]: \x1b[39;49;00mall source files\n\x1b[01mupdating environment: \x1b[39;49;00m[new config] 1 added, 0 changed, 0 removed\n\x1b[01mreading sources... \x1b[39;49;00m[100%] \x1b[35mindex\x1b[39;49;00m                                                \r\n\x1b[01mlooking for now-outdated files... \x1b[39;49;00mnone found\n\x1b[01mpickling environment... \x1b[39;49;00mdone\n\x1b[01mchecking consistency... \x1b[39;49;00mdone\n\x1b[01mpreparing documents... \x1b[39;49;00mdone\n\x1b[01mwriting output... \x1b[39;49;00m[100%] \x1b[32mindex\x1b[39;49;00m                                                 \r\n\x1b[01mgenerating indices... \x1b[39;49;00mgenindex py-modindex done\n\x1b[01mhighlighting module code... \x1b[39;49;00m[ 50%] \x1b[94mnot_a_package\x1b[39;49;00m                               \r\x1b[01mhighlighting module code... \x1b[39;49;00m[100%] \x1b[94mnot_a_package.submodule\x1b[39;49;00m                     \r\n\x1b[01mwriting additional pages... \x1b[39;49;00msearch done\n\x1b[01mcopying static files... \x1b[39;49;00mdone\n\x1b[01mcopying extra files... \x1b[39;49;00mdone\n\x1b[01mdumping search index in English (code: en)... \x1b[39;49;00mdone\n\x1b[01mdumping object inventory... \x1b[39;49;00mdone\n\n# warning: \n\x1b[91mWARNING: while setting up extension sphinx.addnodes: node class \'meta\' is already registered, its visitors will be overridden\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-3/ext-viewcode-find/index.rst:28: WARNING: Object named \'func1\' not found in include file \'/tmp/pytest-of-root/pytest-3/ext-viewcode-find/not_a_package/__init__.py\'\x1b[39;49;00m\n\n============================= slowest 25 durations =============================\n0.36s call     tests/test_ext_viewcode.py::test_viewcode\n0.26s call     tests/test_ext_viewcode.py::test_linkcode\n0.22s call     tests/test_ext_viewcode.py::test_viewcode_epub_enabled\n0.18s call     tests/test_ext_viewcode.py::test_local_source_files\n0.17s call     tests/test_ext_viewcode.py::test_viewcode_epub_disabled\n0.15s setup    tests/test_ext_viewcode.py::test_viewcode\n0.01s setup    tests/test_ext_viewcode.py::test_viewcode_epub_enabled\n0.01s setup    tests/test_ext_viewcode.py::test_viewcode_epub_disabled\n0.01s setup    tests/test_ext_viewcode.py::test_linkcode\n0.01s setup    tests/test_ext_viewcode.py::test_local_source_files\n\n(5 durations < 0.005s hidden.  Use -vv to show these durations.)\n\x1b[36m\x1b[1m=========================== short test summary info ============================\x1b[0m\n\x1b[32mPASSED\x1b[0m tests/test_ext_viewcode.py::\x1b[1mtest_viewcode_epub_enabled\x1b[0m\n\x1b[32mPASSED\x1b[0m tests/test_ext_viewcode.py::\x1b[1mtest_linkcode\x1b[0m\n\x1b[32mPASSED\x1b[0m tests/test_ext_viewcode.py::\x1b[1mtest_local_source_files\x1b[0m\n\x1b[31mFAILED\x1b[0m tests/test_ext_viewcode.py::\x1b[1mtest_viewcode\x1b[0m - assert \'<div class="viewcode-block" id="Class1"><a class="viewcode-back" hr...\n\x1b[31mFAILED\x1b[0m tests/test_ext_viewcode.py::\x1b[1mtest_viewcode_epub_disabled\x1b[0m - AssertionError: assert not True\n\x1b[31m================== \x1b[31m\x1b[1m2 failed\x1b[0m, \x1b[32m3 passed\x1b[0m, \x1b[33m1024 warnings\x1b[0m\x1b[31m in 1.50s\x1b[0m\x1b[31m ==================\x1b[0m\npy39: exit 1 (1.97 seconds) /testbed> python -X dev -m pytest -rA --durations 25 tests/test_ext_viewcode.py pid=402\n  py39: FAIL code 1 (1.97=setup[0.01]+cmd[1.97] seconds)\n  evaluation failed :( (2.06 seconds)'}]}, {'role': 'assistant', 'content': [{'type': 'text', 'text': "I noticed what's happening. Our changes to the `collect_pages` function are not being properly picked up by the builder. Let's modify our approach to ensure the builder uses the right directories and connections:\n\n1. We need to create a new template name instead of using the existing one.\n2. We need to properly connect the `html-collect-pages` event to either epub or html based on the builder.\n\nLet's update the code:"}, {'type': 'text', 'text': '<tool_use>\n{\'tool_name\': editor, \'tool_input\': {\'command\': \'edit\', \'path\': \'/testbed/sphinx/ext/viewcode.py\', \'file_text\': \'"""\\n    sphinx.ext.viewcode\\n    ~~~~~~~~~~~~~~~~~~~\\n\\n    Add links to module code in Python object descriptions.\\n\\n    :copyright: Copyright 2007-2021 by the Sphinx team, see AUTHORS.\\n    :license: BSD, see LICENSE for details.\\n"""\\n\\nimport os\\nimport posixpath\\nimport traceback\\nfrom os import path\\nfrom typing import Any, Dict, Generator, Iterable, Optional, Set, Tuple, cast\\n\\nfrom docutils import nodes\\nfrom docutils.nodes import Element, Node\\n\\nimport sphinx\\nfrom sphinx import addnodes\\nfrom sphinx.application import Sphinx\\nfrom sphinx.builders.html import StandaloneHTMLBuilder\\nfrom sphinx.environment import BuildEnvironment\\nfrom sphinx.locale import _, __\\nfrom sphinx.pycode import ModuleAnalyzer\\nfrom sphinx.util import get_full_modname, logging, status_iterator\\nfrom sphinx.util.nodes import make_refnode\\n\\nlogger = logging.getLogger(__name__)\\n\\n\\nOUTPUT_DIRNAME = \\\'_modules\\\'\\n\\n\\ndef _get_full_modname(app: Sphinx, modname: str, attribute: str) -> Optional[str]:\\n    try:\\n        return get_full_modname(modname, attribute)\\n    except AttributeError:\\n        # sphinx.ext.viewcode can\\\'t follow class instance attribute\\n        # then AttributeError logging output only verbose mode.\\n        logger.verbose(\\\'Didn\\\\\\\'t find %s in %s\\\', attribute, modname)\\n        return None\\n    except Exception as e:\\n        # sphinx.ext.viewcode follow python domain directives.\\n        # because of that, if there are no real modules exists that specified\\n        # by py:function or other directives, viewcode emits a lot of warnings.\\n        # It should be displayed only verbose mode.\\n        logger.verbose(traceback.format_exc().rstrip())\\n        logger.verbose(\\\'viewcode can\\\\\\\'t import %s, failed with error "%s"\\\', modname, e)\\n        return None\\n\\n\\ndef doctree_read(app: Sphinx, doctree: Node) -> None:\\n    env = app.builder.env\\n    if not hasattr(env, \\\'_viewcode_modules\\\'):\\n        env._viewcode_modules = {}  # type: ignore\\n    if app.builder.name == "singlehtml":\\n        return\\n    if app.builder.name.startswith("epub") and not env.config.viewcode_enable_epub:\\n        return\\n\\n    def has_tag(modname: str, fullname: str, docname: str, refname: str) -> bool:\\n        entry = env._viewcode_modules.get(modname, None)  # type: ignore\\n        if entry is False:\\n            return False\\n\\n        code_tags = app.emit_firstresult(\\\'viewcode-find-source\\\', modname)\\n        if code_tags is None:\\n            try:\\n                analyzer = ModuleAnalyzer.for_module(modname)\\n                analyzer.find_tags()\\n            except Exception:\\n                env._viewcode_modules[modname] = False  # type: ignore\\n                return False\\n\\n            code = analyzer.code\\n            tags = analyzer.tags\\n        else:\\n            code, tags = code_tags\\n\\n        if entry is None or entry[0] != code:\\n            entry = code, tags, {}, refname\\n            env._viewcode_modules[modname] = entry  # type: ignore\\n        _, tags, used, _ = entry\\n        if fullname in tags:\\n            used[fullname] = docname\\n            return True\\n\\n        return False\\n\\n    for objnode in doctree.traverse(addnodes.desc):\\n        if objnode.get(\\\'domain\\\') != \\\'py\\\':\\n            continue\\n        names = set()  # type: Set[str]\\n        for signode in objnode:\\n            if not isinstance(signode, addnodes.desc_signature):\\n                continue\\n            modname = signode.get(\\\'module\\\')\\n            fullname = signode.get(\\\'fullname\\\')\\n            refname = modname\\n            if env.config.viewcode_follow_imported_members:\\n                new_modname = app.emit_firstresult(\\n                    \\\'viewcode-follow-imported\\\', modname, fullname,\\n                )\\n                if not new_modname:\\n                    new_modname = _get_full_modname(app, modname, fullname)\\n                modname = new_modname\\n            if not modname:\\n                continue\\n            fullname = signode.get(\\\'fullname\\\')\\n            if not has_tag(modname, fullname, env.docname, refname):\\n                continue\\n            if fullname in names:\\n                # only one link per name, please\\n                continue\\n            names.add(fullname)\\n            pagename = posixpath.join(OUTPUT_DIRNAME, modname.replace(\\\'.\\\', \\\'/\\\'))\\n            inline = nodes.inline(\\\'\\\', _(\\\'[source]\\\'), classes=[\\\'viewcode-link\\\'])\\n            onlynode = addnodes.only(expr=\\\'html\\\')\\n            onlynode += addnodes.pending_xref(\\\'\\\', inline, reftype=\\\'viewcode\\\', refdomain=\\\'std\\\',\\n                                          refexplicit=False, reftarget=pagename,\\n                                          refid=fullname, refdoc=env.docname)\\n            signode += onlynode\\n\\n\\ndef env_merge_info(app: Sphinx, env: BuildEnvironment, docnames: Iterable[str],\\n                   other: BuildEnvironment) -> None:\\n    if not hasattr(other, \\\'_viewcode_modules\\\'):\\n        return\\n    # create a _viewcode_modules dict on the main environment\\n    if not hasattr(env, \\\'_viewcode_modules\\\'):\\n        env._viewcode_modules = {}  # type: ignore\\n    # now merge in the information from the subprocess\\n    env._viewcode_modules.update(other._viewcode_modules)  # type: ignore\\n\\n\\ndef missing_reference(app: Sphinx, env: BuildEnvironment, node: Element, contnode: Node\\n                      ) -> Optional[Node]:\\n    # resolve our "viewcode" reference nodes -- they need special treatment\\n    if node[\\\'reftype\\\'] == \\\'viewcode\\\':\\n        return make_refnode(app.builder, node[\\\'refdoc\\\'], node[\\\'reftarget\\\'],\\n                            node[\\\'refid\\\'], contnode)\\n\\n    return None\\n\\n\\ndef get_module_filename(app: Sphinx, modname: str) -> Optional[str]:\\n    """Get module filename for *modname*."""\\n    source_info = app.emit_firstresult(\\\'viewcode-find-source\\\', modname)\\n    if source_info:\\n        return None\\n    else:\\n        try:\\n            filename, source = ModuleAnalyzer.get_module_source(modname)\\n            return filename\\n        except Exception:\\n            return None\\n\\n\\ndef collect_pages(app: Sphinx) -> Generator[Tuple[str, Dict[str, Any], str], None, None]:\\n    # Skip for epub builder if viewcode_enable_epub is False\\n    if app.builder.name.startswith("epub") and not app.builder.env.config.viewcode_enable_epub:\\n        return\\n\\n    env = app.builder.env\\n    if not hasattr(env, \\\'_viewcode_modules\\\'):\\n        return\\n\\n    highlighter = app.builder.highlighter  # type: ignore\\n    urito = app.builder.get_relative_uri\\n    modnames = set(env._viewcode_modules)  # type: ignore\\n\\n    for modname, entry in status_iterator(\\n            sorted(env._viewcode_modules.items()),  # type: ignore\\n            __(\\\'highlighting module code... \\\'), "blue",\\n            len(env._viewcode_modules),  # type: ignore\\n            app.verbosity, lambda x: x[0]):\\n        if not entry:\\n            continue\\n\\n        code, tags, used, refname = entry\\n        pagename = posixpath.join(OUTPUT_DIRNAME, modname.replace(\\\'.\\\', \\\'/\\\'))\\n        if env.config.highlight_language in (\\\'python3\\\', \\\'default\\\', \\\'none\\\'):\\n            lexer = env.config.highlight_language\\n        else:\\n            lexer = \\\'python\\\'\\n        highlighted = highlighter.highlight_block(code, lexer, linenos=False)\\n        lines = highlighted.splitlines()\\n        before, after = lines[0].split(\\\'<pre>\\\')\\n        lines[0:1] = [before + \\\'<pre>\\\', after]\\n\\n        maxindex = len(lines) - 1\\n        for name, docname in used.items():\\n            type, start, end = tags[name]\\n            backlink = urito(pagename, docname) + \\\'#\\\' + refname + \\\'.\\\' + name\\n            lines[start] = (\\n                \\\'<div class="viewcode-block" id="%s"><a class="viewcode-back" \\\'\\n                \\\'href="%s">%s</a>\\\' % (name, backlink, _(\\\'[docs]\\\')) +\\n                lines[start])\\n            lines[min(end, maxindex)] += \\\'</div>\\\'\\n\\n        parents = []\\n        parent = modname\\n        while \\\'.\\\' in parent:\\n            parent = parent.rsplit(\\\'.\\\', 1)[0]\\n            if parent in modnames:\\n                parents.append({\\n                    \\\'link\\\': urito(pagename,\\n                                  posixpath.join(OUTPUT_DIRNAME, parent.replace(\\\'.\\\', \\\'/\\\'))),\\n                    \\\'title\\\': parent})\\n        parents.append({\\\'link\\\': urito(pagename, posixpath.join(OUTPUT_DIRNAME, \\\'index\\\')),\\n                       \\\'title\\\': _(\\\'Module code\\\')})\\n        parents.reverse()\\n\\n        context = {\\n            \\\'parents\\\': parents,\\n            \\\'title\\\': modname,\\n            \\\'body\\\': (_(\\\'<h1>Source code for %s</h1>\\\') % modname +\\n                     \\\'\\\\n\\\'.join(lines)),\\n        }\\n        yield (pagename, context, \\\'page.html\\\')\\n\\n    if not modnames:\\n        return\\n\\n    html = [\\\'\\\\n\\\']\\n    stack = [\\\'\\\']\\n    for modname in sorted(modnames):\\n        if modname.startswith(stack[-1]):\\n            stack.append(modname + \\\'.\\\')\\n            html.append(\\\'<ul>\\\')\\n        else:\\n            stack.pop()\\n            stack.append(modname + \\\'.\\\')\\n            html.append(\\\'</ul>\\\' * (len(stack) - 1) + \\\'<ul>\\\')\\n        if modname in env._viewcode_modules and env._viewcode_modules[modname]:  # type: ignore\\n            pagename = posixpath.join(OUTPUT_DIRNAME, modname.replace(\\\'.\\\', \\\'/\\\'))\\n            html.append(\\\'<li><a href="%s">%s</a></li>\\\\n\\\' % (\\n                urito(OUTPUT_DIRNAME + \\\'/index\\\', pagename), modname))\\n\\n    if html == [\\\'\\\\n\\\']:  # no documented Python objects\\n        return\\n\\n    html.append(\\\'</ul>\\\' * len(stack))\\n    context = {\\n        \\\'title\\\': _(\\\'Overview: module code\\\'),\\n        \\\'body\\\': (_(\\\'<h1>All modules for which code is available</h1>\\\') +\\n                 \\\'\\\'.join(html)),\\n    }\\n\\n    yield (posixpath.join(OUTPUT_DIRNAME, \\\'index\\\'), context, \\\'page.html\\\')\\n\\n\\ndef builder_inited(app: Sphinx) -> None:\\n    # Skip _modules directory creation for epub builder if viewcode_enable_epub is False\\n    if app.builder.name.startswith("epub") and not app.builder.env.config.viewcode_enable_epub:\\n        return\\n\\n    if hasattr(app.builder, \\\'outdir\\\'):\\n        modules_dir = path.join(app.builder.outdir, OUTPUT_DIRNAME)\\n        if os.path.exists(modules_dir):\\n            try:\\n                os.rmdir(modules_dir)\\n            except OSError:  # Directory not empty or other error\\n                pass\\n        try:\\n            os.makedirs(modules_dir)\\n        except OSError:  # Directory exists or other error\\n            pass\\n\\n\\ndef setup(app: Sphinx) -> Dict[str, Any]:\\n    app.add_config_value(\\\'viewcode_enable_epub\\\', False, False)\\n    app.add_config_value(\\\'viewcode_follow_imported_members\\\', True, False)\\n    app.add_event(\\\'viewcode-find-source\\\')\\n    app.add_event(\\\'viewcode-follow-imported\\\')\\n    \\n    app.connect(\\\'builder-inited\\\', builder_inited)\\n    app.connect(\\\'doctree-read\\\', doctree_read)\\n    app.connect(\\\'env-merge-info\\\', env_merge_info)\\n    app.connect(\\\'html-collect-pages\\\', collect_pages)\\n    app.connect(\\\'missing-reference\\\', missing_reference)\\n\\n    return {\\n        \\\'version\\\': sphinx.__display_version__,\\n        \\\'parallel_read_safe\\\': True\\n    }\'}}\n</tool_use>'}]}, {'role': 'user', 'content': [{'type': 'text', 'text': 'Tool Result: File at /testbed/sphinx/ext/viewcode.py has been overwritten with new content.'}]}, {'role': 'assistant', 'content': [{'type': 'text', 'text': "Let's run the tests again:"}, {'type': 'text', 'text': "<tool_use>\n{'tool_name': bash, 'tool_input': {'command': 'cd /testbed/ && tox --current-env -epy39 -v -- tests/test_ext_viewcode.py'}}\n</tool_use>"}]}, {'role': 'user', 'content': [{'type': 'text', 'text': 'Tool Result: py39: commands[0]> python -X dev -m pytest -rA --durations 25 tests/test_ext_viewcode.py\n\x1b[1m============================= test session starts ==============================\x1b[0m\nplatform linux -- Python 3.9.21, pytest-8.3.4, pluggy-1.5.0\ncachedir: .tox/py39/.pytest_cache\nlibraries: Sphinx-3.5.0+/82ef497a8, docutils-0.21.2\nbase tempdir: /tmp/pytest-of-root/pytest-4\nrootdir: /testbed\nconfigfile: setup.cfg\nplugins: cov-6.0.0\ncollected 5 items\n\ntests/test_ext_viewcode.py \x1b[31mF\x1b[0m\x1b[31mF\x1b[0m\x1b[32m.\x1b[0m\x1b[32m.\x1b[0m\x1b[32m.\x1b[0m\x1b[31m                                         [100%]\x1b[0m\n\n=================================== FAILURES ===================================\n\x1b[31m\x1b[1m________________________________ test_viewcode _________________________________\x1b[0m\n\napp = <SphinxTestApp buildername=\'html\'>\nstatus = <_io.StringIO object at 0x7b69ffc320f0>\nwarning = <_io.StringIO object at 0x7b69ffc32190>\n\n    \x1b[0m\x1b[37m@pytest\x1b[39;49;00m.mark.sphinx(testroot=\x1b[33m\'\x1b[39;49;00m\x1b[33mext-viewcode\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m)\x1b[90m\x1b[39;49;00m\n    \x1b[94mdef\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[92mtest_viewcode\x1b[39;49;00m(app, status, warning):\x1b[90m\x1b[39;49;00m\n        app.builder.build_all()\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        warnings = re.sub(\x1b[33mr\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[33m\\\\\x1b[39;49;00m\x1b[33m+\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m, \x1b[33m\'\x1b[39;49;00m\x1b[33m/\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m, warning.getvalue())\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m re.findall(\x1b[90m\x1b[39;49;00m\n            \x1b[33mr\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33mindex.rst:\x1b[39;49;00m\x1b[33m\\\x1b[39;49;00m\x1b[33md+: WARNING: Object named \x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[33mfunc1\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[33m not found in include \x1b[39;49;00m\x1b[33m"\x1b[39;49;00m +\x1b[90m\x1b[39;49;00m\n            \x1b[33mr\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33mfile .*/spam/__init__.py\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m,\x1b[90m\x1b[39;49;00m\n            warnings\x1b[90m\x1b[39;49;00m\n        )\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        result = (app.outdir / \x1b[33m\'\x1b[39;49;00m\x1b[33mindex.html\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m).read_text()\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m result.count(\x1b[33m\'\x1b[39;49;00m\x1b[33mhref=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m_modules/spam/mod1.html#func1\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) == \x1b[94m2\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m result.count(\x1b[33m\'\x1b[39;49;00m\x1b[33mhref=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m_modules/spam/mod2.html#func2\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) == \x1b[94m2\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m result.count(\x1b[33m\'\x1b[39;49;00m\x1b[33mhref=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m_modules/spam/mod1.html#Class1\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) == \x1b[94m2\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m result.count(\x1b[33m\'\x1b[39;49;00m\x1b[33mhref=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m_modules/spam/mod2.html#Class2\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) == \x1b[94m2\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m result.count(\x1b[33m\'\x1b[39;49;00m\x1b[33m@decorator\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) == \x1b[94m1\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        \x1b[90m# test that the class attribute is correctly documented\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m result.count(\x1b[33m\'\x1b[39;49;00m\x1b[33mthis is Class3\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) == \x1b[94m2\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m \x1b[33m\'\x1b[39;49;00m\x1b[33mthis is the class attribute class_attr\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m \x1b[95min\x1b[39;49;00m result\x1b[90m\x1b[39;49;00m\n        \x1b[90m# the next assert fails, until the autodoc bug gets fixed\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m result.count(\x1b[33m\'\x1b[39;49;00m\x1b[33mthis is the class attribute class_attr\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) == \x1b[94m2\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        result = (app.outdir / \x1b[33m\'\x1b[39;49;00m\x1b[33m_modules/spam/mod1.html\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m).read_text()\x1b[90m\x1b[39;49;00m\n        result = re.sub(\x1b[33m\'\x1b[39;49;00m\x1b[33m<span class=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m.*?\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m>\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m, \x1b[33m\'\x1b[39;49;00m\x1b[33m<span>\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m, result)  \x1b[90m# filter pygments classes\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n>       \x1b[94massert\x1b[39;49;00m (\x1b[33m\'\x1b[39;49;00m\x1b[33m<div class=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33mviewcode-block\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m id=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33mClass1\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m><a class=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33mviewcode-back\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m \x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                \x1b[33m\'\x1b[39;49;00m\x1b[33mhref=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m../../index.html#spam.Class1\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m>[docs]</a>\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                \x1b[33m\'\x1b[39;49;00m\x1b[33m<span>@decorator</span>\x1b[39;49;00m\x1b[33m\\n\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                \x1b[33m\'\x1b[39;49;00m\x1b[33m<span>class</span> <span>Class1</span>\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                \x1b[33m\'\x1b[39;49;00m\x1b[33m<span>(</span><span>object</span><span>):</span>\x1b[39;49;00m\x1b[33m\\n\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                \x1b[33m\'\x1b[39;49;00m\x1b[33m    <span>&quot;&quot;&quot;</span>\x1b[39;49;00m\x1b[33m\\n\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                \x1b[33m\'\x1b[39;49;00m\x1b[33m<span>    this is Class1</span>\x1b[39;49;00m\x1b[33m\\n\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                \x1b[33m\'\x1b[39;49;00m\x1b[33m<span>    &quot;&quot;&quot;</span></div>\x1b[39;49;00m\x1b[33m\\n\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) \x1b[95min\x1b[39;49;00m result\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31mE       assert \'<div class="viewcode-block" id="Class1"><a class="viewcode-back" href="../../index.html#spam.Class1">[docs]</a><span>...an>\\n    <span>&quot;&quot;&quot;</span>\\n<span>    this is Class1</span>\\n<span>    &quot;&quot;&quot;</span></div>\\n\' in \'\\n<!DOCTYPE html>\\n\\n<html>\\n  <head>\\n    <meta charset="utf-8" />\\n    <meta name="viewport" content="width=device-..."https://github.com/bitprophet/alabaster">Alabaster 0.7.11</a>\\n      \\n    </div>\\n\\n    \\n\\n    \\n  </body>\\n</html>\'\x1b[0m\n\n\x1b[1m\x1b[31mtests/test_ext_viewcode.py\x1b[0m:43: AssertionError\n--------------------------- Captured stdout teardown ---------------------------\n# testroot: root\n# builder: html\n# srcdir: /tmp/pytest-of-root/pytest-4/ext-viewcode\n# outdir: /tmp/pytest-of-root/pytest-4/ext-viewcode/_build/html\n# status: \n\x1b[01mRunning Sphinx v3.5.0+/82ef497a8\x1b[39;49;00m\n\x1b[01mbuilding [html]: \x1b[39;49;00mall source files\n\x1b[01mupdating environment: \x1b[39;49;00m[new config] 2 added, 0 changed, 0 removed\n\x1b[01mreading sources... \x1b[39;49;00m[ 50%] \x1b[35mindex\x1b[39;49;00m                                                \r\x1b[01mreading sources... \x1b[39;49;00m[100%] \x1b[35mobjects\x1b[39;49;00m                                              \r\n\x1b[01mlooking for now-outdated files... \x1b[39;49;00mnone found\n\x1b[01mpickling environment... \x1b[39;49;00mdone\n\x1b[01mchecking consistency... \x1b[39;49;00mdone\n\x1b[01mpreparing documents... \x1b[39;49;00mdone\n\x1b[01mwriting output... \x1b[39;49;00m[ 50%] \x1b[32mindex\x1b[39;49;00m                                                 \r\x1b[01mwriting output... \x1b[39;49;00m[100%] \x1b[32mobjects\x1b[39;49;00m                                               \r\n\x1b[01mgenerating indices... \x1b[39;49;00mgenindex py-modindex done\n\x1b[01mhighlighting module code... \x1b[39;49;00m[ 50%] \x1b[94mspam.mod1\x1b[39;49;00m                                   \r\x1b[01mhighlighting module code... \x1b[39;49;00m[100%] \x1b[94mspam.mod2\x1b[39;49;00m                                   \r\n\x1b[01mwriting additional pages... \x1b[39;49;00msearch done\n\x1b[01mcopying static files... \x1b[39;49;00mdone\n\x1b[01mcopying extra files... \x1b[39;49;00mdone\n\x1b[01mdumping search index in English (code: en)... \x1b[39;49;00mdone\n\x1b[01mdumping object inventory... \x1b[39;49;00mdone\n\n# warning: \n\x1b[91mWARNING: while setting up extension sphinx.addnodes: node class \'meta\' is already registered, its visitors will be overridden\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-4/ext-viewcode/index.rst:23: WARNING: Object named \'func1\' not found in include file \'/tmp/pytest-of-root/pytest-4/ext-viewcode/spam/__init__.py\'\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-4/ext-viewcode/spam/mod1.py:docstring of spam.mod1.Class3:1: WARNING: duplicate object description of spam.mod3.Class3, other instance in index, use :noindex: for one of them\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-4/ext-viewcode/spam/mod1.py:docstring of spam.mod3.Class3.class_attr:1: WARNING: duplicate object description of spam.mod3.Class3.class_attr, other instance in index, use :noindex: for one of them\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-4/ext-viewcode/objects.rst:84: WARNING: Error in declarator\nIf declarator-id with parameters (e.g., \'void f(int arg)\'):\n  Invalid C declaration: Expected identifier in nested name. [error at 18]\n    Sphinx_DoSomething()\n    ------------------^\nIf parenthesis in noptr-declarator (e.g., \'void (*f(int arg))(double)\'):\n  Error in declarator or parameters\n  Invalid C declaration: Expected identifier in nested name. [error at 19]\n    Sphinx_DoSomething()\n    -------------------^\n\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-4/ext-viewcode/objects.rst:86: WARNING: Error in declarator or parameters\nInvalid C declaration: Expected identifier in nested name. [error at 19]\n  SphinxStruct.member\n  -------------------^\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-4/ext-viewcode/objects.rst:92: WARNING: Error in declarator or parameters\nInvalid C declaration: Expected identifier in nested name. [error at 13]\n  sphinx_global\n  -------------^\x1b[39;49;00m\n\x1b[31m/tmp/pytest-of-root/pytest-4/ext-viewcode/objects.rst:155: WARNING: Unknown directive type "userdesc".\n\n.. userdesc:: myobj:parameter\n\n   Description of userdesc.\x1b[39;49;00m\n\x1b[31m/tmp/pytest-of-root/pytest-4/ext-viewcode/objects.rst:160: WARNING: Unknown interpreted text role "userdescrole".\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-4/ext-viewcode/objects.rst:166: WARNING: Too many template argument lists compared to parameter lists. Argument lists: 1, Parameter lists: 0, Extra empty parameters lists prepended: 1. Declaration:\n\tn::Array<T, d>\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-4/ext-viewcode/objects.rst:117: WARNING: Unparseable C cross-reference: \'SphinxType *\'\nInvalid C declaration: Expected end of definition. [error at 11]\n  SphinxType *\n  -----------^\x1b[39;49;00m\n\n\x1b[31m\x1b[1m_________________________ test_viewcode_epub_disabled __________________________\x1b[0m\n\napp = <SphinxTestApp buildername=\'epub\'>\nstatus = <_io.StringIO object at 0x7b69fe82c4b0>\nwarning = <_io.StringIO object at 0x7b69fe82c550>\n\n    \x1b[0m\x1b[37m@pytest\x1b[39;49;00m.mark.sphinx(testroot=\x1b[33m\'\x1b[39;49;00m\x1b[33mext-viewcode\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m, confoverrides={\x1b[33m\'\x1b[39;49;00m\x1b[33mviewcode_enable_epub\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m: \x1b[94mFalse\x1b[39;49;00m})\x1b[90m\x1b[39;49;00m\n    \x1b[94mdef\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[92mtest_viewcode_epub_disabled\x1b[39;49;00m(app, status, warning):\x1b[90m\x1b[39;49;00m\n        \x1b[90m# Change to epub builder\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        app.builder.name = \x1b[33m"\x1b[39;49;00m\x1b[33mepub\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        app.builder.build_all()\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        \x1b[90m# Check that _modules directory is not created when viewcode_enable_epub is False\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        modules_dir = Path(app.outdir) / \x1b[33m\'\x1b[39;49;00m\x1b[33m_modules\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n>       \x1b[94massert\x1b[39;49;00m \x1b[95mnot\x1b[39;49;00m modules_dir.exists()\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31mE       AssertionError: assert not True\x1b[0m\n\x1b[1m\x1b[31mE        +  where True = exists()\x1b[0m\n\x1b[1m\x1b[31mE        +    where exists = PosixPath(\'/tmp/pytest-of-root/pytest-4/ext-viewcode/_build/html/_modules\').exists\x1b[0m\n\n\x1b[1m\x1b[31mtests/test_ext_viewcode.py\x1b[0m:61: AssertionError\n--------------------------- Captured stdout teardown ---------------------------\n# testroot: root\n# builder: epub\n# srcdir: /tmp/pytest-of-root/pytest-4/ext-viewcode\n# outdir: /tmp/pytest-of-root/pytest-4/ext-viewcode/_build/html\n# status: \n\x1b[01mRunning Sphinx v3.5.0+/82ef497a8\x1b[39;49;00m\n\x1b[01mloading pickled environment... \x1b[39;49;00mdone\n\x1b[01mbuilding [epub]: \x1b[39;49;00mall source files\n\x1b[01mupdating environment: \x1b[39;49;00m0 added, 0 changed, 0 removed\n\x1b[01mlooking for now-outdated files... \x1b[39;49;00mnone found\n\x1b[01mpreparing documents... \x1b[39;49;00mdone\n\x1b[01mwriting output... \x1b[39;49;00m[ 50%] \x1b[32mindex\x1b[39;49;00m                                                 \r\x1b[01mwriting output... \x1b[39;49;00m[100%] \x1b[32mobjects\x1b[39;49;00m                                               \r\n\x1b[01mgenerating indices... \x1b[39;49;00mgenindex py-modindex done\n\x1b[01mwriting additional pages... \x1b[39;49;00msearch done\n\x1b[01mcopying static files... \x1b[39;49;00mdone\n\x1b[01mcopying extra files... \x1b[39;49;00mdone\n\x1b[01mdumping search index in English (code: en)... \x1b[39;49;00mdone\n\x1b[01mdumping object inventory... \x1b[39;49;00mdone\n\n# warning: \n\x1b[91mWARNING: while setting up extension sphinx.addnodes: node class \'meta\' is already registered, its visitors will be overridden\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-4/ext-viewcode/objects.rst:117: WARNING: Unparseable C cross-reference: \'SphinxType *\'\nInvalid C declaration: Expected end of definition. [error at 11]\n  SphinxType *\n  -----------^\x1b[39;49;00m\n\n\x1b[33m=============================== warnings summary ===============================\x1b[0m\nsphinx/util/docutils.py:45\n  /testbed/sphinx/util/docutils.py:45: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.\n    __version_info__ = tuple(LooseVersion(docutils.__version__).version)\n\nsphinx/registry.py:22\n  /testbed/sphinx/registry.py:22: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n    from pkg_resources import iter_entry_points\n\n../opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pkg_resources/__init__.py:3142\n../opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pkg_resources/__init__.py:3142\n../opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pkg_resources/__init__.py:3142\n../opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pkg_resources/__init__.py:3142\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pkg_resources/__init__.py:3142: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace(\'sphinxcontrib\')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n    declare_namespace(pkg)\n\nsphinx/directives/patches.py:14\n  /testbed/sphinx/directives/patches.py:14: DeprecationWarning: The `docutils.parsers.rst.directive.html` module will be removed in Docutils 2.0. Since Docutils 0.18, the "Meta" node is defined in `docutils.parsers.rst.directives.misc`.\n    from docutils.parsers.rst.directives import html, images, tables\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:210: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse():  # type: Node\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/i18n.py:95: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.translatable):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:110: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for ref in self.document.traverse(nodes.substitution_reference):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:131: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.target):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:150: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.block_quote):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:175: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.Element):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:222: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.index):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:189: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.section):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:279: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.doctest_block):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/domains/citation.py:116: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.citation):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/domains/citation.py:135: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.citation_reference):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/builders/latex/transforms.py:36: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(matcher):  # type: nodes.Element\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:291: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(matcher):  # type: Element\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/util/compat.py:44: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.index):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/domains/index.py:51: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in document.traverse(addnodes.index):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/domains/math.py:84: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    self.data[\'has_equations\'][docname] = any(document.traverse(math_node))\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/environment/collectors/asset.py:46: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in doctree.traverse(nodes.image):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/environment/collectors/asset.py:127: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in doctree.traverse(addnodes.download_reference):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/environment/collectors/title.py:46: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in doctree.traverse(nodes.section):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/ext/viewcode.py:92: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for objnode in doctree.traverse(addnodes.desc):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:301: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.system_message):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:390: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.manpage):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/i18n.py:488: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for inline in self.document.traverse(matcher):  # type: nodes.inline\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/domains/python.py:283: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in result.traverse(nodes.Text):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/builders/html/__init__.py:422: DeprecationWarning: The frontend.OptionParser class will be replaced by a subclass of argparse.ArgumentParser in Docutils 0.21 or later.\n    self.docsettings = OptionParser(\n\ntests/test_ext_viewcode.py: 360 warnings\n  /opt/miniconda3/envs/testbed/lib/python3.9/optparse.py:1000: DeprecationWarning: The frontend.Option class will be removed in Docutils 0.21 or later.\n    option = self.option_class(*args, **kwargs)\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/domains/c.py:3494: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(AliasNode):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/domains/cpp.py:7070: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(AliasNode):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/post_transforms/__init__.py:69: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.pending_xref):\n\ntests/test_ext_viewcode.py: 48 warnings\n  /testbed/sphinx/util/nodes.py:598: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in document.traverse(addnodes.only):\n\ntests/test_ext_viewcode.py: 18 warnings\n  /testbed/sphinx/transforms/post_transforms/images.py:33: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.image):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/post_transforms/__init__.py:216: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.desc_sig_element):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/builders/latex/transforms.py:48: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.substitution_definition):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/builders/html/transforms.py:44: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(matcher):  # type: nodes.literal\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/builders/latex/transforms.py:606: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.title):\n\ntests/test_ext_viewcode.py: 33 warnings\n  /testbed/sphinx/builders/latex/transforms.py:608: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for i, index in enumerate(node.traverse(addnodes.index)):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/post_transforms/code.py:43: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.highlightlang):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/post_transforms/code.py:95: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for lbnode in self.document.traverse(nodes.literal_block):  # type: nodes.literal_block\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/post_transforms/code.py:99: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for dbnode in self.document.traverse(nodes.doctest_block):  # type: nodes.doctest_block\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/environment/__init__.py:541: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for toctreenode in doctree.traverse(addnodes.toctree):\n\ntests/test_ext_viewcode.py: 30 warnings\n  /testbed/sphinx/environment/adapters/toctree.py:203: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for subtocnode in toc.traverse(addnodes.toctree):\n\ntests/test_ext_viewcode.py: 30 warnings\n  /testbed/sphinx/environment/adapters/toctree.py:261: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for refnode in newnode.traverse(nodes.reference):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/builders/__init__.py:181: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in doctree.traverse(nodes.image):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/builders/html/__init__.py:844: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in doctree.traverse(nodes.image):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/environment/adapters/toctree.py:312: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in toc.traverse(nodes.reference):\n\ntests/test_ext_viewcode.py: 33 warnings\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/alabaster/layout.html:114: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n    _gaq.push([\'_setAllowLinker\', true]);\n\ntests/test_ext_viewcode.py: 33 warnings\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/alabaster/about.html:70: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py: 33 warnings\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/alabaster/about.html:99: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py: 33 warnings\n  /testbed/sphinx/environment/adapters/toctree.py:328: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for toctreenode in doctree.traverse(addnodes.toctree):\n\ntests/test_ext_viewcode.py: 33 warnings\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/alabaster/layout.html:215: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py: 33 warnings\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/alabaster/layout.html:238: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  <template>:33: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  <template>:224: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  <template>:386: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  <template>:401: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py: 18 warnings\n  /testbed/sphinx/util/nodes.py:350: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for img in node.traverse(nodes.image):\n\ntests/test_ext_viewcode.py: 18 warnings\n  /testbed/sphinx/util/nodes.py:352: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for raw in node.traverse(nodes.raw):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/ext/linkcode.py:42: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for objnode in doctree.traverse(addnodes.desc):\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n==================================== PASSES ====================================\n--------------------------- Captured stdout teardown ---------------------------\n# testroot: root\n# builder: epub\n# srcdir: /tmp/pytest-of-root/pytest-4/ext-viewcode\n# outdir: /tmp/pytest-of-root/pytest-4/ext-viewcode/_build/html\n# status: \n\x1b[01mRunning Sphinx v3.5.0+/82ef497a8\x1b[39;49;00m\n\x1b[01mloading pickled environment... \x1b[39;49;00mdone\n\x1b[01mbuilding [epub]: \x1b[39;49;00mall source files\n\x1b[01mupdating environment: \x1b[39;49;00m0 added, 0 changed, 0 removed\n\x1b[01mlooking for now-outdated files... \x1b[39;49;00mnone found\n\x1b[01mpreparing documents... \x1b[39;49;00mdone\n\x1b[01mwriting output... \x1b[39;49;00m[ 50%] \x1b[32mindex\x1b[39;49;00m                                                 \r\x1b[01mwriting output... \x1b[39;49;00m[100%] \x1b[32mobjects\x1b[39;49;00m                                               \r\n\x1b[01mgenerating indices... \x1b[39;49;00mgenindex py-modindex done\n\x1b[01mhighlighting module code... \x1b[39;49;00m[ 50%] \x1b[94mspam.mod1\x1b[39;49;00m                                   \r\x1b[01mhighlighting module code... \x1b[39;49;00m[100%] \x1b[94mspam.mod2\x1b[39;49;00m                                   \r\n\x1b[01mwriting additional pages... \x1b[39;49;00msearch done\n\x1b[01mcopying static files... \x1b[39;49;00mdone\n\x1b[01mcopying extra files... \x1b[39;49;00mdone\n\x1b[01mdumping search index in English (code: en)... \x1b[39;49;00mdone\n\x1b[01mdumping object inventory... \x1b[39;49;00mdone\n\n# warning: \n\x1b[91mWARNING: while setting up extension sphinx.addnodes: node class \'meta\' is already registered, its visitors will be overridden\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-4/ext-viewcode/objects.rst:117: WARNING: Unparseable C cross-reference: \'SphinxType *\'\nInvalid C declaration: Expected end of definition. [error at 11]\n  SphinxType *\n  -----------^\x1b[39;49;00m\n\n--------------------------- Captured stdout teardown ---------------------------\n# testroot: root\n# builder: html\n# srcdir: /tmp/pytest-of-root/pytest-4/ext-viewcode\n# outdir: /tmp/pytest-of-root/pytest-4/ext-viewcode/_build/html\n# status: \n\x1b[01mRunning Sphinx v3.5.0+/82ef497a8\x1b[39;49;00m\n\x1b[01mloading pickled environment... \x1b[39;49;00mdone\n\x1b[01mupdating environment: \x1b[39;49;00m[extensions changed (\'2\')] 2 added, 0 changed, 0 removed\n\x1b[01mreading sources... \x1b[39;49;00m[ 50%] \x1b[35mindex\x1b[39;49;00m                                                \r\x1b[01mreading sources... \x1b[39;49;00m[100%] \x1b[35mobjects\x1b[39;49;00m                                              \r\n\x1b[01mlooking for now-outdated files... \x1b[39;49;00mnone found\n\x1b[01mpickling environment... \x1b[39;49;00mdone\n\x1b[01mchecking consistency... \x1b[39;49;00mdone\n\x1b[01mpreparing documents... \x1b[39;49;00mdone\n\x1b[01mwriting output... \x1b[39;49;00m[ 50%] \x1b[32mindex\x1b[39;49;00m                                                 \r\x1b[01mwriting output... \x1b[39;49;00m[100%] \x1b[32mobjects\x1b[39;49;00m                                               \r\n\x1b[01mgenerating indices... \x1b[39;49;00mgenindex py-modindex done\n\x1b[01mwriting additional pages... \x1b[39;49;00msearch done\n\x1b[01mcopying static files... \x1b[39;49;00mdone\n\x1b[01mcopying extra files... \x1b[39;49;00mdone\n\x1b[01mdumping search index in English (code: en)... \x1b[39;49;00mdone\n\x1b[01mdumping object inventory... \x1b[39;49;00mdone\n\n# warning: \n\x1b[91mWARNING: while setting up extension sphinx.addnodes: node class \'meta\' is already registered, its visitors will be overridden\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-4/ext-viewcode/index.rst:23: WARNING: Object named \'func1\' not found in include file \'/tmp/pytest-of-root/pytest-4/ext-viewcode/spam/__init__.py\'\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-4/ext-viewcode/spam/mod1.py:docstring of spam.mod1.Class3:1: WARNING: duplicate object description of spam.mod3.Class3, other instance in index, use :noindex: for one of them\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-4/ext-viewcode/spam/mod1.py:docstring of spam.mod3.Class3.class_attr:1: WARNING: duplicate object description of spam.mod3.Class3.class_attr, other instance in index, use :noindex: for one of them\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-4/ext-viewcode/objects.rst:84: WARNING: Error in declarator\nIf declarator-id with parameters (e.g., \'void f(int arg)\'):\n  Invalid C declaration: Expected identifier in nested name. [error at 18]\n    Sphinx_DoSomething()\n    ------------------^\nIf parenthesis in noptr-declarator (e.g., \'void (*f(int arg))(double)\'):\n  Error in declarator or parameters\n  Invalid C declaration: Expected identifier in nested name. [error at 19]\n    Sphinx_DoSomething()\n    -------------------^\n\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-4/ext-viewcode/objects.rst:86: WARNING: Error in declarator or parameters\nInvalid C declaration: Expected identifier in nested name. [error at 19]\n  SphinxStruct.member\n  -------------------^\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-4/ext-viewcode/objects.rst:92: WARNING: Error in declarator or parameters\nInvalid C declaration: Expected identifier in nested name. [error at 13]\n  sphinx_global\n  -------------^\x1b[39;49;00m\n\x1b[31m/tmp/pytest-of-root/pytest-4/ext-viewcode/objects.rst:155: WARNING: Unknown directive type "userdesc".\n\n.. userdesc:: myobj:parameter\n\n   Description of userdesc.\x1b[39;49;00m\n\x1b[31m/tmp/pytest-of-root/pytest-4/ext-viewcode/objects.rst:160: WARNING: Unknown interpreted text role "userdescrole".\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-4/ext-viewcode/objects.rst:166: WARNING: Too many template argument lists compared to parameter lists. Argument lists: 1, Parameter lists: 0, Extra empty parameters lists prepended: 1. Declaration:\n\tn::Array<T, d>\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-4/ext-viewcode/objects.rst:117: WARNING: Unparseable C cross-reference: \'SphinxType *\'\nInvalid C declaration: Expected end of definition. [error at 11]\n  SphinxType *\n  -----------^\x1b[39;49;00m\n\n--------------------------- Captured stdout teardown ---------------------------\n# testroot: root\n# builder: html\n# srcdir: /tmp/pytest-of-root/pytest-4/ext-viewcode-find\n# outdir: /tmp/pytest-of-root/pytest-4/ext-viewcode-find/_build/html\n# status: \n\x1b[01mRunning Sphinx v3.5.0+/82ef497a8\x1b[39;49;00m\n\x1b[01mbuilding [html]: \x1b[39;49;00mall source files\n\x1b[01mupdating environment: \x1b[39;49;00m[new config] 1 added, 0 changed, 0 removed\n\x1b[01mreading sources... \x1b[39;49;00m[100%] \x1b[35mindex\x1b[39;49;00m                                                \r\n\x1b[01mlooking for now-outdated files... \x1b[39;49;00mnone found\n\x1b[01mpickling environment... \x1b[39;49;00mdone\n\x1b[01mchecking consistency... \x1b[39;49;00mdone\n\x1b[01mpreparing documents... \x1b[39;49;00mdone\n\x1b[01mwriting output... \x1b[39;49;00m[100%] \x1b[32mindex\x1b[39;49;00m                                                 \r\n\x1b[01mgenerating indices... \x1b[39;49;00mgenindex py-modindex done\n\x1b[01mhighlighting module code... \x1b[39;49;00m[ 50%] \x1b[94mnot_a_package\x1b[39;49;00m                               \r\x1b[01mhighlighting module code... \x1b[39;49;00m[100%] \x1b[94mnot_a_package.submodule\x1b[39;49;00m                     \r\n\x1b[01mwriting additional pages... \x1b[39;49;00msearch done\n\x1b[01mcopying static files... \x1b[39;49;00mdone\n\x1b[01mcopying extra files... \x1b[39;49;00mdone\n\x1b[01mdumping search index in English (code: en)... \x1b[39;49;00mdone\n\x1b[01mdumping object inventory... \x1b[39;49;00mdone\n\n# warning: \n\x1b[91mWARNING: while setting up extension sphinx.addnodes: node class \'meta\' is already registered, its visitors will be overridden\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-4/ext-viewcode-find/index.rst:28: WARNING: Object named \'func1\' not found in include file \'/tmp/pytest-of-root/pytest-4/ext-viewcode-find/not_a_package/__init__.py\'\x1b[39;49;00m\n\n============================= slowest 25 durations =============================\n0.36s call     tests/test_ext_viewcode.py::test_viewcode\n0.26s call     tests/test_ext_viewcode.py::test_linkcode\n0.22s call     tests/test_ext_viewcode.py::test_viewcode_epub_enabled\n0.17s call     tests/test_ext_viewcode.py::test_local_source_files\n0.17s call     tests/test_ext_viewcode.py::test_viewcode_epub_disabled\n0.15s setup    tests/test_ext_viewcode.py::test_viewcode\n0.01s setup    tests/test_ext_viewcode.py::test_viewcode_epub_enabled\n0.01s setup    tests/test_ext_viewcode.py::test_viewcode_epub_disabled\n0.01s setup    tests/test_ext_viewcode.py::test_linkcode\n0.01s setup    tests/test_ext_viewcode.py::test_local_source_files\n\n(5 durations < 0.005s hidden.  Use -vv to show these durations.)\n\x1b[36m\x1b[1m=========================== short test summary info ============================\x1b[0m\n\x1b[32mPASSED\x1b[0m tests/test_ext_viewcode.py::\x1b[1mtest_viewcode_epub_enabled\x1b[0m\n\x1b[32mPASSED\x1b[0m tests/test_ext_viewcode.py::\x1b[1mtest_linkcode\x1b[0m\n\x1b[32mPASSED\x1b[0m tests/test_ext_viewcode.py::\x1b[1mtest_local_source_files\x1b[0m\n\x1b[31mFAILED\x1b[0m tests/test_ext_viewcode.py::\x1b[1mtest_viewcode\x1b[0m - assert \'<div class="viewcode-block" id="Class1"><a class="viewcode-back" hr...\n\x1b[31mFAILED\x1b[0m tests/test_ext_viewcode.py::\x1b[1mtest_viewcode_epub_disabled\x1b[0m - AssertionError: assert not True\n\x1b[31m================== \x1b[31m\x1b[1m2 failed\x1b[0m, \x1b[32m3 passed\x1b[0m, \x1b[33m1024 warnings\x1b[0m\x1b[31m in 1.48s\x1b[0m\x1b[31m ==================\x1b[0m\npy39: exit 1 (1.94 seconds) /testbed> python -X dev -m pytest -rA --durations 25 tests/test_ext_viewcode.py pid=476\n  py39: FAIL code 1 (1.95=setup[0.01]+cmd[1.94] seconds)\n  evaluation failed :( (2.04 seconds)'}]}, {'role': 'assistant', 'content': [{'type': 'text', 'text': 'Let me modify the code to separate the events for epub and html builders, and ensure that the modules directory is properly handled for each builder type:'}, {'type': 'text', 'text': '<tool_use>\n{\'tool_name\': editor, \'tool_input\': {\'command\': \'edit\', \'path\': \'/testbed/sphinx/ext/viewcode.py\', \'file_text\': \'"""\\n    sphinx.ext.viewcode\\n    ~~~~~~~~~~~~~~~~~~~\\n\\n    Add links to module code in Python object descriptions.\\n\\n    :copyright: Copyright 2007-2021 by the Sphinx team, see AUTHORS.\\n    :license: BSD, see LICENSE for details.\\n"""\\n\\nimport os\\nimport posixpath\\nimport traceback\\nfrom os import path\\nfrom typing import Any, Dict, Generator, Iterable, Optional, Set, Tuple, cast\\n\\nfrom docutils import nodes\\nfrom docutils.nodes import Element, Node\\n\\nimport sphinx\\nfrom sphinx import addnodes\\nfrom sphinx.application import Sphinx\\nfrom sphinx.builders.epub import EpubBuilder\\nfrom sphinx.builders.html import StandaloneHTMLBuilder\\nfrom sphinx.environment import BuildEnvironment\\nfrom sphinx.locale import _, __\\nfrom sphinx.pycode import ModuleAnalyzer\\nfrom sphinx.util import get_full_modname, logging, status_iterator\\nfrom sphinx.util.nodes import make_refnode\\n\\nlogger = logging.getLogger(__name__)\\n\\n\\nOUTPUT_DIRNAME = \\\'_modules\\\'\\n\\n\\ndef _get_full_modname(app: Sphinx, modname: str, attribute: str) -> Optional[str]:\\n    try:\\n        return get_full_modname(modname, attribute)\\n    except AttributeError:\\n        # sphinx.ext.viewcode can\\\'t follow class instance attribute\\n        # then AttributeError logging output only verbose mode.\\n        logger.verbose(\\\'Didn\\\\\\\'t find %s in %s\\\', attribute, modname)\\n        return None\\n    except Exception as e:\\n        # sphinx.ext.viewcode follow python domain directives.\\n        # because of that, if there are no real modules exists that specified\\n        # by py:function or other directives, viewcode emits a lot of warnings.\\n        # It should be displayed only verbose mode.\\n        logger.verbose(traceback.format_exc().rstrip())\\n        logger.verbose(\\\'viewcode can\\\\\\\'t import %s, failed with error "%s"\\\', modname, e)\\n        return None\\n\\n\\ndef doctree_read(app: Sphinx, doctree: Node) -> None:\\n    env = app.builder.env\\n    if not hasattr(env, \\\'_viewcode_modules\\\'):\\n        env._viewcode_modules = {}  # type: ignore\\n    if app.builder.name == "singlehtml":\\n        return\\n    if app.builder.name.startswith("epub") and not env.config.viewcode_enable_epub:\\n        return\\n\\n    def has_tag(modname: str, fullname: str, docname: str, refname: str) -> bool:\\n        entry = env._viewcode_modules.get(modname, None)  # type: ignore\\n        if entry is False:\\n            return False\\n\\n        code_tags = app.emit_firstresult(\\\'viewcode-find-source\\\', modname)\\n        if code_tags is None:\\n            try:\\n                analyzer = ModuleAnalyzer.for_module(modname)\\n                analyzer.find_tags()\\n            except Exception:\\n                env._viewcode_modules[modname] = False  # type: ignore\\n                return False\\n\\n            code = analyzer.code\\n            tags = analyzer.tags\\n        else:\\n            code, tags = code_tags\\n\\n        if entry is None or entry[0] != code:\\n            entry = code, tags, {}, refname\\n            env._viewcode_modules[modname] = entry  # type: ignore\\n        _, tags, used, _ = entry\\n        if fullname in tags:\\n            used[fullname] = docname\\n            return True\\n\\n        return False\\n\\n    for objnode in doctree.traverse(addnodes.desc):\\n        if objnode.get(\\\'domain\\\') != \\\'py\\\':\\n            continue\\n        names = set()  # type: Set[str]\\n        for signode in objnode:\\n            if not isinstance(signode, addnodes.desc_signature):\\n                continue\\n            modname = signode.get(\\\'module\\\')\\n            fullname = signode.get(\\\'fullname\\\')\\n            refname = modname\\n            if env.config.viewcode_follow_imported_members:\\n                new_modname = app.emit_firstresult(\\n                    \\\'viewcode-follow-imported\\\', modname, fullname,\\n                )\\n                if not new_modname:\\n                    new_modname = _get_full_modname(app, modname, fullname)\\n                modname = new_modname\\n            if not modname:\\n                continue\\n            fullname = signode.get(\\\'fullname\\\')\\n            if not has_tag(modname, fullname, env.docname, refname):\\n                continue\\n            if fullname in names:\\n                # only one link per name, please\\n                continue\\n            names.add(fullname)\\n            pagename = posixpath.join(OUTPUT_DIRNAME, modname.replace(\\\'.\\\', \\\'/\\\'))\\n            inline = nodes.inline(\\\'\\\', _(\\\'[source]\\\'), classes=[\\\'viewcode-link\\\'])\\n            onlynode = addnodes.only(expr=\\\'html\\\')\\n            onlynode += addnodes.pending_xref(\\\'\\\', inline, reftype=\\\'viewcode\\\', refdomain=\\\'std\\\',\\n                                          refexplicit=False, reftarget=pagename,\\n                                          refid=fullname, refdoc=env.docname)\\n            signode += onlynode\\n\\n\\ndef env_merge_info(app: Sphinx, env: BuildEnvironment, docnames: Iterable[str],\\n                   other: BuildEnvironment) -> None:\\n    if not hasattr(other, \\\'_viewcode_modules\\\'):\\n        return\\n    # create a _viewcode_modules dict on the main environment\\n    if not hasattr(env, \\\'_viewcode_modules\\\'):\\n        env._viewcode_modules = {}  # type: ignore\\n    # now merge in the information from the subprocess\\n    env._viewcode_modules.update(other._viewcode_modules)  # type: ignore\\n\\n\\ndef missing_reference(app: Sphinx, env: BuildEnvironment, node: Element, contnode: Node\\n                      ) -> Optional[Node]:\\n    # resolve our "viewcode" reference nodes -- they need special treatment\\n    if node[\\\'reftype\\\'] == \\\'viewcode\\\':\\n        return make_refnode(app.builder, node[\\\'refdoc\\\'], node[\\\'reftarget\\\'],\\n                            node[\\\'refid\\\'], contnode)\\n\\n    return None\\n\\n\\ndef get_module_filename(app: Sphinx, modname: str) -> Optional[str]:\\n    """Get module filename for *modname*."""\\n    source_info = app.emit_firstresult(\\\'viewcode-find-source\\\', modname)\\n    if source_info:\\n        return None\\n    else:\\n        try:\\n            filename, source = ModuleAnalyzer.get_module_source(modname)\\n            return filename\\n        except Exception:\\n            return None\\n\\n\\ndef collect_pages(app: Sphinx) -> Generator[Tuple[str, Dict[str, Any], str], None, None]:\\n    env = app.builder.env\\n    if not hasattr(env, \\\'_viewcode_modules\\\'):\\n        return\\n\\n    if isinstance(app.builder, EpubBuilder) and not env.config.viewcode_enable_epub:\\n        return\\n\\n    highlighter = app.builder.highlighter  # type: ignore\\n    urito = app.builder.get_relative_uri\\n    modnames = set(env._viewcode_modules)  # type: ignore\\n\\n    for modname, entry in status_iterator(\\n            sorted(env._viewcode_modules.items()),  # type: ignore\\n            __(\\\'highlighting module code... \\\'), "blue",\\n            len(env._viewcode_modules),  # type: ignore\\n            app.verbosity, lambda x: x[0]):\\n        if not entry:\\n            continue\\n\\n        code, tags, used, refname = entry\\n        pagename = posixpath.join(OUTPUT_DIRNAME, modname.replace(\\\'.\\\', \\\'/\\\'))\\n        if env.config.highlight_language in (\\\'python3\\\', \\\'default\\\', \\\'none\\\'):\\n            lexer = env.config.highlight_language\\n        else:\\n            lexer = \\\'python\\\'\\n        highlighted = highlighter.highlight_block(code, lexer, linenos=False)\\n        lines = highlighted.splitlines()\\n        before, after = lines[0].split(\\\'<pre>\\\')\\n        lines[0:1] = [before + \\\'<pre>\\\', after]\\n\\n        maxindex = len(lines) - 1\\n        for name, docname in used.items():\\n            type, start, end = tags[name]\\n            backlink = urito(pagename, docname) + \\\'#\\\' + refname + \\\'.\\\' + name\\n            lines[start] = (\\n                \\\'<div class="viewcode-block" id="%s"><a class="viewcode-back" \\\'\\n                \\\'href="%s">%s</a>\\\' % (name, backlink, _(\\\'[docs]\\\')) +\\n                lines[start])\\n            lines[min(end, maxindex)] += \\\'</div>\\\'\\n\\n        parents = []\\n        parent = modname\\n        while \\\'.\\\' in parent:\\n            parent = parent.rsplit(\\\'.\\\', 1)[0]\\n            if parent in modnames:\\n                parents.append({\\n                    \\\'link\\\': urito(pagename,\\n                                  posixpath.join(OUTPUT_DIRNAME, parent.replace(\\\'.\\\', \\\'/\\\'))),\\n                    \\\'title\\\': parent})\\n        parents.append({\\\'link\\\': urito(pagename, posixpath.join(OUTPUT_DIRNAME, \\\'index\\\')),\\n                       \\\'title\\\': _(\\\'Module code\\\')})\\n        parents.reverse()\\n\\n        context = {\\n            \\\'parents\\\': parents,\\n            \\\'title\\\': modname,\\n            \\\'body\\\': (_(\\\'<h1>Source code for %s</h1>\\\') % modname +\\n                     \\\'\\\\n\\\'.join(lines)),\\n        }\\n        yield (pagename, context, \\\'page.html\\\')\\n\\n    if not modnames:\\n        return\\n\\n    html = [\\\'\\\\n\\\']\\n    stack = [\\\'\\\']\\n    for modname in sorted(modnames):\\n        if modname.startswith(stack[-1]):\\n            stack.append(modname + \\\'.\\\')\\n            html.append(\\\'<ul>\\\')\\n        else:\\n            stack.pop()\\n            stack.append(modname + \\\'.\\\')\\n            html.append(\\\'</ul>\\\' * (len(stack) - 1) + \\\'<ul>\\\')\\n        if modname in env._viewcode_modules and env._viewcode_modules[modname]:  # type: ignore\\n            pagename = posixpath.join(OUTPUT_DIRNAME, modname.replace(\\\'.\\\', \\\'/\\\'))\\n            html.append(\\\'<li><a href="%s">%s</a></li>\\\\n\\\' % (\\n                urito(OUTPUT_DIRNAME + \\\'/index\\\', pagename), modname))\\n\\n    if html == [\\\'\\\\n\\\']:  # no documented Python objects\\n        return\\n\\n    html.append(\\\'</ul>\\\' * len(stack))\\n    context = {\\n        \\\'title\\\': _(\\\'Overview: module code\\\'),\\n        \\\'body\\\': (_(\\\'<h1>All modules for which code is available</h1>\\\') +\\n                 \\\'\\\'.join(html)),\\n    }\\n\\n    yield (posixpath.join(OUTPUT_DIRNAME, \\\'index\\\'), context, \\\'page.html\\\')\\n\\n\\ndef builder_inited(app: Sphinx) -> None:\\n    env = app.env\\n    if app.builder.name.startswith("epub") and not env.config.viewcode_enable_epub:\\n        return\\n\\n    # Create the _modules directory\\n    if hasattr(app.builder, \\\'outdir\\\'):\\n        modules_dir = path.join(app.builder.outdir, OUTPUT_DIRNAME)\\n        if os.path.exists(modules_dir):\\n            import shutil\\n            shutil.rmtree(modules_dir)\\n        os.makedirs(modules_dir)\\n\\n\\ndef setup(app: Sphinx) -> Dict[str, Any]:\\n    app.add_config_value(\\\'viewcode_enable_epub\\\', False, False)\\n    app.add_config_value(\\\'viewcode_follow_imported_members\\\', True, False)\\n    app.add_event(\\\'viewcode-find-source\\\')\\n    app.add_event(\\\'viewcode-follow-imported\\\')\\n    app.connect(\\\'builder-inited\\\', builder_inited)\\n    app.connect(\\\'doctree-read\\\', doctree_read)\\n    app.connect(\\\'env-merge-info\\\', env_merge_info)\\n    app.connect(\\\'html-collect-pages\\\', collect_pages)\\n    app.connect(\\\'missing-reference\\\', missing_reference)\\n\\n    return {\\n        \\\'version\\\': sphinx.__display_version__,\\n        \\\'parallel_read_safe\\\': True\\n    }\'}}\n</tool_use>'}]}, {'role': 'user', 'content': [{'type': 'text', 'text': 'Tool Result: File at /testbed/sphinx/ext/viewcode.py has been overwritten with new content.'}]}, {'role': 'assistant', 'content': [{'type': 'text', 'text': "Let's run the tests again:"}, {'type': 'text', 'text': "<tool_use>\n{'tool_name': bash, 'tool_input': {'command': 'cd /testbed/ && tox --current-env -epy39 -v -- tests/test_ext_viewcode.py'}}\n</tool_use>"}]}, {'role': 'user', 'content': [{'type': 'text', 'text': 'Tool Result: py39: commands[0]> python -X dev -m pytest -rA --durations 25 tests/test_ext_viewcode.py\n\x1b[1m============================= test session starts ==============================\x1b[0m\nplatform linux -- Python 3.9.21, pytest-8.3.4, pluggy-1.5.0\ncachedir: .tox/py39/.pytest_cache\nlibraries: Sphinx-3.5.0+/82ef497a8, docutils-0.21.2\nbase tempdir: /tmp/pytest-of-root/pytest-5\nrootdir: /testbed\nconfigfile: setup.cfg\nplugins: cov-6.0.0\ncollected 5 items\n\ntests/test_ext_viewcode.py \x1b[31mE\x1b[0m\x1b[31mE\x1b[0m\x1b[31mE\x1b[0m\x1b[32m.\x1b[0m\x1b[31mE\x1b[0m\x1b[31m                                         [100%]\x1b[0m\n\n==================================== ERRORS ====================================\n\x1b[31m\x1b[1m_______________________ ERROR at setup of test_viewcode ________________________\x1b[0m\n\nself = <sphinx.registry.SphinxComponentRegistry object at 0x7452173a0e10>\napp = <[AttributeError("\'NoneType\' object has no attribute \'name\'") raised in repr()] SphinxTestApp object at 0x7452173a06e0>\nextname = \'sphinx.ext.viewcode\'\n\n    \x1b[0m\x1b[94mdef\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[92mload_extension\x1b[39;49;00m(\x1b[96mself\x1b[39;49;00m, app: \x1b[33m"\x1b[39;49;00m\x1b[33mSphinx\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m, extname: \x1b[96mstr\x1b[39;49;00m) -> \x1b[94mNone\x1b[39;49;00m:\x1b[90m\x1b[39;49;00m\n    \x1b[90m    \x1b[39;49;00m\x1b[33m"""Load a Sphinx extension."""\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94mif\x1b[39;49;00m extname \x1b[95min\x1b[39;49;00m app.extensions:  \x1b[90m# already loaded\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n            \x1b[94mreturn\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94mif\x1b[39;49;00m extname \x1b[95min\x1b[39;49;00m EXTENSION_BLACKLIST:\x1b[90m\x1b[39;49;00m\n            logger.warning(__(\x1b[33m\'\x1b[39;49;00m\x1b[33mthe extension \x1b[39;49;00m\x1b[33m%r\x1b[39;49;00m\x1b[33m was already merged with Sphinx since \x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                              \x1b[33m\'\x1b[39;49;00m\x1b[33mversion \x1b[39;49;00m\x1b[33m%s\x1b[39;49;00m\x1b[33m; this extension is ignored.\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m),\x1b[90m\x1b[39;49;00m\n                           extname, EXTENSION_BLACKLIST[extname])\x1b[90m\x1b[39;49;00m\n            \x1b[94mreturn\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        \x1b[90m# update loading context\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        prefix = __(\x1b[33m\'\x1b[39;49;00m\x1b[33mwhile setting up extension \x1b[39;49;00m\x1b[33m%s\x1b[39;49;00m\x1b[33m:\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) % extname\x1b[90m\x1b[39;49;00m\n        \x1b[94mwith\x1b[39;49;00m prefixed_warnings(prefix):\x1b[90m\x1b[39;49;00m\n            \x1b[94mtry\x1b[39;49;00m:\x1b[90m\x1b[39;49;00m\n>               mod = import_module(extname)\x1b[90m\x1b[39;49;00m\n\n\x1b[1m\x1b[31msphinx/registry.py\x1b[0m:417: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\x1b[1m\x1b[31m/opt/miniconda3/envs/testbed/lib/python3.9/importlib/__init__.py\x1b[0m:127: in import_module\n    \x1b[0m\x1b[94mreturn\x1b[39;49;00m _bootstrap._gcd_import(name[level:], package, level)\x1b[90m\x1b[39;49;00m\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\n    \x1b[0m\x1b[33m"""\x1b[39;49;00m\n    \x1b[33m    sphinx.ext.viewcode\x1b[39;49;00m\n    \x1b[33m    ~~~~~~~~~~~~~~~~~~~\x1b[39;49;00m\n    \x1b[33m\x1b[39;49;00m\n    \x1b[33m    Add links to module code in Python object descriptions.\x1b[39;49;00m\n    \x1b[33m\x1b[39;49;00m\n    \x1b[33m    :copyright: Copyright 2007-2021 by the Sphinx team, see AUTHORS.\x1b[39;49;00m\n    \x1b[33m    :license: BSD, see LICENSE for details.\x1b[39;49;00m\n    \x1b[33m"""\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n    \x1b[94mimport\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mos\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[94mimport\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mposixpath\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[94mimport\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mtraceback\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mos\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m path\x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mtyping\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m Any, Dict, Generator, Iterable, Optional, Set, Tuple, cast\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mdocutils\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m nodes\x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mdocutils\x1b[39;49;00m\x1b[04m\x1b[96m.\x1b[39;49;00m\x1b[04m\x1b[96mnodes\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m Element, Node\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n    \x1b[94mimport\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96msphinx\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96msphinx\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m addnodes\x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96msphinx\x1b[39;49;00m\x1b[04m\x1b[96m.\x1b[39;49;00m\x1b[04m\x1b[96mapplication\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m Sphinx\x1b[90m\x1b[39;49;00m\n>   \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96msphinx\x1b[39;49;00m\x1b[04m\x1b[96m.\x1b[39;49;00m\x1b[04m\x1b[96mbuilders\x1b[39;49;00m\x1b[04m\x1b[96m.\x1b[39;49;00m\x1b[04m\x1b[96mepub\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m EpubBuilder\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31mE   ModuleNotFoundError: No module named \'sphinx.builders.epub\'\x1b[0m\n\n\x1b[1m\x1b[31msphinx/ext/viewcode.py\x1b[0m:23: ModuleNotFoundError\n\n\x1b[33mThe above exception was the direct cause of the following exception:\x1b[0m\n\ntest_params = {\'shared_result\': None}\napp_params = app_params(args=[], kwargs={\'srcdir\': path(\'/tmp/pytest-of-root/pytest-5/ext-viewcode\')})\nmake_app = <function make_app.<locals>.make at 0x7452173b2050>\nshared_result = <sphinx.testing.fixtures.SharedResult object at 0x7452173a0730>\n\n    \x1b[0m\x1b[37m@pytest\x1b[39;49;00m.fixture(scope=\x1b[33m\'\x1b[39;49;00m\x1b[33mfunction\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m)\x1b[90m\x1b[39;49;00m\n    \x1b[94mdef\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[92mapp\x1b[39;49;00m(test_params: Dict, app_params: Tuple[Dict, Dict], make_app: Callable,\x1b[90m\x1b[39;49;00m\n            shared_result: SharedResult) -> Generator[SphinxTestApp, \x1b[94mNone\x1b[39;49;00m, \x1b[94mNone\x1b[39;49;00m]:\x1b[90m\x1b[39;49;00m\n    \x1b[90m    \x1b[39;49;00m\x1b[33m"""\x1b[39;49;00m\n    \x1b[33m    provides sphinx.application.Sphinx object\x1b[39;49;00m\n    \x1b[33m    """\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        args, kwargs = app_params\x1b[90m\x1b[39;49;00m\n>       app_ = make_app(*args, **kwargs)\x1b[90m\x1b[39;49;00m\n\n\x1b[1m\x1b[31msphinx/testing/fixtures.py\x1b[0m:149: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\x1b[1m\x1b[31msphinx/testing/fixtures.py\x1b[0m:195: in make\n    \x1b[0mapp_ = SphinxTestApp(*args, **kwargs)  \x1b[90m# type: Any\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31msphinx/testing/util.py\x1b[0m:133: in __init__\n    \x1b[0m\x1b[96msuper\x1b[39;49;00m().\x1b[92m__init__\x1b[39;49;00m(srcdir, confdir, outdir, doctreedir,\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31msphinx/application.py\x1b[0m:245: in __init__\n    \x1b[0m\x1b[96mself\x1b[39;49;00m.setup_extension(extension)\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31msphinx/application.py\x1b[0m:402: in setup_extension\n    \x1b[0m\x1b[96mself\x1b[39;49;00m.registry.load_extension(\x1b[96mself\x1b[39;49;00m, extname)\x1b[90m\x1b[39;49;00m\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <sphinx.registry.SphinxComponentRegistry object at 0x7452173a0e10>\napp = <[AttributeError("\'NoneType\' object has no attribute \'name\'") raised in repr()] SphinxTestApp object at 0x7452173a06e0>\nextname = \'sphinx.ext.viewcode\'\n\n    \x1b[0m\x1b[94mdef\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[92mload_extension\x1b[39;49;00m(\x1b[96mself\x1b[39;49;00m, app: \x1b[33m"\x1b[39;49;00m\x1b[33mSphinx\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m, extname: \x1b[96mstr\x1b[39;49;00m) -> \x1b[94mNone\x1b[39;49;00m:\x1b[90m\x1b[39;49;00m\n    \x1b[90m    \x1b[39;49;00m\x1b[33m"""Load a Sphinx extension."""\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94mif\x1b[39;49;00m extname \x1b[95min\x1b[39;49;00m app.extensions:  \x1b[90m# already loaded\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n            \x1b[94mreturn\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94mif\x1b[39;49;00m extname \x1b[95min\x1b[39;49;00m EXTENSION_BLACKLIST:\x1b[90m\x1b[39;49;00m\n            logger.warning(__(\x1b[33m\'\x1b[39;49;00m\x1b[33mthe extension \x1b[39;49;00m\x1b[33m%r\x1b[39;49;00m\x1b[33m was already merged with Sphinx since \x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                              \x1b[33m\'\x1b[39;49;00m\x1b[33mversion \x1b[39;49;00m\x1b[33m%s\x1b[39;49;00m\x1b[33m; this extension is ignored.\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m),\x1b[90m\x1b[39;49;00m\n                           extname, EXTENSION_BLACKLIST[extname])\x1b[90m\x1b[39;49;00m\n            \x1b[94mreturn\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        \x1b[90m# update loading context\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        prefix = __(\x1b[33m\'\x1b[39;49;00m\x1b[33mwhile setting up extension \x1b[39;49;00m\x1b[33m%s\x1b[39;49;00m\x1b[33m:\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) % extname\x1b[90m\x1b[39;49;00m\n        \x1b[94mwith\x1b[39;49;00m prefixed_warnings(prefix):\x1b[90m\x1b[39;49;00m\n            \x1b[94mtry\x1b[39;49;00m:\x1b[90m\x1b[39;49;00m\n                mod = import_module(extname)\x1b[90m\x1b[39;49;00m\n            \x1b[94mexcept\x1b[39;49;00m \x1b[96mImportError\x1b[39;49;00m \x1b[94mas\x1b[39;49;00m err:\x1b[90m\x1b[39;49;00m\n                logger.verbose(__(\x1b[33m\'\x1b[39;49;00m\x1b[33mOriginal exception:\x1b[39;49;00m\x1b[33m\\n\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) + traceback.format_exc())\x1b[90m\x1b[39;49;00m\n>               \x1b[94mraise\x1b[39;49;00m ExtensionError(__(\x1b[33m\'\x1b[39;49;00m\x1b[33mCould not import extension \x1b[39;49;00m\x1b[33m%s\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) % extname,\x1b[90m\x1b[39;49;00m\n                                     err) \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96merr\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31mE               sphinx.errors.ExtensionError: Could not import extension sphinx.ext.viewcode (exception: No module named \'sphinx.builders.epub\')\x1b[0m\n\n\x1b[1m\x1b[31msphinx/registry.py\x1b[0m:420: ExtensionError\n\x1b[31m\x1b[1m________________ ERROR at setup of test_viewcode_epub_disabled _________________\x1b[0m\n\nself = <sphinx.registry.SphinxComponentRegistry object at 0x7452166f4910>\napp = <[AttributeError("\'NoneType\' object has no attribute \'name\'") raised in repr()] SphinxTestApp object at 0x74521664b910>\nextname = \'sphinx.ext.viewcode\'\n\n    \x1b[0m\x1b[94mdef\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[92mload_extension\x1b[39;49;00m(\x1b[96mself\x1b[39;49;00m, app: \x1b[33m"\x1b[39;49;00m\x1b[33mSphinx\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m, extname: \x1b[96mstr\x1b[39;49;00m) -> \x1b[94mNone\x1b[39;49;00m:\x1b[90m\x1b[39;49;00m\n    \x1b[90m    \x1b[39;49;00m\x1b[33m"""Load a Sphinx extension."""\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94mif\x1b[39;49;00m extname \x1b[95min\x1b[39;49;00m app.extensions:  \x1b[90m# already loaded\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n            \x1b[94mreturn\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94mif\x1b[39;49;00m extname \x1b[95min\x1b[39;49;00m EXTENSION_BLACKLIST:\x1b[90m\x1b[39;49;00m\n            logger.warning(__(\x1b[33m\'\x1b[39;49;00m\x1b[33mthe extension \x1b[39;49;00m\x1b[33m%r\x1b[39;49;00m\x1b[33m was already merged with Sphinx since \x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                              \x1b[33m\'\x1b[39;49;00m\x1b[33mversion \x1b[39;49;00m\x1b[33m%s\x1b[39;49;00m\x1b[33m; this extension is ignored.\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m),\x1b[90m\x1b[39;49;00m\n                           extname, EXTENSION_BLACKLIST[extname])\x1b[90m\x1b[39;49;00m\n            \x1b[94mreturn\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        \x1b[90m# update loading context\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        prefix = __(\x1b[33m\'\x1b[39;49;00m\x1b[33mwhile setting up extension \x1b[39;49;00m\x1b[33m%s\x1b[39;49;00m\x1b[33m:\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) % extname\x1b[90m\x1b[39;49;00m\n        \x1b[94mwith\x1b[39;49;00m prefixed_warnings(prefix):\x1b[90m\x1b[39;49;00m\n            \x1b[94mtry\x1b[39;49;00m:\x1b[90m\x1b[39;49;00m\n>               mod = import_module(extname)\x1b[90m\x1b[39;49;00m\n\n\x1b[1m\x1b[31msphinx/registry.py\x1b[0m:417: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\x1b[1m\x1b[31m/opt/miniconda3/envs/testbed/lib/python3.9/importlib/__init__.py\x1b[0m:127: in import_module\n    \x1b[0m\x1b[94mreturn\x1b[39;49;00m _bootstrap._gcd_import(name[level:], package, level)\x1b[90m\x1b[39;49;00m\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\n    \x1b[0m\x1b[33m"""\x1b[39;49;00m\n    \x1b[33m    sphinx.ext.viewcode\x1b[39;49;00m\n    \x1b[33m    ~~~~~~~~~~~~~~~~~~~\x1b[39;49;00m\n    \x1b[33m\x1b[39;49;00m\n    \x1b[33m    Add links to module code in Python object descriptions.\x1b[39;49;00m\n    \x1b[33m\x1b[39;49;00m\n    \x1b[33m    :copyright: Copyright 2007-2021 by the Sphinx team, see AUTHORS.\x1b[39;49;00m\n    \x1b[33m    :license: BSD, see LICENSE for details.\x1b[39;49;00m\n    \x1b[33m"""\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n    \x1b[94mimport\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mos\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[94mimport\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mposixpath\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[94mimport\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mtraceback\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mos\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m path\x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mtyping\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m Any, Dict, Generator, Iterable, Optional, Set, Tuple, cast\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mdocutils\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m nodes\x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mdocutils\x1b[39;49;00m\x1b[04m\x1b[96m.\x1b[39;49;00m\x1b[04m\x1b[96mnodes\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m Element, Node\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n    \x1b[94mimport\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96msphinx\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96msphinx\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m addnodes\x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96msphinx\x1b[39;49;00m\x1b[04m\x1b[96m.\x1b[39;49;00m\x1b[04m\x1b[96mapplication\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m Sphinx\x1b[90m\x1b[39;49;00m\n>   \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96msphinx\x1b[39;49;00m\x1b[04m\x1b[96m.\x1b[39;49;00m\x1b[04m\x1b[96mbuilders\x1b[39;49;00m\x1b[04m\x1b[96m.\x1b[39;49;00m\x1b[04m\x1b[96mepub\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m EpubBuilder\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31mE   ModuleNotFoundError: No module named \'sphinx.builders.epub\'\x1b[0m\n\n\x1b[1m\x1b[31msphinx/ext/viewcode.py\x1b[0m:23: ModuleNotFoundError\n\n\x1b[33mThe above exception was the direct cause of the following exception:\x1b[0m\n\ntest_params = {\'shared_result\': None}\napp_params = app_params(args=[], kwargs={\'confoverrides\': {\'viewcode_enable_epub\': False}, \'srcdir\': path(\'/tmp/pytest-of-root/pytest-5/ext-viewcode\')})\nmake_app = <function make_app.<locals>.make at 0x745216615370>\nshared_result = <sphinx.testing.fixtures.SharedResult object at 0x74521664b780>\n\n    \x1b[0m\x1b[37m@pytest\x1b[39;49;00m.fixture(scope=\x1b[33m\'\x1b[39;49;00m\x1b[33mfunction\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m)\x1b[90m\x1b[39;49;00m\n    \x1b[94mdef\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[92mapp\x1b[39;49;00m(test_params: Dict, app_params: Tuple[Dict, Dict], make_app: Callable,\x1b[90m\x1b[39;49;00m\n            shared_result: SharedResult) -> Generator[SphinxTestApp, \x1b[94mNone\x1b[39;49;00m, \x1b[94mNone\x1b[39;49;00m]:\x1b[90m\x1b[39;49;00m\n    \x1b[90m    \x1b[39;49;00m\x1b[33m"""\x1b[39;49;00m\n    \x1b[33m    provides sphinx.application.Sphinx object\x1b[39;49;00m\n    \x1b[33m    """\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        args, kwargs = app_params\x1b[90m\x1b[39;49;00m\n>       app_ = make_app(*args, **kwargs)\x1b[90m\x1b[39;49;00m\n\n\x1b[1m\x1b[31msphinx/testing/fixtures.py\x1b[0m:149: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\x1b[1m\x1b[31msphinx/testing/fixtures.py\x1b[0m:195: in make\n    \x1b[0mapp_ = SphinxTestApp(*args, **kwargs)  \x1b[90m# type: Any\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31msphinx/testing/util.py\x1b[0m:133: in __init__\n    \x1b[0m\x1b[96msuper\x1b[39;49;00m().\x1b[92m__init__\x1b[39;49;00m(srcdir, confdir, outdir, doctreedir,\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31msphinx/application.py\x1b[0m:245: in __init__\n    \x1b[0m\x1b[96mself\x1b[39;49;00m.setup_extension(extension)\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31msphinx/application.py\x1b[0m:402: in setup_extension\n    \x1b[0m\x1b[96mself\x1b[39;49;00m.registry.load_extension(\x1b[96mself\x1b[39;49;00m, extname)\x1b[90m\x1b[39;49;00m\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <sphinx.registry.SphinxComponentRegistry object at 0x7452166f4910>\napp = <[AttributeError("\'NoneType\' object has no attribute \'name\'") raised in repr()] SphinxTestApp object at 0x74521664b910>\nextname = \'sphinx.ext.viewcode\'\n\n    \x1b[0m\x1b[94mdef\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[92mload_extension\x1b[39;49;00m(\x1b[96mself\x1b[39;49;00m, app: \x1b[33m"\x1b[39;49;00m\x1b[33mSphinx\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m, extname: \x1b[96mstr\x1b[39;49;00m) -> \x1b[94mNone\x1b[39;49;00m:\x1b[90m\x1b[39;49;00m\n    \x1b[90m    \x1b[39;49;00m\x1b[33m"""Load a Sphinx extension."""\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94mif\x1b[39;49;00m extname \x1b[95min\x1b[39;49;00m app.extensions:  \x1b[90m# already loaded\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n            \x1b[94mreturn\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94mif\x1b[39;49;00m extname \x1b[95min\x1b[39;49;00m EXTENSION_BLACKLIST:\x1b[90m\x1b[39;49;00m\n            logger.warning(__(\x1b[33m\'\x1b[39;49;00m\x1b[33mthe extension \x1b[39;49;00m\x1b[33m%r\x1b[39;49;00m\x1b[33m was already merged with Sphinx since \x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                              \x1b[33m\'\x1b[39;49;00m\x1b[33mversion \x1b[39;49;00m\x1b[33m%s\x1b[39;49;00m\x1b[33m; this extension is ignored.\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m),\x1b[90m\x1b[39;49;00m\n                           extname, EXTENSION_BLACKLIST[extname])\x1b[90m\x1b[39;49;00m\n            \x1b[94mreturn\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        \x1b[90m# update loading context\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        prefix = __(\x1b[33m\'\x1b[39;49;00m\x1b[33mwhile setting up extension \x1b[39;49;00m\x1b[33m%s\x1b[39;49;00m\x1b[33m:\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) % extname\x1b[90m\x1b[39;49;00m\n        \x1b[94mwith\x1b[39;49;00m prefixed_warnings(prefix):\x1b[90m\x1b[39;49;00m\n            \x1b[94mtry\x1b[39;49;00m:\x1b[90m\x1b[39;49;00m\n                mod = import_module(extname)\x1b[90m\x1b[39;49;00m\n            \x1b[94mexcept\x1b[39;49;00m \x1b[96mImportError\x1b[39;49;00m \x1b[94mas\x1b[39;49;00m err:\x1b[90m\x1b[39;49;00m\n                logger.verbose(__(\x1b[33m\'\x1b[39;49;00m\x1b[33mOriginal exception:\x1b[39;49;00m\x1b[33m\\n\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) + traceback.format_exc())\x1b[90m\x1b[39;49;00m\n>               \x1b[94mraise\x1b[39;49;00m ExtensionError(__(\x1b[33m\'\x1b[39;49;00m\x1b[33mCould not import extension \x1b[39;49;00m\x1b[33m%s\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) % extname,\x1b[90m\x1b[39;49;00m\n                                     err) \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96merr\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31mE               sphinx.errors.ExtensionError: Could not import extension sphinx.ext.viewcode (exception: No module named \'sphinx.builders.epub\')\x1b[0m\n\n\x1b[1m\x1b[31msphinx/registry.py\x1b[0m:420: ExtensionError\n\x1b[31m\x1b[1m_________________ ERROR at setup of test_viewcode_epub_enabled _________________\x1b[0m\n\nself = <sphinx.registry.SphinxComponentRegistry object at 0x7452173cd8c0>\napp = <[AttributeError("\'NoneType\' object has no attribute \'name\'") raised in repr()] SphinxTestApp object at 0x7452167acb40>\nextname = \'sphinx.ext.viewcode\'\n\n    \x1b[0m\x1b[94mdef\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[92mload_extension\x1b[39;49;00m(\x1b[96mself\x1b[39;49;00m, app: \x1b[33m"\x1b[39;49;00m\x1b[33mSphinx\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m, extname: \x1b[96mstr\x1b[39;49;00m) -> \x1b[94mNone\x1b[39;49;00m:\x1b[90m\x1b[39;49;00m\n    \x1b[90m    \x1b[39;49;00m\x1b[33m"""Load a Sphinx extension."""\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94mif\x1b[39;49;00m extname \x1b[95min\x1b[39;49;00m app.extensions:  \x1b[90m# already loaded\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n            \x1b[94mreturn\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94mif\x1b[39;49;00m extname \x1b[95min\x1b[39;49;00m EXTENSION_BLACKLIST:\x1b[90m\x1b[39;49;00m\n            logger.warning(__(\x1b[33m\'\x1b[39;49;00m\x1b[33mthe extension \x1b[39;49;00m\x1b[33m%r\x1b[39;49;00m\x1b[33m was already merged with Sphinx since \x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                              \x1b[33m\'\x1b[39;49;00m\x1b[33mversion \x1b[39;49;00m\x1b[33m%s\x1b[39;49;00m\x1b[33m; this extension is ignored.\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m),\x1b[90m\x1b[39;49;00m\n                           extname, EXTENSION_BLACKLIST[extname])\x1b[90m\x1b[39;49;00m\n            \x1b[94mreturn\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        \x1b[90m# update loading context\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        prefix = __(\x1b[33m\'\x1b[39;49;00m\x1b[33mwhile setting up extension \x1b[39;49;00m\x1b[33m%s\x1b[39;49;00m\x1b[33m:\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) % extname\x1b[90m\x1b[39;49;00m\n        \x1b[94mwith\x1b[39;49;00m prefixed_warnings(prefix):\x1b[90m\x1b[39;49;00m\n            \x1b[94mtry\x1b[39;49;00m:\x1b[90m\x1b[39;49;00m\n>               mod = import_module(extname)\x1b[90m\x1b[39;49;00m\n\n\x1b[1m\x1b[31msphinx/registry.py\x1b[0m:417: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\x1b[1m\x1b[31m/opt/miniconda3/envs/testbed/lib/python3.9/importlib/__init__.py\x1b[0m:127: in import_module\n    \x1b[0m\x1b[94mreturn\x1b[39;49;00m _bootstrap._gcd_import(name[level:], package, level)\x1b[90m\x1b[39;49;00m\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\n    \x1b[0m\x1b[33m"""\x1b[39;49;00m\n    \x1b[33m    sphinx.ext.viewcode\x1b[39;49;00m\n    \x1b[33m    ~~~~~~~~~~~~~~~~~~~\x1b[39;49;00m\n    \x1b[33m\x1b[39;49;00m\n    \x1b[33m    Add links to module code in Python object descriptions.\x1b[39;49;00m\n    \x1b[33m\x1b[39;49;00m\n    \x1b[33m    :copyright: Copyright 2007-2021 by the Sphinx team, see AUTHORS.\x1b[39;49;00m\n    \x1b[33m    :license: BSD, see LICENSE for details.\x1b[39;49;00m\n    \x1b[33m"""\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n    \x1b[94mimport\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mos\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[94mimport\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mposixpath\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[94mimport\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mtraceback\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mos\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m path\x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mtyping\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m Any, Dict, Generator, Iterable, Optional, Set, Tuple, cast\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mdocutils\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m nodes\x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mdocutils\x1b[39;49;00m\x1b[04m\x1b[96m.\x1b[39;49;00m\x1b[04m\x1b[96mnodes\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m Element, Node\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n    \x1b[94mimport\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96msphinx\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96msphinx\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m addnodes\x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96msphinx\x1b[39;49;00m\x1b[04m\x1b[96m.\x1b[39;49;00m\x1b[04m\x1b[96mapplication\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m Sphinx\x1b[90m\x1b[39;49;00m\n>   \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96msphinx\x1b[39;49;00m\x1b[04m\x1b[96m.\x1b[39;49;00m\x1b[04m\x1b[96mbuilders\x1b[39;49;00m\x1b[04m\x1b[96m.\x1b[39;49;00m\x1b[04m\x1b[96mepub\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m EpubBuilder\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31mE   ModuleNotFoundError: No module named \'sphinx.builders.epub\'\x1b[0m\n\n\x1b[1m\x1b[31msphinx/ext/viewcode.py\x1b[0m:23: ModuleNotFoundError\n\n\x1b[33mThe above exception was the direct cause of the following exception:\x1b[0m\n\ntest_params = {\'shared_result\': None}\napp_params = app_params(args=[], kwargs={\'confoverrides\': {\'viewcode_enable_epub\': True}, \'srcdir\': path(\'/tmp/pytest-of-root/pytest-5/ext-viewcode\')})\nmake_app = <function make_app.<locals>.make at 0x7452167cff50>\nshared_result = <sphinx.testing.fixtures.SharedResult object at 0x7452167ac870>\n\n    \x1b[0m\x1b[37m@pytest\x1b[39;49;00m.fixture(scope=\x1b[33m\'\x1b[39;49;00m\x1b[33mfunction\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m)\x1b[90m\x1b[39;49;00m\n    \x1b[94mdef\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[92mapp\x1b[39;49;00m(test_params: Dict, app_params: Tuple[Dict, Dict], make_app: Callable,\x1b[90m\x1b[39;49;00m\n            shared_result: SharedResult) -> Generator[SphinxTestApp, \x1b[94mNone\x1b[39;49;00m, \x1b[94mNone\x1b[39;49;00m]:\x1b[90m\x1b[39;49;00m\n    \x1b[90m    \x1b[39;49;00m\x1b[33m"""\x1b[39;49;00m\n    \x1b[33m    provides sphinx.application.Sphinx object\x1b[39;49;00m\n    \x1b[33m    """\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        args, kwargs = app_params\x1b[90m\x1b[39;49;00m\n>       app_ = make_app(*args, **kwargs)\x1b[90m\x1b[39;49;00m\n\n\x1b[1m\x1b[31msphinx/testing/fixtures.py\x1b[0m:149: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\x1b[1m\x1b[31msphinx/testing/fixtures.py\x1b[0m:195: in make\n    \x1b[0mapp_ = SphinxTestApp(*args, **kwargs)  \x1b[90m# type: Any\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31msphinx/testing/util.py\x1b[0m:133: in __init__\n    \x1b[0m\x1b[96msuper\x1b[39;49;00m().\x1b[92m__init__\x1b[39;49;00m(srcdir, confdir, outdir, doctreedir,\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31msphinx/application.py\x1b[0m:245: in __init__\n    \x1b[0m\x1b[96mself\x1b[39;49;00m.setup_extension(extension)\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31msphinx/application.py\x1b[0m:402: in setup_extension\n    \x1b[0m\x1b[96mself\x1b[39;49;00m.registry.load_extension(\x1b[96mself\x1b[39;49;00m, extname)\x1b[90m\x1b[39;49;00m\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <sphinx.registry.SphinxComponentRegistry object at 0x7452173cd8c0>\napp = <[AttributeError("\'NoneType\' object has no attribute \'name\'") raised in repr()] SphinxTestApp object at 0x7452167acb40>\nextname = \'sphinx.ext.viewcode\'\n\n    \x1b[0m\x1b[94mdef\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[92mload_extension\x1b[39;49;00m(\x1b[96mself\x1b[39;49;00m, app: \x1b[33m"\x1b[39;49;00m\x1b[33mSphinx\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m, extname: \x1b[96mstr\x1b[39;49;00m) -> \x1b[94mNone\x1b[39;49;00m:\x1b[90m\x1b[39;49;00m\n    \x1b[90m    \x1b[39;49;00m\x1b[33m"""Load a Sphinx extension."""\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94mif\x1b[39;49;00m extname \x1b[95min\x1b[39;49;00m app.extensions:  \x1b[90m# already loaded\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n            \x1b[94mreturn\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94mif\x1b[39;49;00m extname \x1b[95min\x1b[39;49;00m EXTENSION_BLACKLIST:\x1b[90m\x1b[39;49;00m\n            logger.warning(__(\x1b[33m\'\x1b[39;49;00m\x1b[33mthe extension \x1b[39;49;00m\x1b[33m%r\x1b[39;49;00m\x1b[33m was already merged with Sphinx since \x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                              \x1b[33m\'\x1b[39;49;00m\x1b[33mversion \x1b[39;49;00m\x1b[33m%s\x1b[39;49;00m\x1b[33m; this extension is ignored.\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m),\x1b[90m\x1b[39;49;00m\n                           extname, EXTENSION_BLACKLIST[extname])\x1b[90m\x1b[39;49;00m\n            \x1b[94mreturn\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        \x1b[90m# update loading context\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        prefix = __(\x1b[33m\'\x1b[39;49;00m\x1b[33mwhile setting up extension \x1b[39;49;00m\x1b[33m%s\x1b[39;49;00m\x1b[33m:\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) % extname\x1b[90m\x1b[39;49;00m\n        \x1b[94mwith\x1b[39;49;00m prefixed_warnings(prefix):\x1b[90m\x1b[39;49;00m\n            \x1b[94mtry\x1b[39;49;00m:\x1b[90m\x1b[39;49;00m\n                mod = import_module(extname)\x1b[90m\x1b[39;49;00m\n            \x1b[94mexcept\x1b[39;49;00m \x1b[96mImportError\x1b[39;49;00m \x1b[94mas\x1b[39;49;00m err:\x1b[90m\x1b[39;49;00m\n                logger.verbose(__(\x1b[33m\'\x1b[39;49;00m\x1b[33mOriginal exception:\x1b[39;49;00m\x1b[33m\\n\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) + traceback.format_exc())\x1b[90m\x1b[39;49;00m\n>               \x1b[94mraise\x1b[39;49;00m ExtensionError(__(\x1b[33m\'\x1b[39;49;00m\x1b[33mCould not import extension \x1b[39;49;00m\x1b[33m%s\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) % extname,\x1b[90m\x1b[39;49;00m\n                                     err) \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96merr\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31mE               sphinx.errors.ExtensionError: Could not import extension sphinx.ext.viewcode (exception: No module named \'sphinx.builders.epub\')\x1b[0m\n\n\x1b[1m\x1b[31msphinx/registry.py\x1b[0m:420: ExtensionError\n\x1b[31m\x1b[1m__________________ ERROR at setup of test_local_source_files ___________________\x1b[0m\n\nself = <sphinx.registry.SphinxComponentRegistry object at 0x745216641320>\napp = <[AttributeError("\'NoneType\' object has no attribute \'name\'") raised in repr()] SphinxTestApp object at 0x745216641230>\nextname = \'sphinx.ext.viewcode\'\n\n    \x1b[0m\x1b[94mdef\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[92mload_extension\x1b[39;49;00m(\x1b[96mself\x1b[39;49;00m, app: \x1b[33m"\x1b[39;49;00m\x1b[33mSphinx\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m, extname: \x1b[96mstr\x1b[39;49;00m) -> \x1b[94mNone\x1b[39;49;00m:\x1b[90m\x1b[39;49;00m\n    \x1b[90m    \x1b[39;49;00m\x1b[33m"""Load a Sphinx extension."""\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94mif\x1b[39;49;00m extname \x1b[95min\x1b[39;49;00m app.extensions:  \x1b[90m# already loaded\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n            \x1b[94mreturn\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94mif\x1b[39;49;00m extname \x1b[95min\x1b[39;49;00m EXTENSION_BLACKLIST:\x1b[90m\x1b[39;49;00m\n            logger.warning(__(\x1b[33m\'\x1b[39;49;00m\x1b[33mthe extension \x1b[39;49;00m\x1b[33m%r\x1b[39;49;00m\x1b[33m was already merged with Sphinx since \x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                              \x1b[33m\'\x1b[39;49;00m\x1b[33mversion \x1b[39;49;00m\x1b[33m%s\x1b[39;49;00m\x1b[33m; this extension is ignored.\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m),\x1b[90m\x1b[39;49;00m\n                           extname, EXTENSION_BLACKLIST[extname])\x1b[90m\x1b[39;49;00m\n            \x1b[94mreturn\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        \x1b[90m# update loading context\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        prefix = __(\x1b[33m\'\x1b[39;49;00m\x1b[33mwhile setting up extension \x1b[39;49;00m\x1b[33m%s\x1b[39;49;00m\x1b[33m:\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) % extname\x1b[90m\x1b[39;49;00m\n        \x1b[94mwith\x1b[39;49;00m prefixed_warnings(prefix):\x1b[90m\x1b[39;49;00m\n            \x1b[94mtry\x1b[39;49;00m:\x1b[90m\x1b[39;49;00m\n>               mod = import_module(extname)\x1b[90m\x1b[39;49;00m\n\n\x1b[1m\x1b[31msphinx/registry.py\x1b[0m:417: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\x1b[1m\x1b[31m/opt/miniconda3/envs/testbed/lib/python3.9/importlib/__init__.py\x1b[0m:127: in import_module\n    \x1b[0m\x1b[94mreturn\x1b[39;49;00m _bootstrap._gcd_import(name[level:], package, level)\x1b[90m\x1b[39;49;00m\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\n    \x1b[0m\x1b[33m"""\x1b[39;49;00m\n    \x1b[33m    sphinx.ext.viewcode\x1b[39;49;00m\n    \x1b[33m    ~~~~~~~~~~~~~~~~~~~\x1b[39;49;00m\n    \x1b[33m\x1b[39;49;00m\n    \x1b[33m    Add links to module code in Python object descriptions.\x1b[39;49;00m\n    \x1b[33m\x1b[39;49;00m\n    \x1b[33m    :copyright: Copyright 2007-2021 by the Sphinx team, see AUTHORS.\x1b[39;49;00m\n    \x1b[33m    :license: BSD, see LICENSE for details.\x1b[39;49;00m\n    \x1b[33m"""\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n    \x1b[94mimport\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mos\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[94mimport\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mposixpath\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[94mimport\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mtraceback\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mos\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m path\x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mtyping\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m Any, Dict, Generator, Iterable, Optional, Set, Tuple, cast\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mdocutils\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m nodes\x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mdocutils\x1b[39;49;00m\x1b[04m\x1b[96m.\x1b[39;49;00m\x1b[04m\x1b[96mnodes\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m Element, Node\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n    \x1b[94mimport\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96msphinx\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96msphinx\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m addnodes\x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96msphinx\x1b[39;49;00m\x1b[04m\x1b[96m.\x1b[39;49;00m\x1b[04m\x1b[96mapplication\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m Sphinx\x1b[90m\x1b[39;49;00m\n>   \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96msphinx\x1b[39;49;00m\x1b[04m\x1b[96m.\x1b[39;49;00m\x1b[04m\x1b[96mbuilders\x1b[39;49;00m\x1b[04m\x1b[96m.\x1b[39;49;00m\x1b[04m\x1b[96mepub\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m EpubBuilder\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31mE   ModuleNotFoundError: No module named \'sphinx.builders.epub\'\x1b[0m\n\n\x1b[1m\x1b[31msphinx/ext/viewcode.py\x1b[0m:23: ModuleNotFoundError\n\n\x1b[33mThe above exception was the direct cause of the following exception:\x1b[0m\n\ntest_params = {\'shared_result\': None}\napp_params = app_params(args=[], kwargs={\'srcdir\': path(\'/tmp/pytest-of-root/pytest-5/ext-viewcode-find\')})\nmake_app = <function make_app.<locals>.make at 0x7452160eec30>\nshared_result = <sphinx.testing.fixtures.SharedResult object at 0x7452160c43c0>\n\n    \x1b[0m\x1b[37m@pytest\x1b[39;49;00m.fixture(scope=\x1b[33m\'\x1b[39;49;00m\x1b[33mfunction\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m)\x1b[90m\x1b[39;49;00m\n    \x1b[94mdef\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[92mapp\x1b[39;49;00m(test_params: Dict, app_params: Tuple[Dict, Dict], make_app: Callable,\x1b[90m\x1b[39;49;00m\n            shared_result: SharedResult) -> Generator[SphinxTestApp, \x1b[94mNone\x1b[39;49;00m, \x1b[94mNone\x1b[39;49;00m]:\x1b[90m\x1b[39;49;00m\n    \x1b[90m    \x1b[39;49;00m\x1b[33m"""\x1b[39;49;00m\n    \x1b[33m    provides sphinx.application.Sphinx object\x1b[39;49;00m\n    \x1b[33m    """\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        args, kwargs = app_params\x1b[90m\x1b[39;49;00m\n>       app_ = make_app(*args, **kwargs)\x1b[90m\x1b[39;49;00m\n\n\x1b[1m\x1b[31msphinx/testing/fixtures.py\x1b[0m:149: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\x1b[1m\x1b[31msphinx/testing/fixtures.py\x1b[0m:195: in make\n    \x1b[0mapp_ = SphinxTestApp(*args, **kwargs)  \x1b[90m# type: Any\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31msphinx/testing/util.py\x1b[0m:133: in __init__\n    \x1b[0m\x1b[96msuper\x1b[39;49;00m().\x1b[92m__init__\x1b[39;49;00m(srcdir, confdir, outdir, doctreedir,\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31msphinx/application.py\x1b[0m:245: in __init__\n    \x1b[0m\x1b[96mself\x1b[39;49;00m.setup_extension(extension)\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31msphinx/application.py\x1b[0m:402: in setup_extension\n    \x1b[0m\x1b[96mself\x1b[39;49;00m.registry.load_extension(\x1b[96mself\x1b[39;49;00m, extname)\x1b[90m\x1b[39;49;00m\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <sphinx.registry.SphinxComponentRegistry object at 0x745216641320>\napp = <[AttributeError("\'NoneType\' object has no attribute \'name\'") raised in repr()] SphinxTestApp object at 0x745216641230>\nextname = \'sphinx.ext.viewcode\'\n\n    \x1b[0m\x1b[94mdef\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[92mload_extension\x1b[39;49;00m(\x1b[96mself\x1b[39;49;00m, app: \x1b[33m"\x1b[39;49;00m\x1b[33mSphinx\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m, extname: \x1b[96mstr\x1b[39;49;00m) -> \x1b[94mNone\x1b[39;49;00m:\x1b[90m\x1b[39;49;00m\n    \x1b[90m    \x1b[39;49;00m\x1b[33m"""Load a Sphinx extension."""\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94mif\x1b[39;49;00m extname \x1b[95min\x1b[39;49;00m app.extensions:  \x1b[90m# already loaded\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n            \x1b[94mreturn\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94mif\x1b[39;49;00m extname \x1b[95min\x1b[39;49;00m EXTENSION_BLACKLIST:\x1b[90m\x1b[39;49;00m\n            logger.warning(__(\x1b[33m\'\x1b[39;49;00m\x1b[33mthe extension \x1b[39;49;00m\x1b[33m%r\x1b[39;49;00m\x1b[33m was already merged with Sphinx since \x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                              \x1b[33m\'\x1b[39;49;00m\x1b[33mversion \x1b[39;49;00m\x1b[33m%s\x1b[39;49;00m\x1b[33m; this extension is ignored.\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m),\x1b[90m\x1b[39;49;00m\n                           extname, EXTENSION_BLACKLIST[extname])\x1b[90m\x1b[39;49;00m\n            \x1b[94mreturn\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        \x1b[90m# update loading context\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        prefix = __(\x1b[33m\'\x1b[39;49;00m\x1b[33mwhile setting up extension \x1b[39;49;00m\x1b[33m%s\x1b[39;49;00m\x1b[33m:\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) % extname\x1b[90m\x1b[39;49;00m\n        \x1b[94mwith\x1b[39;49;00m prefixed_warnings(prefix):\x1b[90m\x1b[39;49;00m\n            \x1b[94mtry\x1b[39;49;00m:\x1b[90m\x1b[39;49;00m\n                mod = import_module(extname)\x1b[90m\x1b[39;49;00m\n            \x1b[94mexcept\x1b[39;49;00m \x1b[96mImportError\x1b[39;49;00m \x1b[94mas\x1b[39;49;00m err:\x1b[90m\x1b[39;49;00m\n                logger.verbose(__(\x1b[33m\'\x1b[39;49;00m\x1b[33mOriginal exception:\x1b[39;49;00m\x1b[33m\\n\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) + traceback.format_exc())\x1b[90m\x1b[39;49;00m\n>               \x1b[94mraise\x1b[39;49;00m ExtensionError(__(\x1b[33m\'\x1b[39;49;00m\x1b[33mCould not import extension \x1b[39;49;00m\x1b[33m%s\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) % extname,\x1b[90m\x1b[39;49;00m\n                                     err) \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96merr\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31mE               sphinx.errors.ExtensionError: Could not import extension sphinx.ext.viewcode (exception: No module named \'sphinx.builders.epub\')\x1b[0m\n\n\x1b[1m\x1b[31msphinx/registry.py\x1b[0m:420: ExtensionError\n\x1b[33m=============================== warnings summary ===============================\x1b[0m\nsphinx/util/docutils.py:45\n  /testbed/sphinx/util/docutils.py:45: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.\n    __version_info__ = tuple(LooseVersion(docutils.__version__).version)\n\nsphinx/registry.py:22\n  /testbed/sphinx/registry.py:22: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n    from pkg_resources import iter_entry_points\n\n../opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pkg_resources/__init__.py:3142\n../opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pkg_resources/__init__.py:3142\n../opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pkg_resources/__init__.py:3142\n../opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pkg_resources/__init__.py:3142\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pkg_resources/__init__.py:3142: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace(\'sphinxcontrib\')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n    declare_namespace(pkg)\n\nsphinx/directives/patches.py:14\n  /testbed/sphinx/directives/patches.py:14: DeprecationWarning: The `docutils.parsers.rst.directive.html` module will be removed in Docutils 2.0. Since Docutils 0.18, the "Meta" node is defined in `docutils.parsers.rst.directives.misc`.\n    from docutils.parsers.rst.directives import html, images, tables\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/__init__.py:210: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse():  # type: Node\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/i18n.py:95: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.translatable):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/__init__.py:110: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for ref in self.document.traverse(nodes.substitution_reference):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/__init__.py:131: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.target):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/__init__.py:150: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.block_quote):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/__init__.py:175: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.Element):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/__init__.py:222: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.index):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/__init__.py:189: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.section):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/__init__.py:279: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.doctest_block):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/domains/citation.py:116: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.citation):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/domains/citation.py:135: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.citation_reference):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/builders/latex/transforms.py:36: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(matcher):  # type: nodes.Element\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/__init__.py:291: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(matcher):  # type: Element\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/util/compat.py:44: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.index):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/domains/index.py:51: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in document.traverse(addnodes.index):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/domains/math.py:84: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    self.data[\'has_equations\'][docname] = any(document.traverse(math_node))\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/environment/collectors/asset.py:46: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in doctree.traverse(nodes.image):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/environment/collectors/asset.py:127: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in doctree.traverse(addnodes.download_reference):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/environment/collectors/title.py:46: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in doctree.traverse(nodes.section):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/ext/linkcode.py:42: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for objnode in doctree.traverse(addnodes.desc):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/__init__.py:301: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.system_message):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/__init__.py:390: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.manpage):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/i18n.py:488: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for inline in self.document.traverse(matcher):  # type: nodes.inline\n\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/domains/python.py:283: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in result.traverse(nodes.Text):\n\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/builders/html/__init__.py:422: DeprecationWarning: The frontend.OptionParser class will be replaced by a subclass of argparse.ArgumentParser in Docutils 0.21 or later.\n    self.docsettings = OptionParser(\n\ntests/test_ext_viewcode.py: 72 warnings\n  /opt/miniconda3/envs/testbed/lib/python3.9/optparse.py:1000: DeprecationWarning: The frontend.Option class will be removed in Docutils 0.21 or later.\n    option = self.option_class(*args, **kwargs)\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/domains/c.py:3494: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(AliasNode):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/domains/cpp.py:7070: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(AliasNode):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/post_transforms/__init__.py:69: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.pending_xref):\n\ntests/test_ext_viewcode.py: 10 warnings\n  /testbed/sphinx/util/nodes.py:598: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in document.traverse(addnodes.only):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/post_transforms/images.py:33: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.image):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/post_transforms/__init__.py:216: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.desc_sig_element):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/builders/latex/transforms.py:48: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.substitution_definition):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/builders/html/transforms.py:44: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(matcher):  # type: nodes.literal\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/builders/latex/transforms.py:606: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.title):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/builders/latex/transforms.py:608: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for i, index in enumerate(node.traverse(addnodes.index)):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/post_transforms/code.py:43: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.highlightlang):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/post_transforms/code.py:95: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for lbnode in self.document.traverse(nodes.literal_block):  # type: nodes.literal_block\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/post_transforms/code.py:99: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for dbnode in self.document.traverse(nodes.doctest_block):  # type: nodes.doctest_block\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/environment/__init__.py:541: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for toctreenode in doctree.traverse(addnodes.toctree):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/environment/adapters/toctree.py:203: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for subtocnode in toc.traverse(addnodes.toctree):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/environment/adapters/toctree.py:261: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for refnode in newnode.traverse(nodes.reference):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/builders/__init__.py:181: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in doctree.traverse(nodes.image):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/builders/html/__init__.py:844: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in doctree.traverse(nodes.image):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/environment/adapters/toctree.py:312: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in toc.traverse(nodes.reference):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/alabaster/layout.html:114: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n    _gaq.push([\'_setAllowLinker\', true]);\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/alabaster/about.html:70: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/alabaster/about.html:99: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/environment/adapters/toctree.py:328: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for toctreenode in doctree.traverse(addnodes.toctree):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/alabaster/layout.html:215: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/alabaster/layout.html:238: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py::test_linkcode\n  <template>:33: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py::test_linkcode\n  <template>:224: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py::test_linkcode\n  <template>:386: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py::test_linkcode\n  <template>:401: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/util/nodes.py:350: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for img in node.traverse(nodes.image):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/util/nodes.py:352: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for raw in node.traverse(nodes.raw):\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n==================================== PASSES ====================================\n--------------------------- Captured stdout teardown ---------------------------\n# testroot: root\n# builder: html\n# srcdir: /tmp/pytest-of-root/pytest-5/ext-viewcode\n# outdir: /tmp/pytest-of-root/pytest-5/ext-viewcode/_build/html\n# status: \n\x1b[01mRunning Sphinx v3.5.0+/82ef497a8\x1b[39;49;00m\n\x1b[01mupdating environment: \x1b[39;49;00m[new config] 2 added, 0 changed, 0 removed\n\x1b[01mreading sources... \x1b[39;49;00m[ 50%] \x1b[35mindex\x1b[39;49;00m                                                \r\x1b[01mreading sources... \x1b[39;49;00m[100%] \x1b[35mobjects\x1b[39;49;00m                                              \r\n\x1b[01mlooking for now-outdated files... \x1b[39;49;00mnone found\n\x1b[01mpickling environment... \x1b[39;49;00mdone\n\x1b[01mchecking consistency... \x1b[39;49;00mdone\n\x1b[01mpreparing documents... \x1b[39;49;00mdone\n\x1b[01mwriting output... \x1b[39;49;00m[ 50%] \x1b[32mindex\x1b[39;49;00m                                                 \r\x1b[01mwriting output... \x1b[39;49;00m[100%] \x1b[32mobjects\x1b[39;49;00m                                               \r\n\x1b[01mgenerating indices... \x1b[39;49;00mgenindex py-modindex done\n\x1b[01mwriting additional pages... \x1b[39;49;00msearch done\n\x1b[01mcopying static files... \x1b[39;49;00mdone\n\x1b[01mcopying extra files... \x1b[39;49;00mdone\n\x1b[01mdumping search index in English (code: en)... \x1b[39;49;00mdone\n\x1b[01mdumping object inventory... \x1b[39;49;00mdone\n\n# warning: \n\x1b[91mWARNING: while setting up extension sphinx.addnodes: node class \'meta\' is already registered, its visitors will be overridden\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-5/ext-viewcode/index.rst:23: WARNING: Object named \'func1\' not found in include file \'/tmp/pytest-of-root/pytest-5/ext-viewcode/spam/__init__.py\'\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-5/ext-viewcode/spam/mod1.py:docstring of spam.mod1.Class3:1: WARNING: duplicate object description of spam.mod3.Class3, other instance in index, use :noindex: for one of them\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-5/ext-viewcode/spam/mod1.py:docstring of spam.mod3.Class3.class_attr:1: WARNING: duplicate object description of spam.mod3.Class3.class_attr, other instance in index, use :noindex: for one of them\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-5/ext-viewcode/objects.rst:84: WARNING: Error in declarator\nIf declarator-id with parameters (e.g., \'void f(int arg)\'):\n  Invalid C declaration: Expected identifier in nested name. [error at 18]\n    Sphinx_DoSomething()\n    ------------------^\nIf parenthesis in noptr-declarator (e.g., \'void (*f(int arg))(double)\'):\n  Error in declarator or parameters\n  Invalid C declaration: Expected identifier in nested name. [error at 19]\n    Sphinx_DoSomething()\n    -------------------^\n\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-5/ext-viewcode/objects.rst:86: WARNING: Error in declarator or parameters\nInvalid C declaration: Expected identifier in nested name. [error at 19]\n  SphinxStruct.member\n  -------------------^\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-5/ext-viewcode/objects.rst:92: WARNING: Error in declarator or parameters\nInvalid C declaration: Expected identifier in nested name. [error at 13]\n  sphinx_global\n  -------------^\x1b[39;49;00m\n\x1b[31m/tmp/pytest-of-root/pytest-5/ext-viewcode/objects.rst:155: WARNING: Unknown directive type "userdesc".\n\n.. userdesc:: myobj:parameter\n\n   Description of userdesc.\x1b[39;49;00m\n\x1b[31m/tmp/pytest-of-root/pytest-5/ext-viewcode/objects.rst:160: WARNING: Unknown interpreted text role "userdescrole".\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-5/ext-viewcode/objects.rst:166: WARNING: Too many template argument lists compared to parameter lists. Argument lists: 1, Parameter lists: 0, Extra empty parameters lists prepended: 1. Declaration:\n\tn::Array<T, d>\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-5/ext-viewcode/objects.rst:117: WARNING: Unparseable C cross-reference: \'SphinxType *\'\nInvalid C declaration: Expected end of definition. [error at 11]\n  SphinxType *\n  -----------^\x1b[39;49;00m\n\n============================= slowest 25 durations =============================\n0.33s call     tests/test_ext_viewcode.py::test_linkcode\n0.15s setup    tests/test_ext_viewcode.py::test_viewcode\n0.03s setup    tests/test_ext_viewcode.py::test_local_source_files\n0.01s setup    tests/test_ext_viewcode.py::test_linkcode\n0.01s setup    tests/test_ext_viewcode.py::test_viewcode_epub_disabled\n0.01s setup    tests/test_ext_viewcode.py::test_viewcode_epub_enabled\n\n(5 durations < 0.005s hidden.  Use -vv to show these durations.)\n\x1b[36m\x1b[1m=========================== short test summary info ============================\x1b[0m\n\x1b[32mPASSED\x1b[0m tests/test_ext_viewcode.py::\x1b[1mtest_linkcode\x1b[0m\n\x1b[31mERROR\x1b[0m tests/test_ext_viewcode.py::\x1b[1mtest_viewcode\x1b[0m - sphinx.errors.ExtensionError: Could not import extension sphinx.ext.viewcod...\n\x1b[31mERROR\x1b[0m tests/test_ext_viewcode.py::\x1b[1mtest_viewcode_epub_disabled\x1b[0m - sphinx.errors.ExtensionError: Could not import extension sphinx.ext.viewcod...\n\x1b[31mERROR\x1b[0m tests/test_ext_viewcode.py::\x1b[1mtest_viewcode_epub_enabled\x1b[0m - sphinx.errors.ExtensionError: Could not import extension sphinx.ext.viewcod...\n\x1b[31mERROR\x1b[0m tests/test_ext_viewcode.py::\x1b[1mtest_local_source_files\x1b[0m - sphinx.errors.ExtensionError: Could not import extension sphinx.ext.viewcod...\n\x1b[31m================== \x1b[32m1 passed\x1b[0m, \x1b[33m231 warnings\x1b[0m, \x1b[31m\x1b[1m4 errors\x1b[0m\x1b[31m in 0.83s\x1b[0m\x1b[31m ===================\x1b[0m\npy39: exit 1 (1.29 seconds) /testbed> python -X dev -m pytest -rA --durations 25 tests/test_ext_viewcode.py pid=550\n  py39: FAIL code 1 (1.30=setup[0.01]+cmd[1.29] seconds)\n  evaluation failed :( (1.38 seconds)'}]}, {'role': 'assistant', 'content': [{'type': 'text', 'text': "I see the problem. The version of Sphinx being used doesn't have a `sphinx.builders.epub` module. This type of checking is better performed without relying on builder-specific module imports. Let's modify our code to use a different approach:"}, {'type': 'text', 'text': '<tool_use>\n{\'tool_name\': editor, \'tool_input\': {\'command\': \'edit\', \'path\': \'/testbed/sphinx/ext/viewcode.py\', \'file_text\': \'"""\\n    sphinx.ext.viewcode\\n    ~~~~~~~~~~~~~~~~~~~\\n\\n    Add links to module code in Python object descriptions.\\n\\n    :copyright: Copyright 2007-2021 by the Sphinx team, see AUTHORS.\\n    :license: BSD, see LICENSE for details.\\n"""\\n\\nimport os\\nimport posixpath\\nimport shutil\\nimport traceback\\nfrom os import path\\nfrom typing import Any, Dict, Generator, Iterable, Optional, Set, Tuple, cast\\n\\nfrom docutils import nodes\\nfrom docutils.nodes import Element, Node\\n\\nimport sphinx\\nfrom sphinx import addnodes\\nfrom sphinx.application import Sphinx\\nfrom sphinx.builders.html import StandaloneHTMLBuilder\\nfrom sphinx.environment import BuildEnvironment\\nfrom sphinx.locale import _, __\\nfrom sphinx.pycode import ModuleAnalyzer\\nfrom sphinx.util import get_full_modname, logging, status_iterator\\nfrom sphinx.util.nodes import make_refnode\\n\\nlogger = logging.getLogger(__name__)\\n\\n\\nOUTPUT_DIRNAME = \\\'_modules\\\'\\n\\n\\ndef _get_full_modname(app: Sphinx, modname: str, attribute: str) -> Optional[str]:\\n    try:\\n        return get_full_modname(modname, attribute)\\n    except AttributeError:\\n        # sphinx.ext.viewcode can\\\'t follow class instance attribute\\n        # then AttributeError logging output only verbose mode.\\n        logger.verbose(\\\'Didn\\\\\\\'t find %s in %s\\\', attribute, modname)\\n        return None\\n    except Exception as e:\\n        # sphinx.ext.viewcode follow python domain directives.\\n        # because of that, if there are no real modules exists that specified\\n        # by py:function or other directives, viewcode emits a lot of warnings.\\n        # It should be displayed only verbose mode.\\n        logger.verbose(traceback.format_exc().rstrip())\\n        logger.verbose(\\\'viewcode can\\\\\\\'t import %s, failed with error "%s"\\\', modname, e)\\n        return None\\n\\n\\ndef should_view_code(app: Sphinx) -> bool:\\n    """Determine whether code module pages should be generated."""\\n    if not hasattr(app.builder, \\\'name\\\'):\\n        return True  # Safety fallback\\n    \\n    if app.builder.name == \\\'singlehtml\\\':\\n        return False\\n        \\n    if app.builder.name.startswith(\\\'epub\\\'):\\n        return bool(app.builder.env.config.viewcode_enable_epub)\\n        \\n    return True\\n\\n\\ndef doctree_read(app: Sphinx, doctree: Node) -> None:\\n    env = app.builder.env\\n    if not hasattr(env, \\\'_viewcode_modules\\\'):\\n        env._viewcode_modules = {}  # type: ignore\\n        \\n    if not should_view_code(app):\\n        return\\n    \\n    def has_tag(modname: str, fullname: str, docname: str, refname: str) -> bool:\\n        entry = env._viewcode_modules.get(modname, None)  # type: ignore\\n        if entry is False:\\n            return False\\n\\n        code_tags = app.emit_firstresult(\\\'viewcode-find-source\\\', modname)\\n        if code_tags is None:\\n            try:\\n                analyzer = ModuleAnalyzer.for_module(modname)\\n                analyzer.find_tags()\\n            except Exception:\\n                env._viewcode_modules[modname] = False  # type: ignore\\n                return False\\n\\n            code = analyzer.code\\n            tags = analyzer.tags\\n        else:\\n            code, tags = code_tags\\n\\n        if entry is None or entry[0] != code:\\n            entry = code, tags, {}, refname\\n            env._viewcode_modules[modname] = entry  # type: ignore\\n        _, tags, used, _ = entry\\n        if fullname in tags:\\n            used[fullname] = docname\\n            return True\\n\\n        return False\\n\\n    for objnode in doctree.traverse(addnodes.desc):\\n        if objnode.get(\\\'domain\\\') != \\\'py\\\':\\n            continue\\n        names = set()  # type: Set[str]\\n        for signode in objnode:\\n            if not isinstance(signode, addnodes.desc_signature):\\n                continue\\n            modname = signode.get(\\\'module\\\')\\n            fullname = signode.get(\\\'fullname\\\')\\n            refname = modname\\n            if env.config.viewcode_follow_imported_members:\\n                new_modname = app.emit_firstresult(\\n                    \\\'viewcode-follow-imported\\\', modname, fullname,\\n                )\\n                if not new_modname:\\n                    new_modname = _get_full_modname(app, modname, fullname)\\n                modname = new_modname\\n            if not modname:\\n                continue\\n            fullname = signode.get(\\\'fullname\\\')\\n            if not has_tag(modname, fullname, env.docname, refname):\\n                continue\\n            if fullname in names:\\n                # only one link per name, please\\n                continue\\n            names.add(fullname)\\n            pagename = posixpath.join(OUTPUT_DIRNAME, modname.replace(\\\'.\\\', \\\'/\\\'))\\n            inline = nodes.inline(\\\'\\\', _(\\\'[source]\\\'), classes=[\\\'viewcode-link\\\'])\\n            onlynode = addnodes.only(expr=\\\'html\\\')\\n            onlynode += addnodes.pending_xref(\\\'\\\', inline, reftype=\\\'viewcode\\\', refdomain=\\\'std\\\',\\n                                          refexplicit=False, reftarget=pagename,\\n                                          refid=fullname, refdoc=env.docname)\\n            signode += onlynode\\n\\n\\ndef env_merge_info(app: Sphinx, env: BuildEnvironment, docnames: Iterable[str],\\n                   other: BuildEnvironment) -> None:\\n    if not hasattr(other, \\\'_viewcode_modules\\\'):\\n        return\\n    # create a _viewcode_modules dict on the main environment\\n    if not hasattr(env, \\\'_viewcode_modules\\\'):\\n        env._viewcode_modules = {}  # type: ignore\\n    # now merge in the information from the subprocess\\n    env._viewcode_modules.update(other._viewcode_modules)  # type: ignore\\n\\n\\ndef missing_reference(app: Sphinx, env: BuildEnvironment, node: Element, contnode: Node\\n                      ) -> Optional[Node]:\\n    # resolve our "viewcode" reference nodes -- they need special treatment\\n    if node[\\\'reftype\\\'] == \\\'viewcode\\\':\\n        return make_refnode(app.builder, node[\\\'refdoc\\\'], node[\\\'reftarget\\\'],\\n                            node[\\\'refid\\\'], contnode)\\n\\n    return None\\n\\n\\ndef get_module_filename(app: Sphinx, modname: str) -> Optional[str]:\\n    """Get module filename for *modname*."""\\n    source_info = app.emit_firstresult(\\\'viewcode-find-source\\\', modname)\\n    if source_info:\\n        return None\\n    else:\\n        try:\\n            filename, source = ModuleAnalyzer.get_module_source(modname)\\n            return filename\\n        except Exception:\\n            return None\\n\\n\\ndef collect_pages(app: Sphinx) -> Generator[Tuple[str, Dict[str, Any], str], None, None]:\\n    if not should_view_code(app):\\n        return\\n\\n    env = app.builder.env\\n    if not hasattr(env, \\\'_viewcode_modules\\\'):\\n        return\\n\\n    highlighter = app.builder.highlighter  # type: ignore\\n    urito = app.builder.get_relative_uri\\n    modnames = set(env._viewcode_modules)  # type: ignore\\n\\n    for modname, entry in status_iterator(\\n            sorted(env._viewcode_modules.items()),  # type: ignore\\n            __(\\\'highlighting module code... \\\'), "blue",\\n            len(env._viewcode_modules),  # type: ignore\\n            app.verbosity, lambda x: x[0]):\\n        if not entry:\\n            continue\\n\\n        code, tags, used, refname = entry\\n        pagename = posixpath.join(OUTPUT_DIRNAME, modname.replace(\\\'.\\\', \\\'/\\\'))\\n        if env.config.highlight_language in (\\\'python3\\\', \\\'default\\\', \\\'none\\\'):\\n            lexer = env.config.highlight_language\\n        else:\\n            lexer = \\\'python\\\'\\n        highlighted = highlighter.highlight_block(code, lexer, linenos=False)\\n        lines = highlighted.splitlines()\\n        before, after = lines[0].split(\\\'<pre>\\\')\\n        lines[0:1] = [before + \\\'<pre>\\\', after]\\n\\n        maxindex = len(lines) - 1\\n        for name, docname in used.items():\\n            type, start, end = tags[name]\\n            backlink = urito(pagename, docname) + \\\'#\\\' + refname + \\\'.\\\' + name\\n            lines[start] = (\\n                \\\'<div class="viewcode-block" id="%s"><a class="viewcode-back" \\\'\\n                \\\'href="%s">%s</a>\\\' % (name, backlink, _(\\\'[docs]\\\')) +\\n                lines[start])\\n            lines[min(end, maxindex)] += \\\'</div>\\\'\\n\\n        parents = []\\n        parent = modname\\n        while \\\'.\\\' in parent:\\n            parent = parent.rsplit(\\\'.\\\', 1)[0]\\n            if parent in modnames:\\n                parents.append({\\n                    \\\'link\\\': urito(pagename,\\n                                  posixpath.join(OUTPUT_DIRNAME, parent.replace(\\\'.\\\', \\\'/\\\'))),\\n                    \\\'title\\\': parent})\\n        parents.append({\\\'link\\\': urito(pagename, posixpath.join(OUTPUT_DIRNAME, \\\'index\\\')),\\n                        \\\'title\\\': _(\\\'Module code\\\')})\\n        parents.reverse()\\n\\n        context = {\\n            \\\'parents\\\': parents,\\n            \\\'title\\\': modname,\\n            \\\'body\\\': (_(\\\'<h1>Source code for %s</h1>\\\') % modname +\\n                     \\\'\\\\n\\\'.join(lines)),\\n        }\\n        yield (pagename, context, \\\'page.html\\\')\\n\\n    if not modnames:\\n        return\\n\\n    html = [\\\'\\\\n\\\']\\n    stack = [\\\'\\\']\\n    for modname in sorted(modnames):\\n        if modname.startswith(stack[-1]):\\n            stack.append(modname + \\\'.\\\')\\n            html.append(\\\'<ul>\\\')\\n        else:\\n            stack.pop()\\n            stack.append(modname + \\\'.\\\')\\n            html.append(\\\'</ul>\\\' * (len(stack) - 1) + \\\'<ul>\\\')\\n        if modname in env._viewcode_modules and env._viewcode_modules[modname]:  # type: ignore\\n            pagename = posixpath.join(OUTPUT_DIRNAME, modname.replace(\\\'.\\\', \\\'/\\\'))\\n            html.append(\\\'<li><a href="%s">%s</a></li>\\\\n\\\' % (\\n                urito(OUTPUT_DIRNAME + \\\'/index\\\', pagename), modname))\\n\\n    if html == [\\\'\\\\n\\\']:  # no documented Python objects\\n        return\\n\\n    html.append(\\\'</ul>\\\' * len(stack))\\n    context = {\\n        \\\'title\\\': _(\\\'Overview: module code\\\'),\\n        \\\'body\\\': (_(\\\'<h1>All modules for which code is available</h1>\\\') +\\n                 \\\'\\\'.join(html)),\\n    }\\n\\n    yield (posixpath.join(OUTPUT_DIRNAME, \\\'index\\\'), context, \\\'page.html\\\')\\n\\n\\ndef builder_inited(app: Sphinx) -> None:\\n    env = app.builder.env\\n    if not hasattr(app.builder, \\\'outdir\\\'):\\n        return\\n        \\n    modules_dir = path.join(app.builder.outdir, OUTPUT_DIRNAME)\\n    \\n    if not should_view_code(app):\\n        # Remove the _modules directory if it exists\\n        if path.exists(modules_dir):\\n            shutil.rmtree(modules_dir)\\n        return\\n\\n    # Create the _modules directory\\n    if not path.exists(modules_dir):\\n        os.makedirs(modules_dir)\\n\\n\\ndef setup(app: Sphinx) -> Dict[str, Any]:\\n    app.add_config_value(\\\'viewcode_enable_epub\\\', False, False)\\n    app.add_config_value(\\\'viewcode_follow_imported_members\\\', True, False)\\n    app.add_event(\\\'viewcode-find-source\\\')\\n    app.add_event(\\\'viewcode-follow-imported\\\')\\n    app.connect(\\\'builder-inited\\\', builder_inited)\\n    app.connect(\\\'doctree-read\\\', doctree_read)\\n    app.connect(\\\'env-merge-info\\\', env_merge_info)\\n    app.connect(\\\'html-collect-pages\\\', collect_pages)\\n    app.connect(\\\'missing-reference\\\', missing_reference)\\n\\n    return {\\n        \\\'version\\\': sphinx.__display_version__,\\n        \\\'parallel_read_safe\\\': True\\n    }\'}}\n</tool_use>'}]}, {'role': 'user', 'content': [{'type': 'text', 'text': 'Tool Result: File at /testbed/sphinx/ext/viewcode.py has been overwritten with new content.'}]}, {'role': 'assistant', 'content': [{'type': 'text', 'text': "Let's run the tests again:"}, {'type': 'text', 'text': "<tool_use>\n{'tool_name': bash, 'tool_input': {'command': 'cd /testbed/ && tox --current-env -epy39 -v -- tests/test_ext_viewcode.py'}}\n</tool_use>"}]}, {'role': 'user', 'content': [{'type': 'text', 'text': 'Tool Result: py39: commands[0]> python -X dev -m pytest -rA --durations 25 tests/test_ext_viewcode.py\n\x1b[1m============================= test session starts ==============================\x1b[0m\nplatform linux -- Python 3.9.21, pytest-8.3.4, pluggy-1.5.0\ncachedir: .tox/py39/.pytest_cache\nlibraries: Sphinx-3.5.0+/82ef497a8, docutils-0.21.2\nbase tempdir: /tmp/pytest-of-root/pytest-6\nrootdir: /testbed\nconfigfile: setup.cfg\nplugins: cov-6.0.0\ncollected 5 items\n\ntests/test_ext_viewcode.py \x1b[31mF\x1b[0m\x1b[31mF\x1b[0m\x1b[32m.\x1b[0m\x1b[32m.\x1b[0m\x1b[32m.\x1b[0m\x1b[31m                                         [100%]\x1b[0m\n\n=================================== FAILURES ===================================\n\x1b[31m\x1b[1m________________________________ test_viewcode _________________________________\x1b[0m\n\napp = <SphinxTestApp buildername=\'html\'>\nstatus = <_io.StringIO object at 0x7154984720f0>\nwarning = <_io.StringIO object at 0x715498472190>\n\n    \x1b[0m\x1b[37m@pytest\x1b[39;49;00m.mark.sphinx(testroot=\x1b[33m\'\x1b[39;49;00m\x1b[33mext-viewcode\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m)\x1b[90m\x1b[39;49;00m\n    \x1b[94mdef\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[92mtest_viewcode\x1b[39;49;00m(app, status, warning):\x1b[90m\x1b[39;49;00m\n        app.builder.build_all()\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        warnings = re.sub(\x1b[33mr\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[33m\\\\\x1b[39;49;00m\x1b[33m+\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m, \x1b[33m\'\x1b[39;49;00m\x1b[33m/\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m, warning.getvalue())\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m re.findall(\x1b[90m\x1b[39;49;00m\n            \x1b[33mr\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33mindex.rst:\x1b[39;49;00m\x1b[33m\\\x1b[39;49;00m\x1b[33md+: WARNING: Object named \x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[33mfunc1\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[33m not found in include \x1b[39;49;00m\x1b[33m"\x1b[39;49;00m +\x1b[90m\x1b[39;49;00m\n            \x1b[33mr\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33mfile .*/spam/__init__.py\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m,\x1b[90m\x1b[39;49;00m\n            warnings\x1b[90m\x1b[39;49;00m\n        )\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        result = (app.outdir / \x1b[33m\'\x1b[39;49;00m\x1b[33mindex.html\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m).read_text()\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m result.count(\x1b[33m\'\x1b[39;49;00m\x1b[33mhref=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m_modules/spam/mod1.html#func1\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) == \x1b[94m2\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m result.count(\x1b[33m\'\x1b[39;49;00m\x1b[33mhref=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m_modules/spam/mod2.html#func2\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) == \x1b[94m2\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m result.count(\x1b[33m\'\x1b[39;49;00m\x1b[33mhref=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m_modules/spam/mod1.html#Class1\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) == \x1b[94m2\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m result.count(\x1b[33m\'\x1b[39;49;00m\x1b[33mhref=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m_modules/spam/mod2.html#Class2\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) == \x1b[94m2\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m result.count(\x1b[33m\'\x1b[39;49;00m\x1b[33m@decorator\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) == \x1b[94m1\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        \x1b[90m# test that the class attribute is correctly documented\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m result.count(\x1b[33m\'\x1b[39;49;00m\x1b[33mthis is Class3\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) == \x1b[94m2\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m \x1b[33m\'\x1b[39;49;00m\x1b[33mthis is the class attribute class_attr\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m \x1b[95min\x1b[39;49;00m result\x1b[90m\x1b[39;49;00m\n        \x1b[90m# the next assert fails, until the autodoc bug gets fixed\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m result.count(\x1b[33m\'\x1b[39;49;00m\x1b[33mthis is the class attribute class_attr\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) == \x1b[94m2\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        result = (app.outdir / \x1b[33m\'\x1b[39;49;00m\x1b[33m_modules/spam/mod1.html\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m).read_text()\x1b[90m\x1b[39;49;00m\n        result = re.sub(\x1b[33m\'\x1b[39;49;00m\x1b[33m<span class=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m.*?\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m>\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m, \x1b[33m\'\x1b[39;49;00m\x1b[33m<span>\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m, result)  \x1b[90m# filter pygments classes\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n>       \x1b[94massert\x1b[39;49;00m (\x1b[33m\'\x1b[39;49;00m\x1b[33m<div class=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33mviewcode-block\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m id=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33mClass1\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m><a class=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33mviewcode-back\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m \x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                \x1b[33m\'\x1b[39;49;00m\x1b[33mhref=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m../../index.html#spam.Class1\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m>[docs]</a>\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                \x1b[33m\'\x1b[39;49;00m\x1b[33m<span>@decorator</span>\x1b[39;49;00m\x1b[33m\\n\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                \x1b[33m\'\x1b[39;49;00m\x1b[33m<span>class</span> <span>Class1</span>\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                \x1b[33m\'\x1b[39;49;00m\x1b[33m<span>(</span><span>object</span><span>):</span>\x1b[39;49;00m\x1b[33m\\n\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                \x1b[33m\'\x1b[39;49;00m\x1b[33m    <span>&quot;&quot;&quot;</span>\x1b[39;49;00m\x1b[33m\\n\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                \x1b[33m\'\x1b[39;49;00m\x1b[33m<span>    this is Class1</span>\x1b[39;49;00m\x1b[33m\\n\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                \x1b[33m\'\x1b[39;49;00m\x1b[33m<span>    &quot;&quot;&quot;</span></div>\x1b[39;49;00m\x1b[33m\\n\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) \x1b[95min\x1b[39;49;00m result\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31mE       assert \'<div class="viewcode-block" id="Class1"><a class="viewcode-back" href="../../index.html#spam.Class1">[docs]</a><span>...an>\\n    <span>&quot;&quot;&quot;</span>\\n<span>    this is Class1</span>\\n<span>    &quot;&quot;&quot;</span></div>\\n\' in \'\\n<!DOCTYPE html>\\n\\n<html>\\n  <head>\\n    <meta charset="utf-8" />\\n    <meta name="viewport" content="width=device-..."https://github.com/bitprophet/alabaster">Alabaster 0.7.11</a>\\n      \\n    </div>\\n\\n    \\n\\n    \\n  </body>\\n</html>\'\x1b[0m\n\n\x1b[1m\x1b[31mtests/test_ext_viewcode.py\x1b[0m:43: AssertionError\n--------------------------- Captured stdout teardown ---------------------------\n# testroot: root\n# builder: html\n# srcdir: /tmp/pytest-of-root/pytest-6/ext-viewcode\n# outdir: /tmp/pytest-of-root/pytest-6/ext-viewcode/_build/html\n# status: \n\x1b[01mRunning Sphinx v3.5.0+/82ef497a8\x1b[39;49;00m\n\x1b[01mbuilding [html]: \x1b[39;49;00mall source files\n\x1b[01mupdating environment: \x1b[39;49;00m[new config] 2 added, 0 changed, 0 removed\n\x1b[01mreading sources... \x1b[39;49;00m[ 50%] \x1b[35mindex\x1b[39;49;00m                                                \r\x1b[01mreading sources... \x1b[39;49;00m[100%] \x1b[35mobjects\x1b[39;49;00m                                              \r\n\x1b[01mlooking for now-outdated files... \x1b[39;49;00mnone found\n\x1b[01mpickling environment... \x1b[39;49;00mdone\n\x1b[01mchecking consistency... \x1b[39;49;00mdone\n\x1b[01mpreparing documents... \x1b[39;49;00mdone\n\x1b[01mwriting output... \x1b[39;49;00m[ 50%] \x1b[32mindex\x1b[39;49;00m                                                 \r\x1b[01mwriting output... \x1b[39;49;00m[100%] \x1b[32mobjects\x1b[39;49;00m                                               \r\n\x1b[01mgenerating indices... \x1b[39;49;00mgenindex py-modindex done\n\x1b[01mhighlighting module code... \x1b[39;49;00m[ 50%] \x1b[94mspam.mod1\x1b[39;49;00m                                   \r\x1b[01mhighlighting module code... \x1b[39;49;00m[100%] \x1b[94mspam.mod2\x1b[39;49;00m                                   \r\n\x1b[01mwriting additional pages... \x1b[39;49;00msearch done\n\x1b[01mcopying static files... \x1b[39;49;00mdone\n\x1b[01mcopying extra files... \x1b[39;49;00mdone\n\x1b[01mdumping search index in English (code: en)... \x1b[39;49;00mdone\n\x1b[01mdumping object inventory... \x1b[39;49;00mdone\n\n# warning: \n\x1b[91mWARNING: while setting up extension sphinx.addnodes: node class \'meta\' is already registered, its visitors will be overridden\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-6/ext-viewcode/index.rst:23: WARNING: Object named \'func1\' not found in include file \'/tmp/pytest-of-root/pytest-6/ext-viewcode/spam/__init__.py\'\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-6/ext-viewcode/spam/mod1.py:docstring of spam.mod1.Class3:1: WARNING: duplicate object description of spam.mod3.Class3, other instance in index, use :noindex: for one of them\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-6/ext-viewcode/spam/mod1.py:docstring of spam.mod3.Class3.class_attr:1: WARNING: duplicate object description of spam.mod3.Class3.class_attr, other instance in index, use :noindex: for one of them\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-6/ext-viewcode/objects.rst:84: WARNING: Error in declarator\nIf declarator-id with parameters (e.g., \'void f(int arg)\'):\n  Invalid C declaration: Expected identifier in nested name. [error at 18]\n    Sphinx_DoSomething()\n    ------------------^\nIf parenthesis in noptr-declarator (e.g., \'void (*f(int arg))(double)\'):\n  Error in declarator or parameters\n  Invalid C declaration: Expected identifier in nested name. [error at 19]\n    Sphinx_DoSomething()\n    -------------------^\n\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-6/ext-viewcode/objects.rst:86: WARNING: Error in declarator or parameters\nInvalid C declaration: Expected identifier in nested name. [error at 19]\n  SphinxStruct.member\n  -------------------^\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-6/ext-viewcode/objects.rst:92: WARNING: Error in declarator or parameters\nInvalid C declaration: Expected identifier in nested name. [error at 13]\n  sphinx_global\n  -------------^\x1b[39;49;00m\n\x1b[31m/tmp/pytest-of-root/pytest-6/ext-viewcode/objects.rst:155: WARNING: Unknown directive type "userdesc".\n\n.. userdesc:: myobj:parameter\n\n   Description of userdesc.\x1b[39;49;00m\n\x1b[31m/tmp/pytest-of-root/pytest-6/ext-viewcode/objects.rst:160: WARNING: Unknown interpreted text role "userdescrole".\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-6/ext-viewcode/objects.rst:166: WARNING: Too many template argument lists compared to parameter lists. Argument lists: 1, Parameter lists: 0, Extra empty parameters lists prepended: 1. Declaration:\n\tn::Array<T, d>\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-6/ext-viewcode/objects.rst:117: WARNING: Unparseable C cross-reference: \'SphinxType *\'\nInvalid C declaration: Expected end of definition. [error at 11]\n  SphinxType *\n  -----------^\x1b[39;49;00m\n\n\x1b[31m\x1b[1m_________________________ test_viewcode_epub_disabled __________________________\x1b[0m\n\napp = <SphinxTestApp buildername=\'epub\'>\nstatus = <_io.StringIO object at 0x715497076550>\nwarning = <_io.StringIO object at 0x7154970765f0>\n\n    \x1b[0m\x1b[37m@pytest\x1b[39;49;00m.mark.sphinx(testroot=\x1b[33m\'\x1b[39;49;00m\x1b[33mext-viewcode\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m, confoverrides={\x1b[33m\'\x1b[39;49;00m\x1b[33mviewcode_enable_epub\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m: \x1b[94mFalse\x1b[39;49;00m})\x1b[90m\x1b[39;49;00m\n    \x1b[94mdef\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[92mtest_viewcode_epub_disabled\x1b[39;49;00m(app, status, warning):\x1b[90m\x1b[39;49;00m\n        \x1b[90m# Change to epub builder\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        app.builder.name = \x1b[33m"\x1b[39;49;00m\x1b[33mepub\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        app.builder.build_all()\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        \x1b[90m# Check that _modules directory is not created when viewcode_enable_epub is False\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        modules_dir = Path(app.outdir) / \x1b[33m\'\x1b[39;49;00m\x1b[33m_modules\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n>       \x1b[94massert\x1b[39;49;00m \x1b[95mnot\x1b[39;49;00m modules_dir.exists()\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31mE       AssertionError: assert not True\x1b[0m\n\x1b[1m\x1b[31mE        +  where True = exists()\x1b[0m\n\x1b[1m\x1b[31mE        +    where exists = PosixPath(\'/tmp/pytest-of-root/pytest-6/ext-viewcode/_build/html/_modules\').exists\x1b[0m\n\n\x1b[1m\x1b[31mtests/test_ext_viewcode.py\x1b[0m:61: AssertionError\n--------------------------- Captured stdout teardown ---------------------------\n# testroot: root\n# builder: epub\n# srcdir: /tmp/pytest-of-root/pytest-6/ext-viewcode\n# outdir: /tmp/pytest-of-root/pytest-6/ext-viewcode/_build/html\n# status: \n\x1b[01mRunning Sphinx v3.5.0+/82ef497a8\x1b[39;49;00m\n\x1b[01mloading pickled environment... \x1b[39;49;00mdone\n\x1b[01mbuilding [epub]: \x1b[39;49;00mall source files\n\x1b[01mupdating environment: \x1b[39;49;00m0 added, 0 changed, 0 removed\n\x1b[01mlooking for now-outdated files... \x1b[39;49;00mnone found\n\x1b[01mpreparing documents... \x1b[39;49;00mdone\n\x1b[01mwriting output... \x1b[39;49;00m[ 50%] \x1b[32mindex\x1b[39;49;00m                                                 \r\x1b[01mwriting output... \x1b[39;49;00m[100%] \x1b[32mobjects\x1b[39;49;00m                                               \r\n\x1b[01mgenerating indices... \x1b[39;49;00mgenindex py-modindex done\n\x1b[01mwriting additional pages... \x1b[39;49;00msearch done\n\x1b[01mcopying static files... \x1b[39;49;00mdone\n\x1b[01mcopying extra files... \x1b[39;49;00mdone\n\x1b[01mdumping search index in English (code: en)... \x1b[39;49;00mdone\n\x1b[01mdumping object inventory... \x1b[39;49;00mdone\n\n# warning: \n\x1b[91mWARNING: while setting up extension sphinx.addnodes: node class \'meta\' is already registered, its visitors will be overridden\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-6/ext-viewcode/objects.rst:117: WARNING: Unparseable C cross-reference: \'SphinxType *\'\nInvalid C declaration: Expected end of definition. [error at 11]\n  SphinxType *\n  -----------^\x1b[39;49;00m\n\n\x1b[33m=============================== warnings summary ===============================\x1b[0m\nsphinx/util/docutils.py:45\n  /testbed/sphinx/util/docutils.py:45: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.\n    __version_info__ = tuple(LooseVersion(docutils.__version__).version)\n\nsphinx/registry.py:22\n  /testbed/sphinx/registry.py:22: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n    from pkg_resources import iter_entry_points\n\n../opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pkg_resources/__init__.py:3142\n../opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pkg_resources/__init__.py:3142\n../opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pkg_resources/__init__.py:3142\n../opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pkg_resources/__init__.py:3142\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pkg_resources/__init__.py:3142: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace(\'sphinxcontrib\')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n    declare_namespace(pkg)\n\nsphinx/directives/patches.py:14\n  /testbed/sphinx/directives/patches.py:14: DeprecationWarning: The `docutils.parsers.rst.directive.html` module will be removed in Docutils 2.0. Since Docutils 0.18, the "Meta" node is defined in `docutils.parsers.rst.directives.misc`.\n    from docutils.parsers.rst.directives import html, images, tables\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:210: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse():  # type: Node\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/i18n.py:95: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.translatable):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:110: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for ref in self.document.traverse(nodes.substitution_reference):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:131: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.target):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:150: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.block_quote):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:175: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.Element):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:222: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.index):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:189: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.section):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:279: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.doctest_block):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/domains/citation.py:116: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.citation):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/domains/citation.py:135: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.citation_reference):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/builders/latex/transforms.py:36: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(matcher):  # type: nodes.Element\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:291: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(matcher):  # type: Element\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/util/compat.py:44: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.index):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/domains/index.py:51: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in document.traverse(addnodes.index):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/domains/math.py:84: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    self.data[\'has_equations\'][docname] = any(document.traverse(math_node))\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/environment/collectors/asset.py:46: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in doctree.traverse(nodes.image):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/environment/collectors/asset.py:127: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in doctree.traverse(addnodes.download_reference):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/environment/collectors/title.py:46: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in doctree.traverse(nodes.section):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/ext/viewcode.py:106: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for objnode in doctree.traverse(addnodes.desc):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:301: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.system_message):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:390: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.manpage):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/i18n.py:488: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for inline in self.document.traverse(matcher):  # type: nodes.inline\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/domains/python.py:283: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in result.traverse(nodes.Text):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/builders/html/__init__.py:422: DeprecationWarning: The frontend.OptionParser class will be replaced by a subclass of argparse.ArgumentParser in Docutils 0.21 or later.\n    self.docsettings = OptionParser(\n\ntests/test_ext_viewcode.py: 360 warnings\n  /opt/miniconda3/envs/testbed/lib/python3.9/optparse.py:1000: DeprecationWarning: The frontend.Option class will be removed in Docutils 0.21 or later.\n    option = self.option_class(*args, **kwargs)\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/domains/c.py:3494: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(AliasNode):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/domains/cpp.py:7070: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(AliasNode):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/post_transforms/__init__.py:69: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.pending_xref):\n\ntests/test_ext_viewcode.py: 48 warnings\n  /testbed/sphinx/util/nodes.py:598: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in document.traverse(addnodes.only):\n\ntests/test_ext_viewcode.py: 18 warnings\n  /testbed/sphinx/transforms/post_transforms/images.py:33: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.image):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/post_transforms/__init__.py:216: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.desc_sig_element):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/builders/latex/transforms.py:48: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.substitution_definition):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/builders/html/transforms.py:44: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(matcher):  # type: nodes.literal\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/builders/latex/transforms.py:606: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.title):\n\ntests/test_ext_viewcode.py: 33 warnings\n  /testbed/sphinx/builders/latex/transforms.py:608: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for i, index in enumerate(node.traverse(addnodes.index)):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/post_transforms/code.py:43: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.highlightlang):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/post_transforms/code.py:95: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for lbnode in self.document.traverse(nodes.literal_block):  # type: nodes.literal_block\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/post_transforms/code.py:99: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for dbnode in self.document.traverse(nodes.doctest_block):  # type: nodes.doctest_block\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/environment/__init__.py:541: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for toctreenode in doctree.traverse(addnodes.toctree):\n\ntests/test_ext_viewcode.py: 30 warnings\n  /testbed/sphinx/environment/adapters/toctree.py:203: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for subtocnode in toc.traverse(addnodes.toctree):\n\ntests/test_ext_viewcode.py: 30 warnings\n  /testbed/sphinx/environment/adapters/toctree.py:261: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for refnode in newnode.traverse(nodes.reference):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/builders/__init__.py:181: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in doctree.traverse(nodes.image):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/builders/html/__init__.py:844: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in doctree.traverse(nodes.image):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/environment/adapters/toctree.py:312: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in toc.traverse(nodes.reference):\n\ntests/test_ext_viewcode.py: 33 warnings\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/alabaster/layout.html:114: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n    _gaq.push([\'_setAllowLinker\', true]);\n\ntests/test_ext_viewcode.py: 33 warnings\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/alabaster/about.html:70: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py: 33 warnings\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/alabaster/about.html:99: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py: 33 warnings\n  /testbed/sphinx/environment/adapters/toctree.py:328: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for toctreenode in doctree.traverse(addnodes.toctree):\n\ntests/test_ext_viewcode.py: 33 warnings\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/alabaster/layout.html:215: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py: 33 warnings\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/alabaster/layout.html:238: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  <template>:33: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  <template>:224: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  <template>:386: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  <template>:401: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py: 18 warnings\n  /testbed/sphinx/util/nodes.py:350: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for img in node.traverse(nodes.image):\n\ntests/test_ext_viewcode.py: 18 warnings\n  /testbed/sphinx/util/nodes.py:352: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for raw in node.traverse(nodes.raw):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/ext/linkcode.py:42: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for objnode in doctree.traverse(addnodes.desc):\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n==================================== PASSES ====================================\n--------------------------- Captured stdout teardown ---------------------------\n# testroot: root\n# builder: epub\n# srcdir: /tmp/pytest-of-root/pytest-6/ext-viewcode\n# outdir: /tmp/pytest-of-root/pytest-6/ext-viewcode/_build/html\n# status: \n\x1b[01mRunning Sphinx v3.5.0+/82ef497a8\x1b[39;49;00m\n\x1b[01mloading pickled environment... \x1b[39;49;00mdone\n\x1b[01mbuilding [epub]: \x1b[39;49;00mall source files\n\x1b[01mupdating environment: \x1b[39;49;00m0 added, 0 changed, 0 removed\n\x1b[01mlooking for now-outdated files... \x1b[39;49;00mnone found\n\x1b[01mpreparing documents... \x1b[39;49;00mdone\n\x1b[01mwriting output... \x1b[39;49;00m[ 50%] \x1b[32mindex\x1b[39;49;00m                                                 \r\x1b[01mwriting output... \x1b[39;49;00m[100%] \x1b[32mobjects\x1b[39;49;00m                                               \r\n\x1b[01mgenerating indices... \x1b[39;49;00mgenindex py-modindex done\n\x1b[01mhighlighting module code... \x1b[39;49;00m[ 50%] \x1b[94mspam.mod1\x1b[39;49;00m                                   \r\x1b[01mhighlighting module code... \x1b[39;49;00m[100%] \x1b[94mspam.mod2\x1b[39;49;00m                                   \r\n\x1b[01mwriting additional pages... \x1b[39;49;00msearch done\n\x1b[01mcopying static files... \x1b[39;49;00mdone\n\x1b[01mcopying extra files... \x1b[39;49;00mdone\n\x1b[01mdumping search index in English (code: en)... \x1b[39;49;00mdone\n\x1b[01mdumping object inventory... \x1b[39;49;00mdone\n\n# warning: \n\x1b[91mWARNING: while setting up extension sphinx.addnodes: node class \'meta\' is already registered, its visitors will be overridden\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-6/ext-viewcode/objects.rst:117: WARNING: Unparseable C cross-reference: \'SphinxType *\'\nInvalid C declaration: Expected end of definition. [error at 11]\n  SphinxType *\n  -----------^\x1b[39;49;00m\n\n--------------------------- Captured stdout teardown ---------------------------\n# testroot: root\n# builder: html\n# srcdir: /tmp/pytest-of-root/pytest-6/ext-viewcode\n# outdir: /tmp/pytest-of-root/pytest-6/ext-viewcode/_build/html\n# status: \n\x1b[01mRunning Sphinx v3.5.0+/82ef497a8\x1b[39;49;00m\n\x1b[01mloading pickled environment... \x1b[39;49;00mdone\n\x1b[01mupdating environment: \x1b[39;49;00m[extensions changed (\'2\')] 2 added, 0 changed, 0 removed\n\x1b[01mreading sources... \x1b[39;49;00m[ 50%] \x1b[35mindex\x1b[39;49;00m                                                \r\x1b[01mreading sources... \x1b[39;49;00m[100%] \x1b[35mobjects\x1b[39;49;00m                                              \r\n\x1b[01mlooking for now-outdated files... \x1b[39;49;00mnone found\n\x1b[01mpickling environment... \x1b[39;49;00mdone\n\x1b[01mchecking consistency... \x1b[39;49;00mdone\n\x1b[01mpreparing documents... \x1b[39;49;00mdone\n\x1b[01mwriting output... \x1b[39;49;00m[ 50%] \x1b[32mindex\x1b[39;49;00m                                                 \r\x1b[01mwriting output... \x1b[39;49;00m[100%] \x1b[32mobjects\x1b[39;49;00m                                               \r\n\x1b[01mgenerating indices... \x1b[39;49;00mgenindex py-modindex done\n\x1b[01mwriting additional pages... \x1b[39;49;00msearch done\n\x1b[01mcopying static files... \x1b[39;49;00mdone\n\x1b[01mcopying extra files... \x1b[39;49;00mdone\n\x1b[01mdumping search index in English (code: en)... \x1b[39;49;00mdone\n\x1b[01mdumping object inventory... \x1b[39;49;00mdone\n\n# warning: \n\x1b[91mWARNING: while setting up extension sphinx.addnodes: node class \'meta\' is already registered, its visitors will be overridden\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-6/ext-viewcode/index.rst:23: WARNING: Object named \'func1\' not found in include file \'/tmp/pytest-of-root/pytest-6/ext-viewcode/spam/__init__.py\'\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-6/ext-viewcode/spam/mod1.py:docstring of spam.mod1.Class3:1: WARNING: duplicate object description of spam.mod3.Class3, other instance in index, use :noindex: for one of them\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-6/ext-viewcode/spam/mod1.py:docstring of spam.mod3.Class3.class_attr:1: WARNING: duplicate object description of spam.mod3.Class3.class_attr, other instance in index, use :noindex: for one of them\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-6/ext-viewcode/objects.rst:84: WARNING: Error in declarator\nIf declarator-id with parameters (e.g., \'void f(int arg)\'):\n  Invalid C declaration: Expected identifier in nested name. [error at 18]\n    Sphinx_DoSomething()\n    ------------------^\nIf parenthesis in noptr-declarator (e.g., \'void (*f(int arg))(double)\'):\n  Error in declarator or parameters\n  Invalid C declaration: Expected identifier in nested name. [error at 19]\n    Sphinx_DoSomething()\n    -------------------^\n\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-6/ext-viewcode/objects.rst:86: WARNING: Error in declarator or parameters\nInvalid C declaration: Expected identifier in nested name. [error at 19]\n  SphinxStruct.member\n  -------------------^\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-6/ext-viewcode/objects.rst:92: WARNING: Error in declarator or parameters\nInvalid C declaration: Expected identifier in nested name. [error at 13]\n  sphinx_global\n  -------------^\x1b[39;49;00m\n\x1b[31m/tmp/pytest-of-root/pytest-6/ext-viewcode/objects.rst:155: WARNING: Unknown directive type "userdesc".\n\n.. userdesc:: myobj:parameter\n\n   Description of userdesc.\x1b[39;49;00m\n\x1b[31m/tmp/pytest-of-root/pytest-6/ext-viewcode/objects.rst:160: WARNING: Unknown interpreted text role "userdescrole".\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-6/ext-viewcode/objects.rst:166: WARNING: Too many template argument lists compared to parameter lists. Argument lists: 1, Parameter lists: 0, Extra empty parameters lists prepended: 1. Declaration:\n\tn::Array<T, d>\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-6/ext-viewcode/objects.rst:117: WARNING: Unparseable C cross-reference: \'SphinxType *\'\nInvalid C declaration: Expected end of definition. [error at 11]\n  SphinxType *\n  -----------^\x1b[39;49;00m\n\n--------------------------- Captured stdout teardown ---------------------------\n# testroot: root\n# builder: html\n# srcdir: /tmp/pytest-of-root/pytest-6/ext-viewcode-find\n# outdir: /tmp/pytest-of-root/pytest-6/ext-viewcode-find/_build/html\n# status: \n\x1b[01mRunning Sphinx v3.5.0+/82ef497a8\x1b[39;49;00m\n\x1b[01mbuilding [html]: \x1b[39;49;00mall source files\n\x1b[01mupdating environment: \x1b[39;49;00m[new config] 1 added, 0 changed, 0 removed\n\x1b[01mreading sources... \x1b[39;49;00m[100%] \x1b[35mindex\x1b[39;49;00m                                                \r\n\x1b[01mlooking for now-outdated files... \x1b[39;49;00mnone found\n\x1b[01mpickling environment... \x1b[39;49;00mdone\n\x1b[01mchecking consistency... \x1b[39;49;00mdone\n\x1b[01mpreparing documents... \x1b[39;49;00mdone\n\x1b[01mwriting output... \x1b[39;49;00m[100%] \x1b[32mindex\x1b[39;49;00m                                                 \r\n\x1b[01mgenerating indices... \x1b[39;49;00mgenindex py-modindex done\n\x1b[01mhighlighting module code... \x1b[39;49;00m[ 50%] \x1b[94mnot_a_package\x1b[39;49;00m                               \r\x1b[01mhighlighting module code... \x1b[39;49;00m[100%] \x1b[94mnot_a_package.submodule\x1b[39;49;00m                     \r\n\x1b[01mwriting additional pages... \x1b[39;49;00msearch done\n\x1b[01mcopying static files... \x1b[39;49;00mdone\n\x1b[01mcopying extra files... \x1b[39;49;00mdone\n\x1b[01mdumping search index in English (code: en)... \x1b[39;49;00mdone\n\x1b[01mdumping object inventory... \x1b[39;49;00mdone\n\n# warning: \n\x1b[91mWARNING: while setting up extension sphinx.addnodes: node class \'meta\' is already registered, its visitors will be overridden\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-6/ext-viewcode-find/index.rst:28: WARNING: Object named \'func1\' not found in include file \'/tmp/pytest-of-root/pytest-6/ext-viewcode-find/not_a_package/__init__.py\'\x1b[39;49;00m\n\n============================= slowest 25 durations =============================\n0.36s call     tests/test_ext_viewcode.py::test_viewcode\n0.26s call     tests/test_ext_viewcode.py::test_linkcode\n0.22s call     tests/test_ext_viewcode.py::test_viewcode_epub_enabled\n0.18s call     tests/test_ext_viewcode.py::test_local_source_files\n0.17s call     tests/test_ext_viewcode.py::test_viewcode_epub_disabled\n0.15s setup    tests/test_ext_viewcode.py::test_viewcode\n0.01s setup    tests/test_ext_viewcode.py::test_viewcode_epub_enabled\n0.01s setup    tests/test_ext_viewcode.py::test_viewcode_epub_disabled\n0.01s setup    tests/test_ext_viewcode.py::test_linkcode\n0.01s setup    tests/test_ext_viewcode.py::test_local_source_files\n\n(5 durations < 0.005s hidden.  Use -vv to show these durations.)\n\x1b[36m\x1b[1m=========================== short test summary info ============================\x1b[0m\n\x1b[32mPASSED\x1b[0m tests/test_ext_viewcode.py::\x1b[1mtest_viewcode_epub_enabled\x1b[0m\n\x1b[32mPASSED\x1b[0m tests/test_ext_viewcode.py::\x1b[1mtest_linkcode\x1b[0m\n\x1b[32mPASSED\x1b[0m tests/test_ext_viewcode.py::\x1b[1mtest_local_source_files\x1b[0m\n\x1b[31mFAILED\x1b[0m tests/test_ext_viewcode.py::\x1b[1mtest_viewcode\x1b[0m - assert \'<div class="viewcode-block" id="Class1"><a class="viewcode-back" hr...\n\x1b[31mFAILED\x1b[0m tests/test_ext_viewcode.py::\x1b[1mtest_viewcode_epub_disabled\x1b[0m - AssertionError: assert not True\n\x1b[31m================== \x1b[31m\x1b[1m2 failed\x1b[0m, \x1b[32m3 passed\x1b[0m, \x1b[33m1024 warnings\x1b[0m\x1b[31m in 1.49s\x1b[0m\x1b[31m ==================\x1b[0m\npy39: exit 1 (1.96 seconds) /testbed> python -X dev -m pytest -rA --durations 25 tests/test_ext_viewcode.py pid=635\n  py39: FAIL code 1 (1.97=setup[0.01]+cmd[1.96] seconds)\n  evaluation failed :( (2.05 seconds)'}]}, {'role': 'assistant', 'content': [{'type': 'text', 'text': "The issue seems to be that we need to be more careful with the timing of directory creation. Let's modify our approach to handle this at the environment level:"}, {'type': 'text', 'text': '<tool_use>\n{\'tool_name\': editor, \'tool_input\': {\'command\': \'edit\', \'path\': \'/testbed/sphinx/ext/viewcode.py\', \'file_text\': \'"""\\n    sphinx.ext.viewcode\\n    ~~~~~~~~~~~~~~~~~~~\\n\\n    Add links to module code in Python object descriptions.\\n\\n    :copyright: Copyright 2007-2021 by the Sphinx team, see AUTHORS.\\n    :license: BSD, see LICENSE for details.\\n"""\\n\\nimport os\\nimport posixpath\\nimport shutil\\nimport traceback\\nfrom os import path\\nfrom typing import Any, Dict, Generator, Iterable, Optional, Set, Tuple, cast\\n\\nfrom docutils import nodes\\nfrom docutils.nodes import Element, Node\\n\\nimport sphinx\\nfrom sphinx import addnodes\\nfrom sphinx.application import Sphinx\\nfrom sphinx.builders.html import StandaloneHTMLBuilder\\nfrom sphinx.environment import BuildEnvironment\\nfrom sphinx.locale import _, __\\nfrom sphinx.pycode import ModuleAnalyzer\\nfrom sphinx.util import get_full_modname, logging, status_iterator\\nfrom sphinx.util.nodes import make_refnode\\n\\nlogger = logging.getLogger(__name__)\\n\\n\\nOUTPUT_DIRNAME = \\\'_modules\\\'\\n\\n\\ndef _get_full_modname(app: Sphinx, modname: str, attribute: str) -> Optional[str]:\\n    try:\\n        return get_full_modname(modname, attribute)\\n    except AttributeError:\\n        # sphinx.ext.viewcode can\\\'t follow class instance attribute\\n        # then AttributeError logging output only verbose mode.\\n        logger.verbose(\\\'Didn\\\\\\\'t find %s in %s\\\', attribute, modname)\\n        return None\\n    except Exception as e:\\n        # sphinx.ext.viewcode follow python domain directives.\\n        # because of that, if there are no real modules exists that specified\\n        # by py:function or other directives, viewcode emits a lot of warnings.\\n        # It should be displayed only verbose mode.\\n        logger.verbose(traceback.format_exc().rstrip())\\n        logger.verbose(\\\'viewcode can\\\\\\\'t import %s, failed with error "%s"\\\', modname, e)\\n        return None\\n\\n\\ndef is_epub_builder(app: Sphinx) -> bool:\\n    """Check if the builder is an epub builder."""\\n    return bool(getattr(app.builder, \\\'name\\\', \\\'\\\').startswith(\\\'epub\\\'))\\n\\n\\ndef should_view_code(app: Sphinx) -> bool:\\n    """Determine whether code module pages should be generated."""\\n    # Only show viewcode pages if:\\n    # 1. Not a singlehtml builder\\n    # 2. Not an epub builder, or epub builder with viewcode_enable_epub=True\\n    builder_name = getattr(app.builder, \\\'name\\\', \\\'\\\')\\n    \\n    if builder_name == \\\'singlehtml\\\':\\n        return False\\n        \\n    if is_epub_builder(app):\\n        return bool(app.builder.env.config.viewcode_enable_epub)\\n        \\n    return True\\n\\n\\ndef doctree_read(app: Sphinx, doctree: Node) -> None:\\n    env = app.builder.env\\n    if not hasattr(env, \\\'_viewcode_modules\\\'):\\n        env._viewcode_modules = {}  # type: ignore\\n        \\n    if not should_view_code(app):\\n        return\\n        \\n    def has_tag(modname: str, fullname: str, docname: str, refname: str) -> bool:\\n        entry = env._viewcode_modules.get(modname, None)  # type: ignore\\n        if entry is False:\\n            return False\\n\\n        code_tags = app.emit_firstresult(\\\'viewcode-find-source\\\', modname)\\n        if code_tags is None:\\n            try:\\n                analyzer = ModuleAnalyzer.for_module(modname)\\n                analyzer.find_tags()\\n            except Exception:\\n                env._viewcode_modules[modname] = False  # type: ignore\\n                return False\\n\\n            code = analyzer.code\\n            tags = analyzer.tags\\n        else:\\n            code, tags = code_tags\\n\\n        if entry is None or entry[0] != code:\\n            entry = code, tags, {}, refname\\n            env._viewcode_modules[modname] = entry  # type: ignore\\n        _, tags, used, _ = entry\\n        if fullname in tags:\\n            used[fullname] = docname\\n            return True\\n\\n        return False\\n\\n    for objnode in doctree.traverse(addnodes.desc):\\n        if objnode.get(\\\'domain\\\') != \\\'py\\\':\\n            continue\\n        names = set()  # type: Set[str]\\n        for signode in objnode:\\n            if not isinstance(signode, addnodes.desc_signature):\\n                continue\\n            modname = signode.get(\\\'module\\\')\\n            fullname = signode.get(\\\'fullname\\\')\\n            refname = modname\\n            if env.config.viewcode_follow_imported_members:\\n                new_modname = app.emit_firstresult(\\n                    \\\'viewcode-follow-imported\\\', modname, fullname,\\n                )\\n                if not new_modname:\\n                    new_modname = _get_full_modname(app, modname, fullname)\\n                modname = new_modname\\n            if not modname:\\n                continue\\n            fullname = signode.get(\\\'fullname\\\')\\n            if not has_tag(modname, fullname, env.docname, refname):\\n                continue\\n            if fullname in names:\\n                # only one link per name, please\\n                continue\\n            names.add(fullname)\\n            pagename = posixpath.join(OUTPUT_DIRNAME, modname.replace(\\\'.\\\', \\\'/\\\'))\\n            inline = nodes.inline(\\\'\\\', _(\\\'[source]\\\'), classes=[\\\'viewcode-link\\\'])\\n            onlynode = addnodes.only(expr=\\\'html\\\')\\n            onlynode += addnodes.pending_xref(\\\'\\\', inline, reftype=\\\'viewcode\\\', refdomain=\\\'std\\\',\\n                                          refexplicit=False, reftarget=pagename,\\n                                          refid=fullname, refdoc=env.docname)\\n            signode += onlynode\\n\\n\\ndef env_merge_info(app: Sphinx, env: BuildEnvironment, docnames: Iterable[str],\\n                   other: BuildEnvironment) -> None:\\n    if not hasattr(other, \\\'_viewcode_modules\\\'):\\n        return\\n    # create a _viewcode_modules dict on the main environment\\n    if not hasattr(env, \\\'_viewcode_modules\\\'):\\n        env._viewcode_modules = {}  # type: ignore\\n    # now merge in the information from the subprocess\\n    env._viewcode_modules.update(other._viewcode_modules)  # type: ignore\\n\\n\\ndef missing_reference(app: Sphinx, env: BuildEnvironment, node: Element, contnode: Node\\n                      ) -> Optional[Node]:\\n    # resolve our "viewcode" reference nodes -- they need special treatment\\n    if node[\\\'reftype\\\'] == \\\'viewcode\\\':\\n        return make_refnode(app.builder, node[\\\'refdoc\\\'], node[\\\'reftarget\\\'],\\n                            node[\\\'refid\\\'], contnode)\\n\\n    return None\\n\\n\\ndef collect_pages(app: Sphinx) -> Generator[Tuple[str, Dict[str, Any], str], None, None]:\\n    if not should_view_code(app):\\n        return\\n\\n    env = app.builder.env\\n\\n    if not hasattr(env, \\\'_viewcode_modules\\\'):\\n        return\\n\\n    highlighter = app.builder.highlighter  # type: ignore\\n    urito = app.builder.get_relative_uri\\n\\n    modnames = set(env._viewcode_modules)  # type: ignore\\n\\n    modules_dir = os.path.join(app.builder.outdir, OUTPUT_DIRNAME)\\n    if path.exists(modules_dir):\\n        shutil.rmtree(modules_dir)\\n    if should_view_code(app):\\n        os.makedirs(modules_dir)\\n\\n    for modname, entry in status_iterator(\\n            sorted(env._viewcode_modules.items()),  # type: ignore\\n            __(\\\'highlighting module code... \\\'), "blue",\\n            len(env._viewcode_modules),  # type: ignore\\n            app.verbosity, lambda x: x[0]):\\n        if not entry:\\n            continue\\n\\n        code, tags, used, refname = entry\\n        pagename = posixpath.join(OUTPUT_DIRNAME, modname.replace(\\\'.\\\', \\\'/\\\'))\\n\\n        if env.config.highlight_language in (\\\'python3\\\', \\\'default\\\', \\\'none\\\'):\\n            lexer = env.config.highlight_language\\n        else:\\n            lexer = \\\'python\\\'\\n        highlighted = highlighter.highlight_block(code, lexer, linenos=False)\\n        lines = highlighted.splitlines()\\n        before, after = lines[0].split(\\\'<pre>\\\')\\n        lines[0:1] = [before + \\\'<pre>\\\', after]\\n\\n        maxindex = len(lines) - 1\\n        for name, docname in used.items():\\n            type, start, end = tags[name]\\n            backlink = urito(pagename, docname) + \\\'#\\\' + refname + \\\'.\\\' + name\\n            lines[start] = (\\n                \\\'<div class="viewcode-block" id="%s"><a class="viewcode-back" \\\'\\n                \\\'href="%s">%s</a>\\\' % (name, backlink, _(\\\'[docs]\\\')) +\\n                lines[start])\\n            lines[min(end, maxindex)] += \\\'</div>\\\'\\n\\n        parents = []\\n        parent = modname\\n        while \\\'.\\\' in parent:\\n            parent = parent.rsplit(\\\'.\\\', 1)[0]\\n            if parent in modnames:\\n                parents.append({\\n                    \\\'link\\\': urito(pagename,\\n                                  posixpath.join(OUTPUT_DIRNAME, parent.replace(\\\'.\\\', \\\'/\\\'))),\\n                    \\\'title\\\': parent})\\n        parents.append({\\\'link\\\': urito(pagename, posixpath.join(OUTPUT_DIRNAME, \\\'index\\\')),\\n                        \\\'title\\\': _(\\\'Module code\\\')})\\n        parents.reverse()\\n\\n        context = {\\n            \\\'parents\\\': parents,\\n            \\\'title\\\': modname,\\n            \\\'body\\\': (_(\\\'<h1>Source code for %s</h1>\\\') % modname +\\n                     \\\'\\\\n\\\'.join(lines)),\\n        }\\n\\n        yield (pagename, context, \\\'page.html\\\')\\n\\n    if not modnames:\\n        return\\n\\n    html = [\\\'\\\\n\\\']\\n    stack = [\\\'\\\']\\n    for modname in sorted(modnames):\\n        if modname.startswith(stack[-1]):\\n            stack.append(modname + \\\'.\\\')\\n            html.append(\\\'<ul>\\\')\\n        else:\\n            stack.pop()\\n            stack.append(modname + \\\'.\\\')\\n            html.append(\\\'</ul>\\\' * (len(stack) - 1) + \\\'<ul>\\\')\\n        if modname in env._viewcode_modules and env._viewcode_modules[modname]:  # type: ignore\\n            pagename = posixpath.join(OUTPUT_DIRNAME, modname.replace(\\\'.\\\', \\\'/\\\'))\\n            html.append(\\\'<li><a href="%s">%s</a></li>\\\\n\\\' % (\\n                urito(OUTPUT_DIRNAME + \\\'/index\\\', pagename), modname))\\n\\n    if html == [\\\'\\\\n\\\']:  # no documented Python objects\\n        return\\n\\n    html.append(\\\'</ul>\\\' * len(stack))\\n    context = {\\n        \\\'title\\\': _(\\\'Overview: module code\\\'),\\n        \\\'body\\\': (_(\\\'<h1>All modules for which code is available</h1>\\\') +\\n                 \\\'\\\'.join(html)),\\n    }\\n\\n    yield (posixpath.join(OUTPUT_DIRNAME, \\\'index\\\'), context, \\\'page.html\\\')\\n\\n\\ndef builder_inited(app: Sphinx) -> None:\\n    """Update environment with necessary data."""\\n    env = app.builder.env\\n    if not hasattr(env, \\\'_viewcode_modules\\\'):\\n        env._viewcode_modules = {}  # type: ignore\\n\\n\\ndef setup(app: Sphinx) -> Dict[str, Any]:\\n    app.add_config_value(\\\'viewcode_enable_epub\\\', False, False)\\n    app.add_config_value(\\\'viewcode_follow_imported_members\\\', True, False)\\n    app.add_event(\\\'viewcode-find-source\\\')\\n    app.add_event(\\\'viewcode-follow-imported\\\')\\n    app.connect(\\\'builder-inited\\\', builder_inited)\\n    app.connect(\\\'doctree-read\\\', doctree_read)\\n    app.connect(\\\'env-merge-info\\\', env_merge_info)\\n    app.connect(\\\'html-collect-pages\\\', collect_pages)\\n    app.connect(\\\'missing-reference\\\', missing_reference)\\n\\n    return {\\n        \\\'version\\\': sphinx.__display_version__,\\n        \\\'parallel_read_safe\\\': True\\n    }\'}}\n</tool_use>'}]}, {'role': 'user', 'content': [{'type': 'text', 'text': 'Tool Result: File at /testbed/sphinx/ext/viewcode.py has been overwritten with new content.'}]}, {'role': 'assistant', 'content': [{'type': 'text', 'text': "Let's run the tests again:"}, {'type': 'text', 'text': "<tool_use>\n{'tool_name': bash, 'tool_input': {'command': 'cd /testbed/ && tox --current-env -epy39 -v -- tests/test_ext_viewcode.py'}}\n</tool_use>"}]}, {'role': 'user', 'content': [{'type': 'text', 'text': 'Tool Result: py39: commands[0]> python -X dev -m pytest -rA --durations 25 tests/test_ext_viewcode.py\n\x1b[1m============================= test session starts ==============================\x1b[0m\nplatform linux -- Python 3.9.21, pytest-8.3.4, pluggy-1.5.0\ncachedir: .tox/py39/.pytest_cache\nlibraries: Sphinx-3.5.0+/82ef497a8, docutils-0.21.2\nbase tempdir: /tmp/pytest-of-root/pytest-7\nrootdir: /testbed\nconfigfile: setup.cfg\nplugins: cov-6.0.0\ncollected 5 items\n\ntests/test_ext_viewcode.py \x1b[31mF\x1b[0m\x1b[31mF\x1b[0m\x1b[32m.\x1b[0m\x1b[32m.\x1b[0m\x1b[32m.\x1b[0m\x1b[31m                                         [100%]\x1b[0m\n\n=================================== FAILURES ===================================\n\x1b[31m\x1b[1m________________________________ test_viewcode _________________________________\x1b[0m\n\napp = <SphinxTestApp buildername=\'html\'>\nstatus = <_io.StringIO object at 0x7e80cad720f0>\nwarning = <_io.StringIO object at 0x7e80cad72190>\n\n    \x1b[0m\x1b[37m@pytest\x1b[39;49;00m.mark.sphinx(testroot=\x1b[33m\'\x1b[39;49;00m\x1b[33mext-viewcode\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m)\x1b[90m\x1b[39;49;00m\n    \x1b[94mdef\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[92mtest_viewcode\x1b[39;49;00m(app, status, warning):\x1b[90m\x1b[39;49;00m\n        app.builder.build_all()\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        warnings = re.sub(\x1b[33mr\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[33m\\\\\x1b[39;49;00m\x1b[33m+\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m, \x1b[33m\'\x1b[39;49;00m\x1b[33m/\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m, warning.getvalue())\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m re.findall(\x1b[90m\x1b[39;49;00m\n            \x1b[33mr\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33mindex.rst:\x1b[39;49;00m\x1b[33m\\\x1b[39;49;00m\x1b[33md+: WARNING: Object named \x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[33mfunc1\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[33m not found in include \x1b[39;49;00m\x1b[33m"\x1b[39;49;00m +\x1b[90m\x1b[39;49;00m\n            \x1b[33mr\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33mfile .*/spam/__init__.py\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m,\x1b[90m\x1b[39;49;00m\n            warnings\x1b[90m\x1b[39;49;00m\n        )\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        result = (app.outdir / \x1b[33m\'\x1b[39;49;00m\x1b[33mindex.html\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m).read_text()\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m result.count(\x1b[33m\'\x1b[39;49;00m\x1b[33mhref=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m_modules/spam/mod1.html#func1\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) == \x1b[94m2\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m result.count(\x1b[33m\'\x1b[39;49;00m\x1b[33mhref=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m_modules/spam/mod2.html#func2\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) == \x1b[94m2\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m result.count(\x1b[33m\'\x1b[39;49;00m\x1b[33mhref=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m_modules/spam/mod1.html#Class1\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) == \x1b[94m2\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m result.count(\x1b[33m\'\x1b[39;49;00m\x1b[33mhref=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m_modules/spam/mod2.html#Class2\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) == \x1b[94m2\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m result.count(\x1b[33m\'\x1b[39;49;00m\x1b[33m@decorator\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) == \x1b[94m1\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        \x1b[90m# test that the class attribute is correctly documented\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m result.count(\x1b[33m\'\x1b[39;49;00m\x1b[33mthis is Class3\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) == \x1b[94m2\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m \x1b[33m\'\x1b[39;49;00m\x1b[33mthis is the class attribute class_attr\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m \x1b[95min\x1b[39;49;00m result\x1b[90m\x1b[39;49;00m\n        \x1b[90m# the next assert fails, until the autodoc bug gets fixed\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m result.count(\x1b[33m\'\x1b[39;49;00m\x1b[33mthis is the class attribute class_attr\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) == \x1b[94m2\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        result = (app.outdir / \x1b[33m\'\x1b[39;49;00m\x1b[33m_modules/spam/mod1.html\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m).read_text()\x1b[90m\x1b[39;49;00m\n        result = re.sub(\x1b[33m\'\x1b[39;49;00m\x1b[33m<span class=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m.*?\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m>\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m, \x1b[33m\'\x1b[39;49;00m\x1b[33m<span>\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m, result)  \x1b[90m# filter pygments classes\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n>       \x1b[94massert\x1b[39;49;00m (\x1b[33m\'\x1b[39;49;00m\x1b[33m<div class=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33mviewcode-block\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m id=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33mClass1\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m><a class=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33mviewcode-back\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m \x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                \x1b[33m\'\x1b[39;49;00m\x1b[33mhref=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m../../index.html#spam.Class1\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m>[docs]</a>\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                \x1b[33m\'\x1b[39;49;00m\x1b[33m<span>@decorator</span>\x1b[39;49;00m\x1b[33m\\n\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                \x1b[33m\'\x1b[39;49;00m\x1b[33m<span>class</span> <span>Class1</span>\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                \x1b[33m\'\x1b[39;49;00m\x1b[33m<span>(</span><span>object</span><span>):</span>\x1b[39;49;00m\x1b[33m\\n\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                \x1b[33m\'\x1b[39;49;00m\x1b[33m    <span>&quot;&quot;&quot;</span>\x1b[39;49;00m\x1b[33m\\n\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                \x1b[33m\'\x1b[39;49;00m\x1b[33m<span>    this is Class1</span>\x1b[39;49;00m\x1b[33m\\n\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                \x1b[33m\'\x1b[39;49;00m\x1b[33m<span>    &quot;&quot;&quot;</span></div>\x1b[39;49;00m\x1b[33m\\n\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) \x1b[95min\x1b[39;49;00m result\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31mE       assert \'<div class="viewcode-block" id="Class1"><a class="viewcode-back" href="../../index.html#spam.Class1">[docs]</a><span>...an>\\n    <span>&quot;&quot;&quot;</span>\\n<span>    this is Class1</span>\\n<span>    &quot;&quot;&quot;</span></div>\\n\' in \'\\n<!DOCTYPE html>\\n\\n<html>\\n  <head>\\n    <meta charset="utf-8" />\\n    <meta name="viewport" content="width=device-..."https://github.com/bitprophet/alabaster">Alabaster 0.7.11</a>\\n      \\n    </div>\\n\\n    \\n\\n    \\n  </body>\\n</html>\'\x1b[0m\n\n\x1b[1m\x1b[31mtests/test_ext_viewcode.py\x1b[0m:43: AssertionError\n--------------------------- Captured stdout teardown ---------------------------\n# testroot: root\n# builder: html\n# srcdir: /tmp/pytest-of-root/pytest-7/ext-viewcode\n# outdir: /tmp/pytest-of-root/pytest-7/ext-viewcode/_build/html\n# status: \n\x1b[01mRunning Sphinx v3.5.0+/82ef497a8\x1b[39;49;00m\n\x1b[01mbuilding [html]: \x1b[39;49;00mall source files\n\x1b[01mupdating environment: \x1b[39;49;00m[new config] 2 added, 0 changed, 0 removed\n\x1b[01mreading sources... \x1b[39;49;00m[ 50%] \x1b[35mindex\x1b[39;49;00m                                                \r\x1b[01mreading sources... \x1b[39;49;00m[100%] \x1b[35mobjects\x1b[39;49;00m                                              \r\n\x1b[01mlooking for now-outdated files... \x1b[39;49;00mnone found\n\x1b[01mpickling environment... \x1b[39;49;00mdone\n\x1b[01mchecking consistency... \x1b[39;49;00mdone\n\x1b[01mpreparing documents... \x1b[39;49;00mdone\n\x1b[01mwriting output... \x1b[39;49;00m[ 50%] \x1b[32mindex\x1b[39;49;00m                                                 \r\x1b[01mwriting output... \x1b[39;49;00m[100%] \x1b[32mobjects\x1b[39;49;00m                                               \r\n\x1b[01mgenerating indices... \x1b[39;49;00mgenindex py-modindex done\n\x1b[01mhighlighting module code... \x1b[39;49;00m[ 50%] \x1b[94mspam.mod1\x1b[39;49;00m                                   \r\x1b[01mhighlighting module code... \x1b[39;49;00m[100%] \x1b[94mspam.mod2\x1b[39;49;00m                                   \r\n\x1b[01mwriting additional pages... \x1b[39;49;00msearch done\n\x1b[01mcopying static files... \x1b[39;49;00mdone\n\x1b[01mcopying extra files... \x1b[39;49;00mdone\n\x1b[01mdumping search index in English (code: en)... \x1b[39;49;00mdone\n\x1b[01mdumping object inventory... \x1b[39;49;00mdone\n\n# warning: \n\x1b[91mWARNING: while setting up extension sphinx.addnodes: node class \'meta\' is already registered, its visitors will be overridden\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-7/ext-viewcode/index.rst:23: WARNING: Object named \'func1\' not found in include file \'/tmp/pytest-of-root/pytest-7/ext-viewcode/spam/__init__.py\'\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-7/ext-viewcode/spam/mod1.py:docstring of spam.mod1.Class3:1: WARNING: duplicate object description of spam.mod3.Class3, other instance in index, use :noindex: for one of them\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-7/ext-viewcode/spam/mod1.py:docstring of spam.mod3.Class3.class_attr:1: WARNING: duplicate object description of spam.mod3.Class3.class_attr, other instance in index, use :noindex: for one of them\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-7/ext-viewcode/objects.rst:84: WARNING: Error in declarator\nIf declarator-id with parameters (e.g., \'void f(int arg)\'):\n  Invalid C declaration: Expected identifier in nested name. [error at 18]\n    Sphinx_DoSomething()\n    ------------------^\nIf parenthesis in noptr-declarator (e.g., \'void (*f(int arg))(double)\'):\n  Error in declarator or parameters\n  Invalid C declaration: Expected identifier in nested name. [error at 19]\n    Sphinx_DoSomething()\n    -------------------^\n\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-7/ext-viewcode/objects.rst:86: WARNING: Error in declarator or parameters\nInvalid C declaration: Expected identifier in nested name. [error at 19]\n  SphinxStruct.member\n  -------------------^\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-7/ext-viewcode/objects.rst:92: WARNING: Error in declarator or parameters\nInvalid C declaration: Expected identifier in nested name. [error at 13]\n  sphinx_global\n  -------------^\x1b[39;49;00m\n\x1b[31m/tmp/pytest-of-root/pytest-7/ext-viewcode/objects.rst:155: WARNING: Unknown directive type "userdesc".\n\n.. userdesc:: myobj:parameter\n\n   Description of userdesc.\x1b[39;49;00m\n\x1b[31m/tmp/pytest-of-root/pytest-7/ext-viewcode/objects.rst:160: WARNING: Unknown interpreted text role "userdescrole".\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-7/ext-viewcode/objects.rst:166: WARNING: Too many template argument lists compared to parameter lists. Argument lists: 1, Parameter lists: 0, Extra empty parameters lists prepended: 1. Declaration:\n\tn::Array<T, d>\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-7/ext-viewcode/objects.rst:117: WARNING: Unparseable C cross-reference: \'SphinxType *\'\nInvalid C declaration: Expected end of definition. [error at 11]\n  SphinxType *\n  -----------^\x1b[39;49;00m\n\n\x1b[31m\x1b[1m_________________________ test_viewcode_epub_disabled __________________________\x1b[0m\n\napp = <SphinxTestApp buildername=\'epub\'>\nstatus = <_io.StringIO object at 0x7e80c997c410>\nwarning = <_io.StringIO object at 0x7e80c997c4b0>\n\n    \x1b[0m\x1b[37m@pytest\x1b[39;49;00m.mark.sphinx(testroot=\x1b[33m\'\x1b[39;49;00m\x1b[33mext-viewcode\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m, confoverrides={\x1b[33m\'\x1b[39;49;00m\x1b[33mviewcode_enable_epub\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m: \x1b[94mFalse\x1b[39;49;00m})\x1b[90m\x1b[39;49;00m\n    \x1b[94mdef\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[92mtest_viewcode_epub_disabled\x1b[39;49;00m(app, status, warning):\x1b[90m\x1b[39;49;00m\n        \x1b[90m# Change to epub builder\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        app.builder.name = \x1b[33m"\x1b[39;49;00m\x1b[33mepub\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        app.builder.build_all()\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        \x1b[90m# Check that _modules directory is not created when viewcode_enable_epub is False\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        modules_dir = Path(app.outdir) / \x1b[33m\'\x1b[39;49;00m\x1b[33m_modules\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n>       \x1b[94massert\x1b[39;49;00m \x1b[95mnot\x1b[39;49;00m modules_dir.exists()\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31mE       AssertionError: assert not True\x1b[0m\n\x1b[1m\x1b[31mE        +  where True = exists()\x1b[0m\n\x1b[1m\x1b[31mE        +    where exists = PosixPath(\'/tmp/pytest-of-root/pytest-7/ext-viewcode/_build/html/_modules\').exists\x1b[0m\n\n\x1b[1m\x1b[31mtests/test_ext_viewcode.py\x1b[0m:61: AssertionError\n--------------------------- Captured stdout teardown ---------------------------\n# testroot: root\n# builder: epub\n# srcdir: /tmp/pytest-of-root/pytest-7/ext-viewcode\n# outdir: /tmp/pytest-of-root/pytest-7/ext-viewcode/_build/html\n# status: \n\x1b[01mRunning Sphinx v3.5.0+/82ef497a8\x1b[39;49;00m\n\x1b[01mloading pickled environment... \x1b[39;49;00mdone\n\x1b[01mbuilding [epub]: \x1b[39;49;00mall source files\n\x1b[01mupdating environment: \x1b[39;49;00m0 added, 0 changed, 0 removed\n\x1b[01mlooking for now-outdated files... \x1b[39;49;00mnone found\n\x1b[01mpreparing documents... \x1b[39;49;00mdone\n\x1b[01mwriting output... \x1b[39;49;00m[ 50%] \x1b[32mindex\x1b[39;49;00m                                                 \r\x1b[01mwriting output... \x1b[39;49;00m[100%] \x1b[32mobjects\x1b[39;49;00m                                               \r\n\x1b[01mgenerating indices... \x1b[39;49;00mgenindex py-modindex done\n\x1b[01mwriting additional pages... \x1b[39;49;00msearch done\n\x1b[01mcopying static files... \x1b[39;49;00mdone\n\x1b[01mcopying extra files... \x1b[39;49;00mdone\n\x1b[01mdumping search index in English (code: en)... \x1b[39;49;00mdone\n\x1b[01mdumping object inventory... \x1b[39;49;00mdone\n\n# warning: \n\x1b[91mWARNING: while setting up extension sphinx.addnodes: node class \'meta\' is already registered, its visitors will be overridden\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-7/ext-viewcode/objects.rst:117: WARNING: Unparseable C cross-reference: \'SphinxType *\'\nInvalid C declaration: Expected end of definition. [error at 11]\n  SphinxType *\n  -----------^\x1b[39;49;00m\n\n\x1b[33m=============================== warnings summary ===============================\x1b[0m\nsphinx/util/docutils.py:45\n  /testbed/sphinx/util/docutils.py:45: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.\n    __version_info__ = tuple(LooseVersion(docutils.__version__).version)\n\nsphinx/registry.py:22\n  /testbed/sphinx/registry.py:22: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n    from pkg_resources import iter_entry_points\n\n../opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pkg_resources/__init__.py:3142\n../opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pkg_resources/__init__.py:3142\n../opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pkg_resources/__init__.py:3142\n../opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pkg_resources/__init__.py:3142\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pkg_resources/__init__.py:3142: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace(\'sphinxcontrib\')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n    declare_namespace(pkg)\n\nsphinx/directives/patches.py:14\n  /testbed/sphinx/directives/patches.py:14: DeprecationWarning: The `docutils.parsers.rst.directive.html` module will be removed in Docutils 2.0. Since Docutils 0.18, the "Meta" node is defined in `docutils.parsers.rst.directives.misc`.\n    from docutils.parsers.rst.directives import html, images, tables\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:210: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse():  # type: Node\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/i18n.py:95: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.translatable):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:110: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for ref in self.document.traverse(nodes.substitution_reference):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:131: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.target):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:150: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.block_quote):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:175: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.Element):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:222: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.index):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:189: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.section):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:279: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.doctest_block):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/domains/citation.py:116: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.citation):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/domains/citation.py:135: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.citation_reference):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/builders/latex/transforms.py:36: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(matcher):  # type: nodes.Element\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:291: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(matcher):  # type: Element\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/util/compat.py:44: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.index):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/domains/index.py:51: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in document.traverse(addnodes.index):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/domains/math.py:84: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    self.data[\'has_equations\'][docname] = any(document.traverse(math_node))\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/environment/collectors/asset.py:46: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in doctree.traverse(nodes.image):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/environment/collectors/asset.py:127: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in doctree.traverse(addnodes.download_reference):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/environment/collectors/title.py:46: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in doctree.traverse(nodes.section):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/ext/viewcode.py:113: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for objnode in doctree.traverse(addnodes.desc):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:301: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.system_message):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:390: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.manpage):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/i18n.py:488: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for inline in self.document.traverse(matcher):  # type: nodes.inline\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/domains/python.py:283: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in result.traverse(nodes.Text):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/builders/html/__init__.py:422: DeprecationWarning: The frontend.OptionParser class will be replaced by a subclass of argparse.ArgumentParser in Docutils 0.21 or later.\n    self.docsettings = OptionParser(\n\ntests/test_ext_viewcode.py: 360 warnings\n  /opt/miniconda3/envs/testbed/lib/python3.9/optparse.py:1000: DeprecationWarning: The frontend.Option class will be removed in Docutils 0.21 or later.\n    option = self.option_class(*args, **kwargs)\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/domains/c.py:3494: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(AliasNode):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/domains/cpp.py:7070: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(AliasNode):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/post_transforms/__init__.py:69: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.pending_xref):\n\ntests/test_ext_viewcode.py: 48 warnings\n  /testbed/sphinx/util/nodes.py:598: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in document.traverse(addnodes.only):\n\ntests/test_ext_viewcode.py: 18 warnings\n  /testbed/sphinx/transforms/post_transforms/images.py:33: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.image):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/post_transforms/__init__.py:216: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.desc_sig_element):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/builders/latex/transforms.py:48: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.substitution_definition):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/builders/html/transforms.py:44: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(matcher):  # type: nodes.literal\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/builders/latex/transforms.py:606: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.title):\n\ntests/test_ext_viewcode.py: 33 warnings\n  /testbed/sphinx/builders/latex/transforms.py:608: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for i, index in enumerate(node.traverse(addnodes.index)):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/post_transforms/code.py:43: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.highlightlang):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/post_transforms/code.py:95: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for lbnode in self.document.traverse(nodes.literal_block):  # type: nodes.literal_block\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/post_transforms/code.py:99: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for dbnode in self.document.traverse(nodes.doctest_block):  # type: nodes.doctest_block\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/environment/__init__.py:541: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for toctreenode in doctree.traverse(addnodes.toctree):\n\ntests/test_ext_viewcode.py: 30 warnings\n  /testbed/sphinx/environment/adapters/toctree.py:203: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for subtocnode in toc.traverse(addnodes.toctree):\n\ntests/test_ext_viewcode.py: 30 warnings\n  /testbed/sphinx/environment/adapters/toctree.py:261: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for refnode in newnode.traverse(nodes.reference):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/builders/__init__.py:181: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in doctree.traverse(nodes.image):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/builders/html/__init__.py:844: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in doctree.traverse(nodes.image):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/environment/adapters/toctree.py:312: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in toc.traverse(nodes.reference):\n\ntests/test_ext_viewcode.py: 33 warnings\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/alabaster/layout.html:114: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n    _gaq.push([\'_setAllowLinker\', true]);\n\ntests/test_ext_viewcode.py: 33 warnings\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/alabaster/about.html:70: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py: 33 warnings\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/alabaster/about.html:99: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py: 33 warnings\n  /testbed/sphinx/environment/adapters/toctree.py:328: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for toctreenode in doctree.traverse(addnodes.toctree):\n\ntests/test_ext_viewcode.py: 33 warnings\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/alabaster/layout.html:215: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py: 33 warnings\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/alabaster/layout.html:238: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  <template>:33: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  <template>:224: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  <template>:386: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  <template>:401: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py: 18 warnings\n  /testbed/sphinx/util/nodes.py:350: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for img in node.traverse(nodes.image):\n\ntests/test_ext_viewcode.py: 18 warnings\n  /testbed/sphinx/util/nodes.py:352: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for raw in node.traverse(nodes.raw):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/ext/linkcode.py:42: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for objnode in doctree.traverse(addnodes.desc):\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n==================================== PASSES ====================================\n--------------------------- Captured stdout teardown ---------------------------\n# testroot: root\n# builder: epub\n# srcdir: /tmp/pytest-of-root/pytest-7/ext-viewcode\n# outdir: /tmp/pytest-of-root/pytest-7/ext-viewcode/_build/html\n# status: \n\x1b[01mRunning Sphinx v3.5.0+/82ef497a8\x1b[39;49;00m\n\x1b[01mloading pickled environment... \x1b[39;49;00mdone\n\x1b[01mbuilding [epub]: \x1b[39;49;00mall source files\n\x1b[01mupdating environment: \x1b[39;49;00m0 added, 0 changed, 0 removed\n\x1b[01mlooking for now-outdated files... \x1b[39;49;00mnone found\n\x1b[01mpreparing documents... \x1b[39;49;00mdone\n\x1b[01mwriting output... \x1b[39;49;00m[ 50%] \x1b[32mindex\x1b[39;49;00m                                                 \r\x1b[01mwriting output... \x1b[39;49;00m[100%] \x1b[32mobjects\x1b[39;49;00m                                               \r\n\x1b[01mgenerating indices... \x1b[39;49;00mgenindex py-modindex done\n\x1b[01mhighlighting module code... \x1b[39;49;00m[ 50%] \x1b[94mspam.mod1\x1b[39;49;00m                                   \r\x1b[01mhighlighting module code... \x1b[39;49;00m[100%] \x1b[94mspam.mod2\x1b[39;49;00m                                   \r\n\x1b[01mwriting additional pages... \x1b[39;49;00msearch done\n\x1b[01mcopying static files... \x1b[39;49;00mdone\n\x1b[01mcopying extra files... \x1b[39;49;00mdone\n\x1b[01mdumping search index in English (code: en)... \x1b[39;49;00mdone\n\x1b[01mdumping object inventory... \x1b[39;49;00mdone\n\n# warning: \n\x1b[91mWARNING: while setting up extension sphinx.addnodes: node class \'meta\' is already registered, its visitors will be overridden\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-7/ext-viewcode/objects.rst:117: WARNING: Unparseable C cross-reference: \'SphinxType *\'\nInvalid C declaration: Expected end of definition. [error at 11]\n  SphinxType *\n  -----------^\x1b[39;49;00m\n\n--------------------------- Captured stdout teardown ---------------------------\n# testroot: root\n# builder: html\n# srcdir: /tmp/pytest-of-root/pytest-7/ext-viewcode\n# outdir: /tmp/pytest-of-root/pytest-7/ext-viewcode/_build/html\n# status: \n\x1b[01mRunning Sphinx v3.5.0+/82ef497a8\x1b[39;49;00m\n\x1b[01mloading pickled environment... \x1b[39;49;00mdone\n\x1b[01mupdating environment: \x1b[39;49;00m[extensions changed (\'2\')] 2 added, 0 changed, 0 removed\n\x1b[01mreading sources... \x1b[39;49;00m[ 50%] \x1b[35mindex\x1b[39;49;00m                                                \r\x1b[01mreading sources... \x1b[39;49;00m[100%] \x1b[35mobjects\x1b[39;49;00m                                              \r\n\x1b[01mlooking for now-outdated files... \x1b[39;49;00mnone found\n\x1b[01mpickling environment... \x1b[39;49;00mdone\n\x1b[01mchecking consistency... \x1b[39;49;00mdone\n\x1b[01mpreparing documents... \x1b[39;49;00mdone\n\x1b[01mwriting output... \x1b[39;49;00m[ 50%] \x1b[32mindex\x1b[39;49;00m                                                 \r\x1b[01mwriting output... \x1b[39;49;00m[100%] \x1b[32mobjects\x1b[39;49;00m                                               \r\n\x1b[01mgenerating indices... \x1b[39;49;00mgenindex py-modindex done\n\x1b[01mwriting additional pages... \x1b[39;49;00msearch done\n\x1b[01mcopying static files... \x1b[39;49;00mdone\n\x1b[01mcopying extra files... \x1b[39;49;00mdone\n\x1b[01mdumping search index in English (code: en)... \x1b[39;49;00mdone\n\x1b[01mdumping object inventory... \x1b[39;49;00mdone\n\n# warning: \n\x1b[91mWARNING: while setting up extension sphinx.addnodes: node class \'meta\' is already registered, its visitors will be overridden\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-7/ext-viewcode/index.rst:23: WARNING: Object named \'func1\' not found in include file \'/tmp/pytest-of-root/pytest-7/ext-viewcode/spam/__init__.py\'\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-7/ext-viewcode/spam/mod1.py:docstring of spam.mod1.Class3:1: WARNING: duplicate object description of spam.mod3.Class3, other instance in index, use :noindex: for one of them\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-7/ext-viewcode/spam/mod1.py:docstring of spam.mod3.Class3.class_attr:1: WARNING: duplicate object description of spam.mod3.Class3.class_attr, other instance in index, use :noindex: for one of them\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-7/ext-viewcode/objects.rst:84: WARNING: Error in declarator\nIf declarator-id with parameters (e.g., \'void f(int arg)\'):\n  Invalid C declaration: Expected identifier in nested name. [error at 18]\n    Sphinx_DoSomething()\n    ------------------^\nIf parenthesis in noptr-declarator (e.g., \'void (*f(int arg))(double)\'):\n  Error in declarator or parameters\n  Invalid C declaration: Expected identifier in nested name. [error at 19]\n    Sphinx_DoSomething()\n    -------------------^\n\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-7/ext-viewcode/objects.rst:86: WARNING: Error in declarator or parameters\nInvalid C declaration: Expected identifier in nested name. [error at 19]\n  SphinxStruct.member\n  -------------------^\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-7/ext-viewcode/objects.rst:92: WARNING: Error in declarator or parameters\nInvalid C declaration: Expected identifier in nested name. [error at 13]\n  sphinx_global\n  -------------^\x1b[39;49;00m\n\x1b[31m/tmp/pytest-of-root/pytest-7/ext-viewcode/objects.rst:155: WARNING: Unknown directive type "userdesc".\n\n.. userdesc:: myobj:parameter\n\n   Description of userdesc.\x1b[39;49;00m\n\x1b[31m/tmp/pytest-of-root/pytest-7/ext-viewcode/objects.rst:160: WARNING: Unknown interpreted text role "userdescrole".\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-7/ext-viewcode/objects.rst:166: WARNING: Too many template argument lists compared to parameter lists. Argument lists: 1, Parameter lists: 0, Extra empty parameters lists prepended: 1. Declaration:\n\tn::Array<T, d>\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-7/ext-viewcode/objects.rst:117: WARNING: Unparseable C cross-reference: \'SphinxType *\'\nInvalid C declaration: Expected end of definition. [error at 11]\n  SphinxType *\n  -----------^\x1b[39;49;00m\n\n--------------------------- Captured stdout teardown ---------------------------\n# testroot: root\n# builder: html\n# srcdir: /tmp/pytest-of-root/pytest-7/ext-viewcode-find\n# outdir: /tmp/pytest-of-root/pytest-7/ext-viewcode-find/_build/html\n# status: \n\x1b[01mRunning Sphinx v3.5.0+/82ef497a8\x1b[39;49;00m\n\x1b[01mbuilding [html]: \x1b[39;49;00mall source files\n\x1b[01mupdating environment: \x1b[39;49;00m[new config] 1 added, 0 changed, 0 removed\n\x1b[01mreading sources... \x1b[39;49;00m[100%] \x1b[35mindex\x1b[39;49;00m                                                \r\n\x1b[01mlooking for now-outdated files... \x1b[39;49;00mnone found\n\x1b[01mpickling environment... \x1b[39;49;00mdone\n\x1b[01mchecking consistency... \x1b[39;49;00mdone\n\x1b[01mpreparing documents... \x1b[39;49;00mdone\n\x1b[01mwriting output... \x1b[39;49;00m[100%] \x1b[32mindex\x1b[39;49;00m                                                 \r\n\x1b[01mgenerating indices... \x1b[39;49;00mgenindex py-modindex done\n\x1b[01mhighlighting module code... \x1b[39;49;00m[ 50%] \x1b[94mnot_a_package\x1b[39;49;00m                               \r\x1b[01mhighlighting module code... \x1b[39;49;00m[100%] \x1b[94mnot_a_package.submodule\x1b[39;49;00m                     \r\n\x1b[01mwriting additional pages... \x1b[39;49;00msearch done\n\x1b[01mcopying static files... \x1b[39;49;00mdone\n\x1b[01mcopying extra files... \x1b[39;49;00mdone\n\x1b[01mdumping search index in English (code: en)... \x1b[39;49;00mdone\n\x1b[01mdumping object inventory... \x1b[39;49;00mdone\n\n# warning: \n\x1b[91mWARNING: while setting up extension sphinx.addnodes: node class \'meta\' is already registered, its visitors will be overridden\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-7/ext-viewcode-find/index.rst:28: WARNING: Object named \'func1\' not found in include file \'/tmp/pytest-of-root/pytest-7/ext-viewcode-find/not_a_package/__init__.py\'\x1b[39;49;00m\n\n============================= slowest 25 durations =============================\n0.36s call     tests/test_ext_viewcode.py::test_viewcode\n0.26s call     tests/test_ext_viewcode.py::test_linkcode\n0.22s call     tests/test_ext_viewcode.py::test_viewcode_epub_enabled\n0.17s call     tests/test_ext_viewcode.py::test_viewcode_epub_disabled\n0.17s call     tests/test_ext_viewcode.py::test_local_source_files\n0.15s setup    tests/test_ext_viewcode.py::test_viewcode\n0.01s setup    tests/test_ext_viewcode.py::test_viewcode_epub_enabled\n0.01s setup    tests/test_ext_viewcode.py::test_viewcode_epub_disabled\n0.01s setup    tests/test_ext_viewcode.py::test_linkcode\n0.01s setup    tests/test_ext_viewcode.py::test_local_source_files\n\n(5 durations < 0.005s hidden.  Use -vv to show these durations.)\n\x1b[36m\x1b[1m=========================== short test summary info ============================\x1b[0m\n\x1b[32mPASSED\x1b[0m tests/test_ext_viewcode.py::\x1b[1mtest_viewcode_epub_enabled\x1b[0m\n\x1b[32mPASSED\x1b[0m tests/test_ext_viewcode.py::\x1b[1mtest_linkcode\x1b[0m\n\x1b[32mPASSED\x1b[0m tests/test_ext_viewcode.py::\x1b[1mtest_local_source_files\x1b[0m\n\x1b[31mFAILED\x1b[0m tests/test_ext_viewcode.py::\x1b[1mtest_viewcode\x1b[0m - assert \'<div class="viewcode-block" id="Class1"><a class="viewcode-back" hr...\n\x1b[31mFAILED\x1b[0m tests/test_ext_viewcode.py::\x1b[1mtest_viewcode_epub_disabled\x1b[0m - AssertionError: assert not True\n\x1b[31m================== \x1b[31m\x1b[1m2 failed\x1b[0m, \x1b[32m3 passed\x1b[0m, \x1b[33m1024 warnings\x1b[0m\x1b[31m in 1.48s\x1b[0m\x1b[31m ==================\x1b[0m\npy39: exit 1 (1.94 seconds) /testbed> python -X dev -m pytest -rA --durations 25 tests/test_ext_viewcode.py pid=709\n  py39: FAIL code 1 (1.95=setup[0.01]+cmd[1.94] seconds)\n  evaluation failed :( (2.04 seconds)'}]}, {'role': 'assistant', 'content': [{'type': 'text', 'text': "Still having issues with the tests. I noticed that we need to handle the connection to the page collection differently for different builder types. Let's update the code to add epub-specific handling:"}, {'type': 'text', 'text': '<tool_use>\n{\'tool_name\': editor, \'tool_input\': {\'command\': \'edit\', \'path\': \'/testbed/sphinx/ext/viewcode.py\', \'file_text\': \'"""\\n    sphinx.ext.viewcode\\n    ~~~~~~~~~~~~~~~~~~~\\n\\n    Add links to module code in Python object descriptions.\\n\\n    :copyright: Copyright 2007-2021 by the Sphinx team, see AUTHORS.\\n    :license: BSD, see LICENSE for details.\\n"""\\n\\nimport os\\nimport posixpath\\nimport shutil\\nimport traceback\\nfrom os import path\\nfrom typing import Any, Dict, Generator, Iterable, Optional, Set, Tuple, cast\\n\\nfrom docutils import nodes\\nfrom docutils.nodes import Element, Node\\n\\nimport sphinx\\nfrom sphinx import addnodes\\nfrom sphinx.application import Sphinx\\nfrom sphinx.builders.html import StandaloneHTMLBuilder\\nfrom sphinx.builders.epub import EpubBuilder\\nfrom sphinx.environment import BuildEnvironment\\nfrom sphinx.locale import _, __\\nfrom sphinx.pycode import ModuleAnalyzer\\nfrom sphinx.util import get_full_modname, logging, status_iterator\\nfrom sphinx.util.nodes import make_refnode\\n\\nlogger = logging.getLogger(__name__)\\n\\n\\nOUTPUT_DIRNAME = \\\'_modules\\\'\\n\\n\\ndef _get_full_modname(app: Sphinx, modname: str, attribute: str) -> Optional[str]:\\n    try:\\n        return get_full_modname(modname, attribute)\\n    except AttributeError:\\n        # sphinx.ext.viewcode can\\\'t follow class instance attribute\\n        # then AttributeError logging output only verbose mode.\\n        logger.verbose(\\\'Didn\\\\\\\'t find %s in %s\\\', attribute, modname)\\n        return None\\n    except Exception as e:\\n        # sphinx.ext.viewcode follow python domain directives.\\n        # because of that, if there are no real modules exists that specified\\n        # by py:function or other directives, viewcode emits a lot of warnings.\\n        # It should be displayed only verbose mode.\\n        logger.verbose(traceback.format_exc().rstrip())\\n        logger.verbose(\\\'viewcode can\\\\\\\'t import %s, failed with error "%s"\\\', modname, e)\\n        return None\\n\\n\\ndef should_view_code(app: Sphinx) -> bool:\\n    """Determine whether code module pages should be generated."""\\n    # Only show viewcode pages if:\\n    # 1. Not a singlehtml builder\\n    # 2. Not an epub builder, or epub builder with viewcode_enable_epub=True\\n    builder_name = getattr(app.builder, \\\'name\\\', \\\'\\\')\\n    \\n    if builder_name == \\\'singlehtml\\\':\\n        return False\\n        \\n    if isinstance(app.builder, EpubBuilder):\\n        return bool(app.builder.env.config.viewcode_enable_epub)\\n        \\n    return True\\n\\n\\ndef doctree_read(app: Sphinx, doctree: Node) -> None:\\n    env = app.builder.env\\n    if not hasattr(env, \\\'_viewcode_modules\\\'):\\n        env._viewcode_modules = {}  # type: ignore\\n        \\n    if not should_view_code(app):\\n        return\\n        \\n    def has_tag(modname: str, fullname: str, docname: str, refname: str) -> bool:\\n        entry = env._viewcode_modules.get(modname, None)  # type: ignore\\n        if entry is False:\\n            return False\\n\\n        code_tags = app.emit_firstresult(\\\'viewcode-find-source\\\', modname)\\n        if code_tags is None:\\n            try:\\n                analyzer = ModuleAnalyzer.for_module(modname)\\n                analyzer.find_tags()\\n            except Exception:\\n                env._viewcode_modules[modname] = False  # type: ignore\\n                return False\\n\\n            code = analyzer.code\\n            tags = analyzer.tags\\n        else:\\n            code, tags = code_tags\\n\\n        if entry is None or entry[0] != code:\\n            entry = code, tags, {}, refname\\n            env._viewcode_modules[modname] = entry  # type: ignore\\n        _, tags, used, _ = entry\\n        if fullname in tags:\\n            used[fullname] = docname\\n            return True\\n\\n        return False\\n\\n    for objnode in doctree.traverse(addnodes.desc):\\n        if objnode.get(\\\'domain\\\') != \\\'py\\\':\\n            continue\\n        names = set()  # type: Set[str]\\n        for signode in objnode:\\n            if not isinstance(signode, addnodes.desc_signature):\\n                continue\\n            modname = signode.get(\\\'module\\\')\\n            fullname = signode.get(\\\'fullname\\\')\\n            refname = modname\\n            if env.config.viewcode_follow_imported_members:\\n                new_modname = app.emit_firstresult(\\n                    \\\'viewcode-follow-imported\\\', modname, fullname,\\n                )\\n                if not new_modname:\\n                    new_modname = _get_full_modname(app, modname, fullname)\\n                modname = new_modname\\n            if not modname:\\n                continue\\n            fullname = signode.get(\\\'fullname\\\')\\n            if not has_tag(modname, fullname, env.docname, refname):\\n                continue\\n            if fullname in names:\\n                # only one link per name, please\\n                continue\\n            names.add(fullname)\\n            pagename = posixpath.join(OUTPUT_DIRNAME, modname.replace(\\\'.\\\', \\\'/\\\'))\\n            inline = nodes.inline(\\\'\\\', _(\\\'[source]\\\'), classes=[\\\'viewcode-link\\\'])\\n            onlynode = addnodes.only(expr=\\\'html\\\')\\n            onlynode += addnodes.pending_xref(\\\'\\\', inline, reftype=\\\'viewcode\\\', refdomain=\\\'std\\\',\\n                                          refexplicit=False, reftarget=pagename,\\n                                          refid=fullname, refdoc=env.docname)\\n            signode += onlynode\\n\\n\\ndef env_merge_info(app: Sphinx, env: BuildEnvironment, docnames: Iterable[str],\\n                   other: BuildEnvironment) -> None:\\n    if not hasattr(other, \\\'_viewcode_modules\\\'):\\n        return\\n    # create a _viewcode_modules dict on the main environment\\n    if not hasattr(env, \\\'_viewcode_modules\\\'):\\n        env._viewcode_modules = {}  # type: ignore\\n    # now merge in the information from the subprocess\\n    env._viewcode_modules.update(other._viewcode_modules)  # type: ignore\\n\\n\\ndef missing_reference(app: Sphinx, env: BuildEnvironment, node: Element, contnode: Node\\n                      ) -> Optional[Node]:\\n    # resolve our "viewcode" reference nodes -- they need special treatment\\n    if node[\\\'reftype\\\'] == \\\'viewcode\\\':\\n        return make_refnode(app.builder, node[\\\'refdoc\\\'], node[\\\'reftarget\\\'],\\n                            node[\\\'refid\\\'], contnode)\\n\\n    return None\\n\\n\\ndef collect_pages(app: Sphinx) -> Generator[Tuple[str, Dict[str, Any], str], None, None]:\\n    if not should_view_code(app):\\n        return\\n\\n    env = app.builder.env\\n\\n    if not hasattr(env, \\\'_viewcode_modules\\\'):\\n        return\\n\\n    highlighter = app.builder.highlighter  # type: ignore\\n    urito = app.builder.get_relative_uri\\n\\n    modnames = set(env._viewcode_modules)  # type: ignore\\n\\n    # Create or clean up the _modules directory\\n    modules_dir = os.path.join(app.builder.outdir, OUTPUT_DIRNAME)\\n    if path.exists(modules_dir):\\n        shutil.rmtree(modules_dir)\\n    if should_view_code(app):\\n        os.makedirs(modules_dir)\\n\\n    for modname, entry in status_iterator(\\n            sorted(env._viewcode_modules.items()),  # type: ignore\\n            __(\\\'highlighting module code... \\\'), "blue",\\n            len(env._viewcode_modules),  # type: ignore\\n            app.verbosity, lambda x: x[0]):\\n        if not entry:\\n            continue\\n\\n        code, tags, used, refname = entry\\n        pagename = posixpath.join(OUTPUT_DIRNAME, modname.replace(\\\'.\\\', \\\'/\\\'))\\n\\n        if env.config.highlight_language in (\\\'python3\\\', \\\'default\\\', \\\'none\\\'):\\n            lexer = env.config.highlight_language\\n        else:\\n            lexer = \\\'python\\\'\\n        highlighted = highlighter.highlight_block(code, lexer, linenos=False)\\n        lines = highlighted.splitlines()\\n        before, after = lines[0].split(\\\'<pre>\\\')\\n        lines[0:1] = [before + \\\'<pre>\\\', after]\\n\\n        maxindex = len(lines) - 1\\n        for name, docname in used.items():\\n            type, start, end = tags[name]\\n            backlink = urito(pagename, docname) + \\\'#\\\' + refname + \\\'.\\\' + name\\n            lines[start] = (\\n                \\\'<div class="viewcode-block" id="%s"><a class="viewcode-back" \\\'\\n                \\\'href="%s">%s</a>\\\' % (name, backlink, _(\\\'[docs]\\\')) +\\n                lines[start])\\n            lines[min(end, maxindex)] += \\\'</div>\\\'\\n\\n        parents = []\\n        parent = modname\\n        while \\\'.\\\' in parent:\\n            parent = parent.rsplit(\\\'.\\\', 1)[0]\\n            if parent in modnames:\\n                parents.append({\\n                    \\\'link\\\': urito(pagename,\\n                                  posixpath.join(OUTPUT_DIRNAME, parent.replace(\\\'.\\\', \\\'/\\\'))),\\n                    \\\'title\\\': parent})\\n        parents.append({\\\'link\\\': urito(pagename, posixpath.join(OUTPUT_DIRNAME, \\\'index\\\')),\\n                        \\\'title\\\': _(\\\'Module code\\\')})\\n        parents.reverse()\\n\\n        context = {\\n            \\\'parents\\\': parents,\\n            \\\'title\\\': modname,\\n            \\\'body\\\': (_(\\\'<h1>Source code for %s</h1>\\\') % modname +\\n                     \\\'\\\\n\\\'.join(lines)),\\n        }\\n        yield (pagename, context, \\\'page.html\\\')\\n\\n    if not modnames:\\n        return\\n\\n    html = [\\\'\\\\n\\\']\\n    stack = [\\\'\\\']\\n    for modname in sorted(modnames):\\n        if modname.startswith(stack[-1]):\\n            stack.append(modname + \\\'.\\\')\\n            html.append(\\\'<ul>\\\')\\n        else:\\n            stack.pop()\\n            stack.append(modname + \\\'.\\\')\\n            html.append(\\\'</ul>\\\' * (len(stack) - 1) + \\\'<ul>\\\')\\n        if modname in env._viewcode_modules and env._viewcode_modules[modname]:  # type: ignore\\n            pagename = posixpath.join(OUTPUT_DIRNAME, modname.replace(\\\'.\\\', \\\'/\\\'))\\n            html.append(\\\'<li><a href="%s">%s</a></li>\\\\n\\\' % (\\n                urito(OUTPUT_DIRNAME + \\\'/index\\\', pagename), modname))\\n\\n    if html == [\\\'\\\\n\\\']:  # no documented Python objects\\n        return\\n\\n    html.append(\\\'</ul>\\\' * len(stack))\\n    context = {\\n        \\\'title\\\': _(\\\'Overview: module code\\\'),\\n        \\\'body\\\': (_(\\\'<h1>All modules for which code is available</h1>\\\') +\\n                 \\\'\\\'.join(html)),\\n    }\\n    yield (posixpath.join(OUTPUT_DIRNAME, \\\'index\\\'), context, \\\'page.html\\\')\\n\\n\\ndef setup(app: Sphinx) -> Dict[str, Any]:\\n    app.add_config_value(\\\'viewcode_enable_epub\\\', False, False)\\n    app.add_config_value(\\\'viewcode_follow_imported_members\\\', True, False)\\n    app.add_event(\\\'viewcode-find-source\\\')\\n    app.add_event(\\\'viewcode-follow-imported\\\')\\n    \\n    if isinstance(app.builder, StandaloneHTMLBuilder):\\n        app.connect(\\\'html-collect-pages\\\', collect_pages)\\n    elif isinstance(app.builder, EpubBuilder):\\n        if app.builder.env.config.viewcode_enable_epub:\\n            app.connect(\\\'html-collect-pages\\\', collect_pages)\\n    \\n    app.connect(\\\'doctree-read\\\', doctree_read)\\n    app.connect(\\\'env-merge-info\\\', env_merge_info)\\n    app.connect(\\\'missing-reference\\\', missing_reference)\\n\\n    return {\\n        \\\'version\\\': sphinx.__display_version__,\\n        \\\'parallel_read_safe\\\': True\\n    }\'}}\n</tool_use>'}]}, {'role': 'user', 'content': [{'type': 'text', 'text': 'Tool Result: File at /testbed/sphinx/ext/viewcode.py has been overwritten with new content.'}]}, {'role': 'assistant', 'content': [{'type': 'text', 'text': "Let's run the tests again:"}, {'type': 'text', 'text': "<tool_use>\n{'tool_name': bash, 'tool_input': {'command': 'cd /testbed/ && tox --current-env -epy39 -v -- tests/test_ext_viewcode.py'}}\n</tool_use>"}]}, {'role': 'user', 'content': [{'type': 'text', 'text': 'Tool Result: py39: commands[0]> python -X dev -m pytest -rA --durations 25 tests/test_ext_viewcode.py\n\x1b[1m============================= test session starts ==============================\x1b[0m\nplatform linux -- Python 3.9.21, pytest-8.3.4, pluggy-1.5.0\ncachedir: .tox/py39/.pytest_cache\nlibraries: Sphinx-3.5.0+/82ef497a8, docutils-0.21.2\nbase tempdir: /tmp/pytest-of-root/pytest-8\nrootdir: /testbed\nconfigfile: setup.cfg\nplugins: cov-6.0.0\ncollected 5 items\n\ntests/test_ext_viewcode.py \x1b[31mE\x1b[0m\x1b[31mE\x1b[0m\x1b[31mE\x1b[0m\x1b[32m.\x1b[0m\x1b[31mE\x1b[0m\x1b[31m                                         [100%]\x1b[0m\n\n==================================== ERRORS ====================================\n\x1b[31m\x1b[1m_______________________ ERROR at setup of test_viewcode ________________________\x1b[0m\n\nself = <sphinx.registry.SphinxComponentRegistry object at 0x7163a3de0e60>\napp = <[AttributeError("\'NoneType\' object has no attribute \'name\'") raised in repr()] SphinxTestApp object at 0x7163a3de0730>\nextname = \'sphinx.ext.viewcode\'\n\n    \x1b[0m\x1b[94mdef\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[92mload_extension\x1b[39;49;00m(\x1b[96mself\x1b[39;49;00m, app: \x1b[33m"\x1b[39;49;00m\x1b[33mSphinx\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m, extname: \x1b[96mstr\x1b[39;49;00m) -> \x1b[94mNone\x1b[39;49;00m:\x1b[90m\x1b[39;49;00m\n    \x1b[90m    \x1b[39;49;00m\x1b[33m"""Load a Sphinx extension."""\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94mif\x1b[39;49;00m extname \x1b[95min\x1b[39;49;00m app.extensions:  \x1b[90m# already loaded\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n            \x1b[94mreturn\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94mif\x1b[39;49;00m extname \x1b[95min\x1b[39;49;00m EXTENSION_BLACKLIST:\x1b[90m\x1b[39;49;00m\n            logger.warning(__(\x1b[33m\'\x1b[39;49;00m\x1b[33mthe extension \x1b[39;49;00m\x1b[33m%r\x1b[39;49;00m\x1b[33m was already merged with Sphinx since \x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                              \x1b[33m\'\x1b[39;49;00m\x1b[33mversion \x1b[39;49;00m\x1b[33m%s\x1b[39;49;00m\x1b[33m; this extension is ignored.\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m),\x1b[90m\x1b[39;49;00m\n                           extname, EXTENSION_BLACKLIST[extname])\x1b[90m\x1b[39;49;00m\n            \x1b[94mreturn\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        \x1b[90m# update loading context\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        prefix = __(\x1b[33m\'\x1b[39;49;00m\x1b[33mwhile setting up extension \x1b[39;49;00m\x1b[33m%s\x1b[39;49;00m\x1b[33m:\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) % extname\x1b[90m\x1b[39;49;00m\n        \x1b[94mwith\x1b[39;49;00m prefixed_warnings(prefix):\x1b[90m\x1b[39;49;00m\n            \x1b[94mtry\x1b[39;49;00m:\x1b[90m\x1b[39;49;00m\n>               mod = import_module(extname)\x1b[90m\x1b[39;49;00m\n\n\x1b[1m\x1b[31msphinx/registry.py\x1b[0m:417: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\x1b[1m\x1b[31m/opt/miniconda3/envs/testbed/lib/python3.9/importlib/__init__.py\x1b[0m:127: in import_module\n    \x1b[0m\x1b[94mreturn\x1b[39;49;00m _bootstrap._gcd_import(name[level:], package, level)\x1b[90m\x1b[39;49;00m\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\n    \x1b[0m\x1b[33m"""\x1b[39;49;00m\n    \x1b[33m    sphinx.ext.viewcode\x1b[39;49;00m\n    \x1b[33m    ~~~~~~~~~~~~~~~~~~~\x1b[39;49;00m\n    \x1b[33m\x1b[39;49;00m\n    \x1b[33m    Add links to module code in Python object descriptions.\x1b[39;49;00m\n    \x1b[33m\x1b[39;49;00m\n    \x1b[33m    :copyright: Copyright 2007-2021 by the Sphinx team, see AUTHORS.\x1b[39;49;00m\n    \x1b[33m    :license: BSD, see LICENSE for details.\x1b[39;49;00m\n    \x1b[33m"""\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n    \x1b[94mimport\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mos\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[94mimport\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mposixpath\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[94mimport\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mshutil\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[94mimport\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mtraceback\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mos\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m path\x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mtyping\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m Any, Dict, Generator, Iterable, Optional, Set, Tuple, cast\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mdocutils\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m nodes\x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mdocutils\x1b[39;49;00m\x1b[04m\x1b[96m.\x1b[39;49;00m\x1b[04m\x1b[96mnodes\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m Element, Node\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n    \x1b[94mimport\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96msphinx\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96msphinx\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m addnodes\x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96msphinx\x1b[39;49;00m\x1b[04m\x1b[96m.\x1b[39;49;00m\x1b[04m\x1b[96mapplication\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m Sphinx\x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96msphinx\x1b[39;49;00m\x1b[04m\x1b[96m.\x1b[39;49;00m\x1b[04m\x1b[96mbuilders\x1b[39;49;00m\x1b[04m\x1b[96m.\x1b[39;49;00m\x1b[04m\x1b[96mhtml\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m StandaloneHTMLBuilder\x1b[90m\x1b[39;49;00m\n>   \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96msphinx\x1b[39;49;00m\x1b[04m\x1b[96m.\x1b[39;49;00m\x1b[04m\x1b[96mbuilders\x1b[39;49;00m\x1b[04m\x1b[96m.\x1b[39;49;00m\x1b[04m\x1b[96mepub\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m EpubBuilder\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31mE   ModuleNotFoundError: No module named \'sphinx.builders.epub\'\x1b[0m\n\n\x1b[1m\x1b[31msphinx/ext/viewcode.py\x1b[0m:25: ModuleNotFoundError\n\n\x1b[33mThe above exception was the direct cause of the following exception:\x1b[0m\n\ntest_params = {\'shared_result\': None}\napp_params = app_params(args=[], kwargs={\'srcdir\': path(\'/tmp/pytest-of-root/pytest-8/ext-viewcode\')})\nmake_app = <function make_app.<locals>.make at 0x7163a3df2050>\nshared_result = <sphinx.testing.fixtures.SharedResult object at 0x7163a3de0780>\n\n    \x1b[0m\x1b[37m@pytest\x1b[39;49;00m.fixture(scope=\x1b[33m\'\x1b[39;49;00m\x1b[33mfunction\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m)\x1b[90m\x1b[39;49;00m\n    \x1b[94mdef\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[92mapp\x1b[39;49;00m(test_params: Dict, app_params: Tuple[Dict, Dict], make_app: Callable,\x1b[90m\x1b[39;49;00m\n            shared_result: SharedResult) -> Generator[SphinxTestApp, \x1b[94mNone\x1b[39;49;00m, \x1b[94mNone\x1b[39;49;00m]:\x1b[90m\x1b[39;49;00m\n    \x1b[90m    \x1b[39;49;00m\x1b[33m"""\x1b[39;49;00m\n    \x1b[33m    provides sphinx.application.Sphinx object\x1b[39;49;00m\n    \x1b[33m    """\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        args, kwargs = app_params\x1b[90m\x1b[39;49;00m\n>       app_ = make_app(*args, **kwargs)\x1b[90m\x1b[39;49;00m\n\n\x1b[1m\x1b[31msphinx/testing/fixtures.py\x1b[0m:149: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\x1b[1m\x1b[31msphinx/testing/fixtures.py\x1b[0m:195: in make\n    \x1b[0mapp_ = SphinxTestApp(*args, **kwargs)  \x1b[90m# type: Any\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31msphinx/testing/util.py\x1b[0m:133: in __init__\n    \x1b[0m\x1b[96msuper\x1b[39;49;00m().\x1b[92m__init__\x1b[39;49;00m(srcdir, confdir, outdir, doctreedir,\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31msphinx/application.py\x1b[0m:245: in __init__\n    \x1b[0m\x1b[96mself\x1b[39;49;00m.setup_extension(extension)\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31msphinx/application.py\x1b[0m:402: in setup_extension\n    \x1b[0m\x1b[96mself\x1b[39;49;00m.registry.load_extension(\x1b[96mself\x1b[39;49;00m, extname)\x1b[90m\x1b[39;49;00m\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <sphinx.registry.SphinxComponentRegistry object at 0x7163a3de0e60>\napp = <[AttributeError("\'NoneType\' object has no attribute \'name\'") raised in repr()] SphinxTestApp object at 0x7163a3de0730>\nextname = \'sphinx.ext.viewcode\'\n\n    \x1b[0m\x1b[94mdef\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[92mload_extension\x1b[39;49;00m(\x1b[96mself\x1b[39;49;00m, app: \x1b[33m"\x1b[39;49;00m\x1b[33mSphinx\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m, extname: \x1b[96mstr\x1b[39;49;00m) -> \x1b[94mNone\x1b[39;49;00m:\x1b[90m\x1b[39;49;00m\n    \x1b[90m    \x1b[39;49;00m\x1b[33m"""Load a Sphinx extension."""\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94mif\x1b[39;49;00m extname \x1b[95min\x1b[39;49;00m app.extensions:  \x1b[90m# already loaded\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n            \x1b[94mreturn\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94mif\x1b[39;49;00m extname \x1b[95min\x1b[39;49;00m EXTENSION_BLACKLIST:\x1b[90m\x1b[39;49;00m\n            logger.warning(__(\x1b[33m\'\x1b[39;49;00m\x1b[33mthe extension \x1b[39;49;00m\x1b[33m%r\x1b[39;49;00m\x1b[33m was already merged with Sphinx since \x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                              \x1b[33m\'\x1b[39;49;00m\x1b[33mversion \x1b[39;49;00m\x1b[33m%s\x1b[39;49;00m\x1b[33m; this extension is ignored.\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m),\x1b[90m\x1b[39;49;00m\n                           extname, EXTENSION_BLACKLIST[extname])\x1b[90m\x1b[39;49;00m\n            \x1b[94mreturn\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        \x1b[90m# update loading context\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        prefix = __(\x1b[33m\'\x1b[39;49;00m\x1b[33mwhile setting up extension \x1b[39;49;00m\x1b[33m%s\x1b[39;49;00m\x1b[33m:\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) % extname\x1b[90m\x1b[39;49;00m\n        \x1b[94mwith\x1b[39;49;00m prefixed_warnings(prefix):\x1b[90m\x1b[39;49;00m\n            \x1b[94mtry\x1b[39;49;00m:\x1b[90m\x1b[39;49;00m\n                mod = import_module(extname)\x1b[90m\x1b[39;49;00m\n            \x1b[94mexcept\x1b[39;49;00m \x1b[96mImportError\x1b[39;49;00m \x1b[94mas\x1b[39;49;00m err:\x1b[90m\x1b[39;49;00m\n                logger.verbose(__(\x1b[33m\'\x1b[39;49;00m\x1b[33mOriginal exception:\x1b[39;49;00m\x1b[33m\\n\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) + traceback.format_exc())\x1b[90m\x1b[39;49;00m\n>               \x1b[94mraise\x1b[39;49;00m ExtensionError(__(\x1b[33m\'\x1b[39;49;00m\x1b[33mCould not import extension \x1b[39;49;00m\x1b[33m%s\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) % extname,\x1b[90m\x1b[39;49;00m\n                                     err) \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96merr\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31mE               sphinx.errors.ExtensionError: Could not import extension sphinx.ext.viewcode (exception: No module named \'sphinx.builders.epub\')\x1b[0m\n\n\x1b[1m\x1b[31msphinx/registry.py\x1b[0m:420: ExtensionError\n\x1b[31m\x1b[1m________________ ERROR at setup of test_viewcode_epub_disabled _________________\x1b[0m\n\nself = <sphinx.registry.SphinxComponentRegistry object at 0x7163a307b050>\napp = <[AttributeError("\'NoneType\' object has no attribute \'name\'") raised in repr()] SphinxTestApp object at 0x7163a3082500>\nextname = \'sphinx.ext.viewcode\'\n\n    \x1b[0m\x1b[94mdef\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[92mload_extension\x1b[39;49;00m(\x1b[96mself\x1b[39;49;00m, app: \x1b[33m"\x1b[39;49;00m\x1b[33mSphinx\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m, extname: \x1b[96mstr\x1b[39;49;00m) -> \x1b[94mNone\x1b[39;49;00m:\x1b[90m\x1b[39;49;00m\n    \x1b[90m    \x1b[39;49;00m\x1b[33m"""Load a Sphinx extension."""\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94mif\x1b[39;49;00m extname \x1b[95min\x1b[39;49;00m app.extensions:  \x1b[90m# already loaded\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n            \x1b[94mreturn\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94mif\x1b[39;49;00m extname \x1b[95min\x1b[39;49;00m EXTENSION_BLACKLIST:\x1b[90m\x1b[39;49;00m\n            logger.warning(__(\x1b[33m\'\x1b[39;49;00m\x1b[33mthe extension \x1b[39;49;00m\x1b[33m%r\x1b[39;49;00m\x1b[33m was already merged with Sphinx since \x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                              \x1b[33m\'\x1b[39;49;00m\x1b[33mversion \x1b[39;49;00m\x1b[33m%s\x1b[39;49;00m\x1b[33m; this extension is ignored.\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m),\x1b[90m\x1b[39;49;00m\n                           extname, EXTENSION_BLACKLIST[extname])\x1b[90m\x1b[39;49;00m\n            \x1b[94mreturn\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        \x1b[90m# update loading context\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        prefix = __(\x1b[33m\'\x1b[39;49;00m\x1b[33mwhile setting up extension \x1b[39;49;00m\x1b[33m%s\x1b[39;49;00m\x1b[33m:\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) % extname\x1b[90m\x1b[39;49;00m\n        \x1b[94mwith\x1b[39;49;00m prefixed_warnings(prefix):\x1b[90m\x1b[39;49;00m\n            \x1b[94mtry\x1b[39;49;00m:\x1b[90m\x1b[39;49;00m\n>               mod = import_module(extname)\x1b[90m\x1b[39;49;00m\n\n\x1b[1m\x1b[31msphinx/registry.py\x1b[0m:417: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\x1b[1m\x1b[31m/opt/miniconda3/envs/testbed/lib/python3.9/importlib/__init__.py\x1b[0m:127: in import_module\n    \x1b[0m\x1b[94mreturn\x1b[39;49;00m _bootstrap._gcd_import(name[level:], package, level)\x1b[90m\x1b[39;49;00m\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\n    \x1b[0m\x1b[33m"""\x1b[39;49;00m\n    \x1b[33m    sphinx.ext.viewcode\x1b[39;49;00m\n    \x1b[33m    ~~~~~~~~~~~~~~~~~~~\x1b[39;49;00m\n    \x1b[33m\x1b[39;49;00m\n    \x1b[33m    Add links to module code in Python object descriptions.\x1b[39;49;00m\n    \x1b[33m\x1b[39;49;00m\n    \x1b[33m    :copyright: Copyright 2007-2021 by the Sphinx team, see AUTHORS.\x1b[39;49;00m\n    \x1b[33m    :license: BSD, see LICENSE for details.\x1b[39;49;00m\n    \x1b[33m"""\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n    \x1b[94mimport\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mos\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[94mimport\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mposixpath\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[94mimport\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mshutil\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[94mimport\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mtraceback\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mos\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m path\x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mtyping\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m Any, Dict, Generator, Iterable, Optional, Set, Tuple, cast\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mdocutils\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m nodes\x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mdocutils\x1b[39;49;00m\x1b[04m\x1b[96m.\x1b[39;49;00m\x1b[04m\x1b[96mnodes\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m Element, Node\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n    \x1b[94mimport\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96msphinx\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96msphinx\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m addnodes\x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96msphinx\x1b[39;49;00m\x1b[04m\x1b[96m.\x1b[39;49;00m\x1b[04m\x1b[96mapplication\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m Sphinx\x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96msphinx\x1b[39;49;00m\x1b[04m\x1b[96m.\x1b[39;49;00m\x1b[04m\x1b[96mbuilders\x1b[39;49;00m\x1b[04m\x1b[96m.\x1b[39;49;00m\x1b[04m\x1b[96mhtml\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m StandaloneHTMLBuilder\x1b[90m\x1b[39;49;00m\n>   \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96msphinx\x1b[39;49;00m\x1b[04m\x1b[96m.\x1b[39;49;00m\x1b[04m\x1b[96mbuilders\x1b[39;49;00m\x1b[04m\x1b[96m.\x1b[39;49;00m\x1b[04m\x1b[96mepub\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m EpubBuilder\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31mE   ModuleNotFoundError: No module named \'sphinx.builders.epub\'\x1b[0m\n\n\x1b[1m\x1b[31msphinx/ext/viewcode.py\x1b[0m:25: ModuleNotFoundError\n\n\x1b[33mThe above exception was the direct cause of the following exception:\x1b[0m\n\ntest_params = {\'shared_result\': None}\napp_params = app_params(args=[], kwargs={\'confoverrides\': {\'viewcode_enable_epub\': False}, \'srcdir\': path(\'/tmp/pytest-of-root/pytest-8/ext-viewcode\')})\nmake_app = <function make_app.<locals>.make at 0x7163a301c230>\nshared_result = <sphinx.testing.fixtures.SharedResult object at 0x7163a3082fa0>\n\n    \x1b[0m\x1b[37m@pytest\x1b[39;49;00m.fixture(scope=\x1b[33m\'\x1b[39;49;00m\x1b[33mfunction\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m)\x1b[90m\x1b[39;49;00m\n    \x1b[94mdef\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[92mapp\x1b[39;49;00m(test_params: Dict, app_params: Tuple[Dict, Dict], make_app: Callable,\x1b[90m\x1b[39;49;00m\n            shared_result: SharedResult) -> Generator[SphinxTestApp, \x1b[94mNone\x1b[39;49;00m, \x1b[94mNone\x1b[39;49;00m]:\x1b[90m\x1b[39;49;00m\n    \x1b[90m    \x1b[39;49;00m\x1b[33m"""\x1b[39;49;00m\n    \x1b[33m    provides sphinx.application.Sphinx object\x1b[39;49;00m\n    \x1b[33m    """\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        args, kwargs = app_params\x1b[90m\x1b[39;49;00m\n>       app_ = make_app(*args, **kwargs)\x1b[90m\x1b[39;49;00m\n\n\x1b[1m\x1b[31msphinx/testing/fixtures.py\x1b[0m:149: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\x1b[1m\x1b[31msphinx/testing/fixtures.py\x1b[0m:195: in make\n    \x1b[0mapp_ = SphinxTestApp(*args, **kwargs)  \x1b[90m# type: Any\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31msphinx/testing/util.py\x1b[0m:133: in __init__\n    \x1b[0m\x1b[96msuper\x1b[39;49;00m().\x1b[92m__init__\x1b[39;49;00m(srcdir, confdir, outdir, doctreedir,\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31msphinx/application.py\x1b[0m:245: in __init__\n    \x1b[0m\x1b[96mself\x1b[39;49;00m.setup_extension(extension)\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31msphinx/application.py\x1b[0m:402: in setup_extension\n    \x1b[0m\x1b[96mself\x1b[39;49;00m.registry.load_extension(\x1b[96mself\x1b[39;49;00m, extname)\x1b[90m\x1b[39;49;00m\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <sphinx.registry.SphinxComponentRegistry object at 0x7163a307b050>\napp = <[AttributeError("\'NoneType\' object has no attribute \'name\'") raised in repr()] SphinxTestApp object at 0x7163a3082500>\nextname = \'sphinx.ext.viewcode\'\n\n    \x1b[0m\x1b[94mdef\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[92mload_extension\x1b[39;49;00m(\x1b[96mself\x1b[39;49;00m, app: \x1b[33m"\x1b[39;49;00m\x1b[33mSphinx\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m, extname: \x1b[96mstr\x1b[39;49;00m) -> \x1b[94mNone\x1b[39;49;00m:\x1b[90m\x1b[39;49;00m\n    \x1b[90m    \x1b[39;49;00m\x1b[33m"""Load a Sphinx extension."""\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94mif\x1b[39;49;00m extname \x1b[95min\x1b[39;49;00m app.extensions:  \x1b[90m# already loaded\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n            \x1b[94mreturn\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94mif\x1b[39;49;00m extname \x1b[95min\x1b[39;49;00m EXTENSION_BLACKLIST:\x1b[90m\x1b[39;49;00m\n            logger.warning(__(\x1b[33m\'\x1b[39;49;00m\x1b[33mthe extension \x1b[39;49;00m\x1b[33m%r\x1b[39;49;00m\x1b[33m was already merged with Sphinx since \x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                              \x1b[33m\'\x1b[39;49;00m\x1b[33mversion \x1b[39;49;00m\x1b[33m%s\x1b[39;49;00m\x1b[33m; this extension is ignored.\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m),\x1b[90m\x1b[39;49;00m\n                           extname, EXTENSION_BLACKLIST[extname])\x1b[90m\x1b[39;49;00m\n            \x1b[94mreturn\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        \x1b[90m# update loading context\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        prefix = __(\x1b[33m\'\x1b[39;49;00m\x1b[33mwhile setting up extension \x1b[39;49;00m\x1b[33m%s\x1b[39;49;00m\x1b[33m:\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) % extname\x1b[90m\x1b[39;49;00m\n        \x1b[94mwith\x1b[39;49;00m prefixed_warnings(prefix):\x1b[90m\x1b[39;49;00m\n            \x1b[94mtry\x1b[39;49;00m:\x1b[90m\x1b[39;49;00m\n                mod = import_module(extname)\x1b[90m\x1b[39;49;00m\n            \x1b[94mexcept\x1b[39;49;00m \x1b[96mImportError\x1b[39;49;00m \x1b[94mas\x1b[39;49;00m err:\x1b[90m\x1b[39;49;00m\n                logger.verbose(__(\x1b[33m\'\x1b[39;49;00m\x1b[33mOriginal exception:\x1b[39;49;00m\x1b[33m\\n\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) + traceback.format_exc())\x1b[90m\x1b[39;49;00m\n>               \x1b[94mraise\x1b[39;49;00m ExtensionError(__(\x1b[33m\'\x1b[39;49;00m\x1b[33mCould not import extension \x1b[39;49;00m\x1b[33m%s\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) % extname,\x1b[90m\x1b[39;49;00m\n                                     err) \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96merr\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31mE               sphinx.errors.ExtensionError: Could not import extension sphinx.ext.viewcode (exception: No module named \'sphinx.builders.epub\')\x1b[0m\n\n\x1b[1m\x1b[31msphinx/registry.py\x1b[0m:420: ExtensionError\n\x1b[31m\x1b[1m_________________ ERROR at setup of test_viewcode_epub_enabled _________________\x1b[0m\n\nself = <sphinx.registry.SphinxComponentRegistry object at 0x7163a31e4500>\napp = <[AttributeError("\'NoneType\' object has no attribute \'name\'") raised in repr()] SphinxTestApp object at 0x7163a31b0c30>\nextname = \'sphinx.ext.viewcode\'\n\n    \x1b[0m\x1b[94mdef\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[92mload_extension\x1b[39;49;00m(\x1b[96mself\x1b[39;49;00m, app: \x1b[33m"\x1b[39;49;00m\x1b[33mSphinx\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m, extname: \x1b[96mstr\x1b[39;49;00m) -> \x1b[94mNone\x1b[39;49;00m:\x1b[90m\x1b[39;49;00m\n    \x1b[90m    \x1b[39;49;00m\x1b[33m"""Load a Sphinx extension."""\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94mif\x1b[39;49;00m extname \x1b[95min\x1b[39;49;00m app.extensions:  \x1b[90m# already loaded\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n            \x1b[94mreturn\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94mif\x1b[39;49;00m extname \x1b[95min\x1b[39;49;00m EXTENSION_BLACKLIST:\x1b[90m\x1b[39;49;00m\n            logger.warning(__(\x1b[33m\'\x1b[39;49;00m\x1b[33mthe extension \x1b[39;49;00m\x1b[33m%r\x1b[39;49;00m\x1b[33m was already merged with Sphinx since \x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                              \x1b[33m\'\x1b[39;49;00m\x1b[33mversion \x1b[39;49;00m\x1b[33m%s\x1b[39;49;00m\x1b[33m; this extension is ignored.\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m),\x1b[90m\x1b[39;49;00m\n                           extname, EXTENSION_BLACKLIST[extname])\x1b[90m\x1b[39;49;00m\n            \x1b[94mreturn\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        \x1b[90m# update loading context\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        prefix = __(\x1b[33m\'\x1b[39;49;00m\x1b[33mwhile setting up extension \x1b[39;49;00m\x1b[33m%s\x1b[39;49;00m\x1b[33m:\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) % extname\x1b[90m\x1b[39;49;00m\n        \x1b[94mwith\x1b[39;49;00m prefixed_warnings(prefix):\x1b[90m\x1b[39;49;00m\n            \x1b[94mtry\x1b[39;49;00m:\x1b[90m\x1b[39;49;00m\n>               mod = import_module(extname)\x1b[90m\x1b[39;49;00m\n\n\x1b[1m\x1b[31msphinx/registry.py\x1b[0m:417: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\x1b[1m\x1b[31m/opt/miniconda3/envs/testbed/lib/python3.9/importlib/__init__.py\x1b[0m:127: in import_module\n    \x1b[0m\x1b[94mreturn\x1b[39;49;00m _bootstrap._gcd_import(name[level:], package, level)\x1b[90m\x1b[39;49;00m\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\n    \x1b[0m\x1b[33m"""\x1b[39;49;00m\n    \x1b[33m    sphinx.ext.viewcode\x1b[39;49;00m\n    \x1b[33m    ~~~~~~~~~~~~~~~~~~~\x1b[39;49;00m\n    \x1b[33m\x1b[39;49;00m\n    \x1b[33m    Add links to module code in Python object descriptions.\x1b[39;49;00m\n    \x1b[33m\x1b[39;49;00m\n    \x1b[33m    :copyright: Copyright 2007-2021 by the Sphinx team, see AUTHORS.\x1b[39;49;00m\n    \x1b[33m    :license: BSD, see LICENSE for details.\x1b[39;49;00m\n    \x1b[33m"""\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n    \x1b[94mimport\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mos\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[94mimport\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mposixpath\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[94mimport\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mshutil\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[94mimport\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mtraceback\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mos\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m path\x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mtyping\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m Any, Dict, Generator, Iterable, Optional, Set, Tuple, cast\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mdocutils\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m nodes\x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mdocutils\x1b[39;49;00m\x1b[04m\x1b[96m.\x1b[39;49;00m\x1b[04m\x1b[96mnodes\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m Element, Node\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n    \x1b[94mimport\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96msphinx\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96msphinx\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m addnodes\x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96msphinx\x1b[39;49;00m\x1b[04m\x1b[96m.\x1b[39;49;00m\x1b[04m\x1b[96mapplication\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m Sphinx\x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96msphinx\x1b[39;49;00m\x1b[04m\x1b[96m.\x1b[39;49;00m\x1b[04m\x1b[96mbuilders\x1b[39;49;00m\x1b[04m\x1b[96m.\x1b[39;49;00m\x1b[04m\x1b[96mhtml\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m StandaloneHTMLBuilder\x1b[90m\x1b[39;49;00m\n>   \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96msphinx\x1b[39;49;00m\x1b[04m\x1b[96m.\x1b[39;49;00m\x1b[04m\x1b[96mbuilders\x1b[39;49;00m\x1b[04m\x1b[96m.\x1b[39;49;00m\x1b[04m\x1b[96mepub\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m EpubBuilder\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31mE   ModuleNotFoundError: No module named \'sphinx.builders.epub\'\x1b[0m\n\n\x1b[1m\x1b[31msphinx/ext/viewcode.py\x1b[0m:25: ModuleNotFoundError\n\n\x1b[33mThe above exception was the direct cause of the following exception:\x1b[0m\n\ntest_params = {\'shared_result\': None}\napp_params = app_params(args=[], kwargs={\'confoverrides\': {\'viewcode_enable_epub\': True}, \'srcdir\': path(\'/tmp/pytest-of-root/pytest-8/ext-viewcode\')})\nmake_app = <function make_app.<locals>.make at 0x7163a3201f50>\nshared_result = <sphinx.testing.fixtures.SharedResult object at 0x7163a31b0410>\n\n    \x1b[0m\x1b[37m@pytest\x1b[39;49;00m.fixture(scope=\x1b[33m\'\x1b[39;49;00m\x1b[33mfunction\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m)\x1b[90m\x1b[39;49;00m\n    \x1b[94mdef\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[92mapp\x1b[39;49;00m(test_params: Dict, app_params: Tuple[Dict, Dict], make_app: Callable,\x1b[90m\x1b[39;49;00m\n            shared_result: SharedResult) -> Generator[SphinxTestApp, \x1b[94mNone\x1b[39;49;00m, \x1b[94mNone\x1b[39;49;00m]:\x1b[90m\x1b[39;49;00m\n    \x1b[90m    \x1b[39;49;00m\x1b[33m"""\x1b[39;49;00m\n    \x1b[33m    provides sphinx.application.Sphinx object\x1b[39;49;00m\n    \x1b[33m    """\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        args, kwargs = app_params\x1b[90m\x1b[39;49;00m\n>       app_ = make_app(*args, **kwargs)\x1b[90m\x1b[39;49;00m\n\n\x1b[1m\x1b[31msphinx/testing/fixtures.py\x1b[0m:149: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\x1b[1m\x1b[31msphinx/testing/fixtures.py\x1b[0m:195: in make\n    \x1b[0mapp_ = SphinxTestApp(*args, **kwargs)  \x1b[90m# type: Any\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31msphinx/testing/util.py\x1b[0m:133: in __init__\n    \x1b[0m\x1b[96msuper\x1b[39;49;00m().\x1b[92m__init__\x1b[39;49;00m(srcdir, confdir, outdir, doctreedir,\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31msphinx/application.py\x1b[0m:245: in __init__\n    \x1b[0m\x1b[96mself\x1b[39;49;00m.setup_extension(extension)\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31msphinx/application.py\x1b[0m:402: in setup_extension\n    \x1b[0m\x1b[96mself\x1b[39;49;00m.registry.load_extension(\x1b[96mself\x1b[39;49;00m, extname)\x1b[90m\x1b[39;49;00m\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <sphinx.registry.SphinxComponentRegistry object at 0x7163a31e4500>\napp = <[AttributeError("\'NoneType\' object has no attribute \'name\'") raised in repr()] SphinxTestApp object at 0x7163a31b0c30>\nextname = \'sphinx.ext.viewcode\'\n\n    \x1b[0m\x1b[94mdef\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[92mload_extension\x1b[39;49;00m(\x1b[96mself\x1b[39;49;00m, app: \x1b[33m"\x1b[39;49;00m\x1b[33mSphinx\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m, extname: \x1b[96mstr\x1b[39;49;00m) -> \x1b[94mNone\x1b[39;49;00m:\x1b[90m\x1b[39;49;00m\n    \x1b[90m    \x1b[39;49;00m\x1b[33m"""Load a Sphinx extension."""\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94mif\x1b[39;49;00m extname \x1b[95min\x1b[39;49;00m app.extensions:  \x1b[90m# already loaded\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n            \x1b[94mreturn\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94mif\x1b[39;49;00m extname \x1b[95min\x1b[39;49;00m EXTENSION_BLACKLIST:\x1b[90m\x1b[39;49;00m\n            logger.warning(__(\x1b[33m\'\x1b[39;49;00m\x1b[33mthe extension \x1b[39;49;00m\x1b[33m%r\x1b[39;49;00m\x1b[33m was already merged with Sphinx since \x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                              \x1b[33m\'\x1b[39;49;00m\x1b[33mversion \x1b[39;49;00m\x1b[33m%s\x1b[39;49;00m\x1b[33m; this extension is ignored.\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m),\x1b[90m\x1b[39;49;00m\n                           extname, EXTENSION_BLACKLIST[extname])\x1b[90m\x1b[39;49;00m\n            \x1b[94mreturn\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        \x1b[90m# update loading context\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        prefix = __(\x1b[33m\'\x1b[39;49;00m\x1b[33mwhile setting up extension \x1b[39;49;00m\x1b[33m%s\x1b[39;49;00m\x1b[33m:\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) % extname\x1b[90m\x1b[39;49;00m\n        \x1b[94mwith\x1b[39;49;00m prefixed_warnings(prefix):\x1b[90m\x1b[39;49;00m\n            \x1b[94mtry\x1b[39;49;00m:\x1b[90m\x1b[39;49;00m\n                mod = import_module(extname)\x1b[90m\x1b[39;49;00m\n            \x1b[94mexcept\x1b[39;49;00m \x1b[96mImportError\x1b[39;49;00m \x1b[94mas\x1b[39;49;00m err:\x1b[90m\x1b[39;49;00m\n                logger.verbose(__(\x1b[33m\'\x1b[39;49;00m\x1b[33mOriginal exception:\x1b[39;49;00m\x1b[33m\\n\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) + traceback.format_exc())\x1b[90m\x1b[39;49;00m\n>               \x1b[94mraise\x1b[39;49;00m ExtensionError(__(\x1b[33m\'\x1b[39;49;00m\x1b[33mCould not import extension \x1b[39;49;00m\x1b[33m%s\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) % extname,\x1b[90m\x1b[39;49;00m\n                                     err) \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96merr\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31mE               sphinx.errors.ExtensionError: Could not import extension sphinx.ext.viewcode (exception: No module named \'sphinx.builders.epub\')\x1b[0m\n\n\x1b[1m\x1b[31msphinx/registry.py\x1b[0m:420: ExtensionError\n\x1b[31m\x1b[1m__________________ ERROR at setup of test_local_source_files ___________________\x1b[0m\n\nself = <sphinx.registry.SphinxComponentRegistry object at 0x7163a2cbdd70>\napp = <[AttributeError("\'NoneType\' object has no attribute \'name\'") raised in repr()] SphinxTestApp object at 0x7163a2cbdf50>\nextname = \'sphinx.ext.viewcode\'\n\n    \x1b[0m\x1b[94mdef\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[92mload_extension\x1b[39;49;00m(\x1b[96mself\x1b[39;49;00m, app: \x1b[33m"\x1b[39;49;00m\x1b[33mSphinx\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m, extname: \x1b[96mstr\x1b[39;49;00m) -> \x1b[94mNone\x1b[39;49;00m:\x1b[90m\x1b[39;49;00m\n    \x1b[90m    \x1b[39;49;00m\x1b[33m"""Load a Sphinx extension."""\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94mif\x1b[39;49;00m extname \x1b[95min\x1b[39;49;00m app.extensions:  \x1b[90m# already loaded\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n            \x1b[94mreturn\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94mif\x1b[39;49;00m extname \x1b[95min\x1b[39;49;00m EXTENSION_BLACKLIST:\x1b[90m\x1b[39;49;00m\n            logger.warning(__(\x1b[33m\'\x1b[39;49;00m\x1b[33mthe extension \x1b[39;49;00m\x1b[33m%r\x1b[39;49;00m\x1b[33m was already merged with Sphinx since \x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                              \x1b[33m\'\x1b[39;49;00m\x1b[33mversion \x1b[39;49;00m\x1b[33m%s\x1b[39;49;00m\x1b[33m; this extension is ignored.\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m),\x1b[90m\x1b[39;49;00m\n                           extname, EXTENSION_BLACKLIST[extname])\x1b[90m\x1b[39;49;00m\n            \x1b[94mreturn\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        \x1b[90m# update loading context\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        prefix = __(\x1b[33m\'\x1b[39;49;00m\x1b[33mwhile setting up extension \x1b[39;49;00m\x1b[33m%s\x1b[39;49;00m\x1b[33m:\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) % extname\x1b[90m\x1b[39;49;00m\n        \x1b[94mwith\x1b[39;49;00m prefixed_warnings(prefix):\x1b[90m\x1b[39;49;00m\n            \x1b[94mtry\x1b[39;49;00m:\x1b[90m\x1b[39;49;00m\n>               mod = import_module(extname)\x1b[90m\x1b[39;49;00m\n\n\x1b[1m\x1b[31msphinx/registry.py\x1b[0m:417: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\x1b[1m\x1b[31m/opt/miniconda3/envs/testbed/lib/python3.9/importlib/__init__.py\x1b[0m:127: in import_module\n    \x1b[0m\x1b[94mreturn\x1b[39;49;00m _bootstrap._gcd_import(name[level:], package, level)\x1b[90m\x1b[39;49;00m\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\n    \x1b[0m\x1b[33m"""\x1b[39;49;00m\n    \x1b[33m    sphinx.ext.viewcode\x1b[39;49;00m\n    \x1b[33m    ~~~~~~~~~~~~~~~~~~~\x1b[39;49;00m\n    \x1b[33m\x1b[39;49;00m\n    \x1b[33m    Add links to module code in Python object descriptions.\x1b[39;49;00m\n    \x1b[33m\x1b[39;49;00m\n    \x1b[33m    :copyright: Copyright 2007-2021 by the Sphinx team, see AUTHORS.\x1b[39;49;00m\n    \x1b[33m    :license: BSD, see LICENSE for details.\x1b[39;49;00m\n    \x1b[33m"""\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n    \x1b[94mimport\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mos\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[94mimport\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mposixpath\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[94mimport\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mshutil\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[94mimport\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mtraceback\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mos\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m path\x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mtyping\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m Any, Dict, Generator, Iterable, Optional, Set, Tuple, cast\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mdocutils\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m nodes\x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96mdocutils\x1b[39;49;00m\x1b[04m\x1b[96m.\x1b[39;49;00m\x1b[04m\x1b[96mnodes\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m Element, Node\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n    \x1b[94mimport\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96msphinx\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96msphinx\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m addnodes\x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96msphinx\x1b[39;49;00m\x1b[04m\x1b[96m.\x1b[39;49;00m\x1b[04m\x1b[96mapplication\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m Sphinx\x1b[90m\x1b[39;49;00m\n    \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96msphinx\x1b[39;49;00m\x1b[04m\x1b[96m.\x1b[39;49;00m\x1b[04m\x1b[96mbuilders\x1b[39;49;00m\x1b[04m\x1b[96m.\x1b[39;49;00m\x1b[04m\x1b[96mhtml\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m StandaloneHTMLBuilder\x1b[90m\x1b[39;49;00m\n>   \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96msphinx\x1b[39;49;00m\x1b[04m\x1b[96m.\x1b[39;49;00m\x1b[04m\x1b[96mbuilders\x1b[39;49;00m\x1b[04m\x1b[96m.\x1b[39;49;00m\x1b[04m\x1b[96mepub\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[94mimport\x1b[39;49;00m EpubBuilder\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31mE   ModuleNotFoundError: No module named \'sphinx.builders.epub\'\x1b[0m\n\n\x1b[1m\x1b[31msphinx/ext/viewcode.py\x1b[0m:25: ModuleNotFoundError\n\n\x1b[33mThe above exception was the direct cause of the following exception:\x1b[0m\n\ntest_params = {\'shared_result\': None}\napp_params = app_params(args=[], kwargs={\'srcdir\': path(\'/tmp/pytest-of-root/pytest-8/ext-viewcode-find\')})\nmake_app = <function make_app.<locals>.make at 0x7163a2b06b90>\nshared_result = <sphinx.testing.fixtures.SharedResult object at 0x7163a2a7b280>\n\n    \x1b[0m\x1b[37m@pytest\x1b[39;49;00m.fixture(scope=\x1b[33m\'\x1b[39;49;00m\x1b[33mfunction\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m)\x1b[90m\x1b[39;49;00m\n    \x1b[94mdef\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[92mapp\x1b[39;49;00m(test_params: Dict, app_params: Tuple[Dict, Dict], make_app: Callable,\x1b[90m\x1b[39;49;00m\n            shared_result: SharedResult) -> Generator[SphinxTestApp, \x1b[94mNone\x1b[39;49;00m, \x1b[94mNone\x1b[39;49;00m]:\x1b[90m\x1b[39;49;00m\n    \x1b[90m    \x1b[39;49;00m\x1b[33m"""\x1b[39;49;00m\n    \x1b[33m    provides sphinx.application.Sphinx object\x1b[39;49;00m\n    \x1b[33m    """\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        args, kwargs = app_params\x1b[90m\x1b[39;49;00m\n>       app_ = make_app(*args, **kwargs)\x1b[90m\x1b[39;49;00m\n\n\x1b[1m\x1b[31msphinx/testing/fixtures.py\x1b[0m:149: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\x1b[1m\x1b[31msphinx/testing/fixtures.py\x1b[0m:195: in make\n    \x1b[0mapp_ = SphinxTestApp(*args, **kwargs)  \x1b[90m# type: Any\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31msphinx/testing/util.py\x1b[0m:133: in __init__\n    \x1b[0m\x1b[96msuper\x1b[39;49;00m().\x1b[92m__init__\x1b[39;49;00m(srcdir, confdir, outdir, doctreedir,\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31msphinx/application.py\x1b[0m:245: in __init__\n    \x1b[0m\x1b[96mself\x1b[39;49;00m.setup_extension(extension)\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31msphinx/application.py\x1b[0m:402: in setup_extension\n    \x1b[0m\x1b[96mself\x1b[39;49;00m.registry.load_extension(\x1b[96mself\x1b[39;49;00m, extname)\x1b[90m\x1b[39;49;00m\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <sphinx.registry.SphinxComponentRegistry object at 0x7163a2cbdd70>\napp = <[AttributeError("\'NoneType\' object has no attribute \'name\'") raised in repr()] SphinxTestApp object at 0x7163a2cbdf50>\nextname = \'sphinx.ext.viewcode\'\n\n    \x1b[0m\x1b[94mdef\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[92mload_extension\x1b[39;49;00m(\x1b[96mself\x1b[39;49;00m, app: \x1b[33m"\x1b[39;49;00m\x1b[33mSphinx\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m, extname: \x1b[96mstr\x1b[39;49;00m) -> \x1b[94mNone\x1b[39;49;00m:\x1b[90m\x1b[39;49;00m\n    \x1b[90m    \x1b[39;49;00m\x1b[33m"""Load a Sphinx extension."""\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94mif\x1b[39;49;00m extname \x1b[95min\x1b[39;49;00m app.extensions:  \x1b[90m# already loaded\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n            \x1b[94mreturn\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94mif\x1b[39;49;00m extname \x1b[95min\x1b[39;49;00m EXTENSION_BLACKLIST:\x1b[90m\x1b[39;49;00m\n            logger.warning(__(\x1b[33m\'\x1b[39;49;00m\x1b[33mthe extension \x1b[39;49;00m\x1b[33m%r\x1b[39;49;00m\x1b[33m was already merged with Sphinx since \x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                              \x1b[33m\'\x1b[39;49;00m\x1b[33mversion \x1b[39;49;00m\x1b[33m%s\x1b[39;49;00m\x1b[33m; this extension is ignored.\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m),\x1b[90m\x1b[39;49;00m\n                           extname, EXTENSION_BLACKLIST[extname])\x1b[90m\x1b[39;49;00m\n            \x1b[94mreturn\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        \x1b[90m# update loading context\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        prefix = __(\x1b[33m\'\x1b[39;49;00m\x1b[33mwhile setting up extension \x1b[39;49;00m\x1b[33m%s\x1b[39;49;00m\x1b[33m:\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) % extname\x1b[90m\x1b[39;49;00m\n        \x1b[94mwith\x1b[39;49;00m prefixed_warnings(prefix):\x1b[90m\x1b[39;49;00m\n            \x1b[94mtry\x1b[39;49;00m:\x1b[90m\x1b[39;49;00m\n                mod = import_module(extname)\x1b[90m\x1b[39;49;00m\n            \x1b[94mexcept\x1b[39;49;00m \x1b[96mImportError\x1b[39;49;00m \x1b[94mas\x1b[39;49;00m err:\x1b[90m\x1b[39;49;00m\n                logger.verbose(__(\x1b[33m\'\x1b[39;49;00m\x1b[33mOriginal exception:\x1b[39;49;00m\x1b[33m\\n\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) + traceback.format_exc())\x1b[90m\x1b[39;49;00m\n>               \x1b[94mraise\x1b[39;49;00m ExtensionError(__(\x1b[33m\'\x1b[39;49;00m\x1b[33mCould not import extension \x1b[39;49;00m\x1b[33m%s\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) % extname,\x1b[90m\x1b[39;49;00m\n                                     err) \x1b[94mfrom\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[04m\x1b[96merr\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31mE               sphinx.errors.ExtensionError: Could not import extension sphinx.ext.viewcode (exception: No module named \'sphinx.builders.epub\')\x1b[0m\n\n\x1b[1m\x1b[31msphinx/registry.py\x1b[0m:420: ExtensionError\n\x1b[33m=============================== warnings summary ===============================\x1b[0m\nsphinx/util/docutils.py:45\n  /testbed/sphinx/util/docutils.py:45: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.\n    __version_info__ = tuple(LooseVersion(docutils.__version__).version)\n\nsphinx/registry.py:22\n  /testbed/sphinx/registry.py:22: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n    from pkg_resources import iter_entry_points\n\n../opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pkg_resources/__init__.py:3142\n../opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pkg_resources/__init__.py:3142\n../opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pkg_resources/__init__.py:3142\n../opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pkg_resources/__init__.py:3142\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pkg_resources/__init__.py:3142: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace(\'sphinxcontrib\')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n    declare_namespace(pkg)\n\nsphinx/directives/patches.py:14\n  /testbed/sphinx/directives/patches.py:14: DeprecationWarning: The `docutils.parsers.rst.directive.html` module will be removed in Docutils 2.0. Since Docutils 0.18, the "Meta" node is defined in `docutils.parsers.rst.directives.misc`.\n    from docutils.parsers.rst.directives import html, images, tables\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/__init__.py:210: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse():  # type: Node\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/i18n.py:95: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.translatable):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/__init__.py:110: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for ref in self.document.traverse(nodes.substitution_reference):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/__init__.py:131: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.target):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/__init__.py:150: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.block_quote):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/__init__.py:175: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.Element):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/__init__.py:222: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.index):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/__init__.py:189: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.section):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/__init__.py:279: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.doctest_block):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/domains/citation.py:116: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.citation):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/domains/citation.py:135: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.citation_reference):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/builders/latex/transforms.py:36: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(matcher):  # type: nodes.Element\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/__init__.py:291: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(matcher):  # type: Element\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/util/compat.py:44: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.index):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/domains/index.py:51: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in document.traverse(addnodes.index):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/domains/math.py:84: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    self.data[\'has_equations\'][docname] = any(document.traverse(math_node))\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/environment/collectors/asset.py:46: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in doctree.traverse(nodes.image):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/environment/collectors/asset.py:127: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in doctree.traverse(addnodes.download_reference):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/environment/collectors/title.py:46: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in doctree.traverse(nodes.section):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/ext/linkcode.py:42: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for objnode in doctree.traverse(addnodes.desc):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/__init__.py:301: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.system_message):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/__init__.py:390: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.manpage):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/i18n.py:488: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for inline in self.document.traverse(matcher):  # type: nodes.inline\n\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/domains/python.py:283: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in result.traverse(nodes.Text):\n\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/builders/html/__init__.py:422: DeprecationWarning: The frontend.OptionParser class will be replaced by a subclass of argparse.ArgumentParser in Docutils 0.21 or later.\n    self.docsettings = OptionParser(\n\ntests/test_ext_viewcode.py: 72 warnings\n  /opt/miniconda3/envs/testbed/lib/python3.9/optparse.py:1000: DeprecationWarning: The frontend.Option class will be removed in Docutils 0.21 or later.\n    option = self.option_class(*args, **kwargs)\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/domains/c.py:3494: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(AliasNode):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/domains/cpp.py:7070: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(AliasNode):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/post_transforms/__init__.py:69: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.pending_xref):\n\ntests/test_ext_viewcode.py: 10 warnings\n  /testbed/sphinx/util/nodes.py:598: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in document.traverse(addnodes.only):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/post_transforms/images.py:33: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.image):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/post_transforms/__init__.py:216: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.desc_sig_element):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/builders/latex/transforms.py:48: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.substitution_definition):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/builders/html/transforms.py:44: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(matcher):  # type: nodes.literal\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/builders/latex/transforms.py:606: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.title):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/builders/latex/transforms.py:608: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for i, index in enumerate(node.traverse(addnodes.index)):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/post_transforms/code.py:43: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.highlightlang):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/post_transforms/code.py:95: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for lbnode in self.document.traverse(nodes.literal_block):  # type: nodes.literal_block\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/transforms/post_transforms/code.py:99: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for dbnode in self.document.traverse(nodes.doctest_block):  # type: nodes.doctest_block\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/environment/__init__.py:541: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for toctreenode in doctree.traverse(addnodes.toctree):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/environment/adapters/toctree.py:203: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for subtocnode in toc.traverse(addnodes.toctree):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/environment/adapters/toctree.py:261: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for refnode in newnode.traverse(nodes.reference):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/builders/__init__.py:181: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in doctree.traverse(nodes.image):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/builders/html/__init__.py:844: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in doctree.traverse(nodes.image):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/environment/adapters/toctree.py:312: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in toc.traverse(nodes.reference):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/alabaster/layout.html:114: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n    _gaq.push([\'_setAllowLinker\', true]);\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/alabaster/about.html:70: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/alabaster/about.html:99: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/environment/adapters/toctree.py:328: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for toctreenode in doctree.traverse(addnodes.toctree):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/alabaster/layout.html:215: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/alabaster/layout.html:238: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py::test_linkcode\n  <template>:33: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py::test_linkcode\n  <template>:224: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py::test_linkcode\n  <template>:386: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py::test_linkcode\n  <template>:401: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/util/nodes.py:350: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for img in node.traverse(nodes.image):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/util/nodes.py:352: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for raw in node.traverse(nodes.raw):\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n==================================== PASSES ====================================\n--------------------------- Captured stdout teardown ---------------------------\n# testroot: root\n# builder: html\n# srcdir: /tmp/pytest-of-root/pytest-8/ext-viewcode\n# outdir: /tmp/pytest-of-root/pytest-8/ext-viewcode/_build/html\n# status: \n\x1b[01mRunning Sphinx v3.5.0+/82ef497a8\x1b[39;49;00m\n\x1b[01mupdating environment: \x1b[39;49;00m[new config] 2 added, 0 changed, 0 removed\n\x1b[01mreading sources... \x1b[39;49;00m[ 50%] \x1b[35mindex\x1b[39;49;00m                                                \r\x1b[01mreading sources... \x1b[39;49;00m[100%] \x1b[35mobjects\x1b[39;49;00m                                              \r\n\x1b[01mlooking for now-outdated files... \x1b[39;49;00mnone found\n\x1b[01mpickling environment... \x1b[39;49;00mdone\n\x1b[01mchecking consistency... \x1b[39;49;00mdone\n\x1b[01mpreparing documents... \x1b[39;49;00mdone\n\x1b[01mwriting output... \x1b[39;49;00m[ 50%] \x1b[32mindex\x1b[39;49;00m                                                 \r\x1b[01mwriting output... \x1b[39;49;00m[100%] \x1b[32mobjects\x1b[39;49;00m                                               \r\n\x1b[01mgenerating indices... \x1b[39;49;00mgenindex py-modindex done\n\x1b[01mwriting additional pages... \x1b[39;49;00msearch done\n\x1b[01mcopying static files... \x1b[39;49;00mdone\n\x1b[01mcopying extra files... \x1b[39;49;00mdone\n\x1b[01mdumping search index in English (code: en)... \x1b[39;49;00mdone\n\x1b[01mdumping object inventory... \x1b[39;49;00mdone\n\n# warning: \n\x1b[91mWARNING: while setting up extension sphinx.addnodes: node class \'meta\' is already registered, its visitors will be overridden\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-8/ext-viewcode/index.rst:23: WARNING: Object named \'func1\' not found in include file \'/tmp/pytest-of-root/pytest-8/ext-viewcode/spam/__init__.py\'\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-8/ext-viewcode/spam/mod1.py:docstring of spam.mod1.Class3:1: WARNING: duplicate object description of spam.mod3.Class3, other instance in index, use :noindex: for one of them\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-8/ext-viewcode/spam/mod1.py:docstring of spam.mod3.Class3.class_attr:1: WARNING: duplicate object description of spam.mod3.Class3.class_attr, other instance in index, use :noindex: for one of them\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-8/ext-viewcode/objects.rst:84: WARNING: Error in declarator\nIf declarator-id with parameters (e.g., \'void f(int arg)\'):\n  Invalid C declaration: Expected identifier in nested name. [error at 18]\n    Sphinx_DoSomething()\n    ------------------^\nIf parenthesis in noptr-declarator (e.g., \'void (*f(int arg))(double)\'):\n  Error in declarator or parameters\n  Invalid C declaration: Expected identifier in nested name. [error at 19]\n    Sphinx_DoSomething()\n    -------------------^\n\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-8/ext-viewcode/objects.rst:86: WARNING: Error in declarator or parameters\nInvalid C declaration: Expected identifier in nested name. [error at 19]\n  SphinxStruct.member\n  -------------------^\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-8/ext-viewcode/objects.rst:92: WARNING: Error in declarator or parameters\nInvalid C declaration: Expected identifier in nested name. [error at 13]\n  sphinx_global\n  -------------^\x1b[39;49;00m\n\x1b[31m/tmp/pytest-of-root/pytest-8/ext-viewcode/objects.rst:155: WARNING: Unknown directive type "userdesc".\n\n.. userdesc:: myobj:parameter\n\n   Description of userdesc.\x1b[39;49;00m\n\x1b[31m/tmp/pytest-of-root/pytest-8/ext-viewcode/objects.rst:160: WARNING: Unknown interpreted text role "userdescrole".\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-8/ext-viewcode/objects.rst:166: WARNING: Too many template argument lists compared to parameter lists. Argument lists: 1, Parameter lists: 0, Extra empty parameters lists prepended: 1. Declaration:\n\tn::Array<T, d>\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-8/ext-viewcode/objects.rst:117: WARNING: Unparseable C cross-reference: \'SphinxType *\'\nInvalid C declaration: Expected end of definition. [error at 11]\n  SphinxType *\n  -----------^\x1b[39;49;00m\n\n============================= slowest 25 durations =============================\n0.33s call     tests/test_ext_viewcode.py::test_linkcode\n0.15s setup    tests/test_ext_viewcode.py::test_viewcode\n0.03s setup    tests/test_ext_viewcode.py::test_local_source_files\n0.01s setup    tests/test_ext_viewcode.py::test_linkcode\n0.01s setup    tests/test_ext_viewcode.py::test_viewcode_epub_disabled\n0.01s setup    tests/test_ext_viewcode.py::test_viewcode_epub_enabled\n\n(5 durations < 0.005s hidden.  Use -vv to show these durations.)\n\x1b[36m\x1b[1m=========================== short test summary info ============================\x1b[0m\n\x1b[32mPASSED\x1b[0m tests/test_ext_viewcode.py::\x1b[1mtest_linkcode\x1b[0m\n\x1b[31mERROR\x1b[0m tests/test_ext_viewcode.py::\x1b[1mtest_viewcode\x1b[0m - sphinx.errors.ExtensionError: Could not import extension sphinx.ext.viewcod...\n\x1b[31mERROR\x1b[0m tests/test_ext_viewcode.py::\x1b[1mtest_viewcode_epub_disabled\x1b[0m - sphinx.errors.ExtensionError: Could not import extension sphinx.ext.viewcod...\n\x1b[31mERROR\x1b[0m tests/test_ext_viewcode.py::\x1b[1mtest_viewcode_epub_enabled\x1b[0m - sphinx.errors.ExtensionError: Could not import extension sphinx.ext.viewcod...\n\x1b[31mERROR\x1b[0m tests/test_ext_viewcode.py::\x1b[1mtest_local_source_files\x1b[0m - sphinx.errors.ExtensionError: Could not import extension sphinx.ext.viewcod...\n\x1b[31m================== \x1b[32m1 passed\x1b[0m, \x1b[33m231 warnings\x1b[0m, \x1b[31m\x1b[1m4 errors\x1b[0m\x1b[31m in 0.85s\x1b[0m\x1b[31m ===================\x1b[0m\npy39: exit 1 (1.33 seconds) /testbed> python -X dev -m pytest -rA --durations 25 tests/test_ext_viewcode.py pid=783\n  py39: FAIL code 1 (1.34=setup[0.01]+cmd[1.33] seconds)\n  evaluation failed :( (1.43 seconds)'}]}, {'role': 'assistant', 'content': [{'type': 'text', 'text': "It seems that I was wrong in my approach. The version of Sphinx being used doesn't have `sphinx.builders.epub` module. Let's modify our approach to check the builder name instead:"}, {'type': 'text', 'text': '<tool_use>\n{\'tool_name\': editor, \'tool_input\': {\'command\': \'edit\', \'path\': \'/testbed/sphinx/ext/viewcode.py\', \'file_text\': \'"""\\n    sphinx.ext.viewcode\\n    ~~~~~~~~~~~~~~~~~~~\\n\\n    Add links to module code in Python object descriptions.\\n\\n    :copyright: Copyright 2007-2021 by the Sphinx team, see AUTHORS.\\n    :license: BSD, see LICENSE for details.\\n"""\\n\\nimport os\\nimport posixpath\\nimport shutil\\nimport traceback\\nfrom os import path\\nfrom typing import Any, Dict, Generator, Iterable, Optional, Set, Tuple, cast\\n\\nfrom docutils import nodes\\nfrom docutils.nodes import Element, Node\\n\\nimport sphinx\\nfrom sphinx import addnodes\\nfrom sphinx.application import Sphinx\\nfrom sphinx.builders.html import StandaloneHTMLBuilder\\nfrom sphinx.environment import BuildEnvironment\\nfrom sphinx.locale import _, __\\nfrom sphinx.pycode import ModuleAnalyzer\\nfrom sphinx.util import get_full_modname, logging, status_iterator\\nfrom sphinx.util.nodes import make_refnode\\n\\nlogger = logging.getLogger(__name__)\\n\\n\\nOUTPUT_DIRNAME = \\\'_modules\\\'\\n\\n\\ndef _get_full_modname(app: Sphinx, modname: str, attribute: str) -> Optional[str]:\\n    try:\\n        return get_full_modname(modname, attribute)\\n    except AttributeError:\\n        # sphinx.ext.viewcode can\\\'t follow class instance attribute\\n        # then AttributeError logging output only verbose mode.\\n        logger.verbose(\\\'Didn\\\\\\\'t find %s in %s\\\', attribute, modname)\\n        return None\\n    except Exception as e:\\n        # sphinx.ext.viewcode follow python domain directives.\\n        # because of that, if there are no real modules exists that specified\\n        # by py:function or other directives, viewcode emits a lot of warnings.\\n        # It should be displayed only verbose mode.\\n        logger.verbose(traceback.format_exc().rstrip())\\n        logger.verbose(\\\'viewcode can\\\\\\\'t import %s, failed with error "%s"\\\', modname, e)\\n        return None\\n\\n\\ndef is_epub_builder(builder_name: str) -> bool:\\n    """Check if the builder is an epub builder."""\\n    return bool(builder_name and builder_name.startswith(\\\'epub\\\'))\\n\\n\\ndef should_view_code(builder_name: Optional[str], viewcode_enable_epub: bool) -> bool:\\n    """Determine whether code module pages should be generated."""\\n    # Only show viewcode pages if:\\n    # 1. Not a singlehtml builder\\n    # 2. Not an epub builder, or epub builder with viewcode_enable_epub=True\\n    if not builder_name:\\n        return True\\n\\n    if builder_name == \\\'singlehtml\\\':\\n        return False\\n\\n    if is_epub_builder(builder_name):\\n        return bool(viewcode_enable_epub)\\n\\n    return True\\n\\n\\ndef doctree_read(app: Sphinx, doctree: Node) -> None:\\n    env = app.builder.env\\n    if not hasattr(env, \\\'_viewcode_modules\\\'):\\n        env._viewcode_modules = {}  # type: ignore\\n\\n    if not should_view_code(getattr(app.builder, \\\'name\\\', \\\'\\\'), env.config.viewcode_enable_epub):\\n        return\\n\\n    def has_tag(modname: str, fullname: str, docname: str, refname: str) -> bool:\\n        entry = env._viewcode_modules.get(modname, None)  # type: ignore\\n        if entry is False:\\n            return False\\n\\n        code_tags = app.emit_firstresult(\\\'viewcode-find-source\\\', modname)\\n        if code_tags is None:\\n            try:\\n                analyzer = ModuleAnalyzer.for_module(modname)\\n                analyzer.find_tags()\\n            except Exception:\\n                env._viewcode_modules[modname] = False  # type: ignore\\n                return False\\n\\n            code = analyzer.code\\n            tags = analyzer.tags\\n        else:\\n            code, tags = code_tags\\n\\n        if entry is None or entry[0] != code:\\n            entry = code, tags, {}, refname\\n            env._viewcode_modules[modname] = entry  # type: ignore\\n        _, tags, used, _ = entry\\n        if fullname in tags:\\n            used[fullname] = docname\\n            return True\\n\\n        return False\\n\\n    for objnode in doctree.traverse(addnodes.desc):\\n        if objnode.get(\\\'domain\\\') != \\\'py\\\':\\n            continue\\n        names = set()  # type: Set[str]\\n        for signode in objnode:\\n            if not isinstance(signode, addnodes.desc_signature):\\n                continue\\n            modname = signode.get(\\\'module\\\')\\n            fullname = signode.get(\\\'fullname\\\')\\n            refname = modname\\n            if env.config.viewcode_follow_imported_members:\\n                new_modname = app.emit_firstresult(\\n                    \\\'viewcode-follow-imported\\\', modname, fullname,\\n                )\\n                if not new_modname:\\n                    new_modname = _get_full_modname(app, modname, fullname)\\n                modname = new_modname\\n            if not modname:\\n                continue\\n            fullname = signode.get(\\\'fullname\\\')\\n            if not has_tag(modname, fullname, env.docname, refname):\\n                continue\\n            if fullname in names:\\n                # only one link per name, please\\n                continue\\n            names.add(fullname)\\n            pagename = posixpath.join(OUTPUT_DIRNAME, modname.replace(\\\'.\\\', \\\'/\\\'))\\n            inline = nodes.inline(\\\'\\\', _(\\\'[source]\\\'), classes=[\\\'viewcode-link\\\'])\\n            onlynode = addnodes.only(expr=\\\'html\\\')\\n            onlynode += addnodes.pending_xref(\\\'\\\', inline, reftype=\\\'viewcode\\\', refdomain=\\\'std\\\',\\n                                          refexplicit=False, reftarget=pagename,\\n                                          refid=fullname, refdoc=env.docname)\\n            signode += onlynode\\n\\n\\ndef env_merge_info(app: Sphinx, env: BuildEnvironment, docnames: Iterable[str],\\n                   other: BuildEnvironment) -> None:\\n    if not hasattr(other, \\\'_viewcode_modules\\\'):\\n        return\\n    # create a _viewcode_modules dict on the main environment\\n    if not hasattr(env, \\\'_viewcode_modules\\\'):\\n        env._viewcode_modules = {}  # type: ignore\\n    # now merge in the information from the subprocess\\n    env._viewcode_modules.update(other._viewcode_modules)  # type: ignore\\n\\n\\ndef missing_reference(app: Sphinx, env: BuildEnvironment, node: Element, contnode: Node\\n                      ) -> Optional[Node]:\\n    # resolve our "viewcode" reference nodes -- they need special treatment\\n    if node[\\\'reftype\\\'] == \\\'viewcode\\\':\\n        return make_refnode(app.builder, node[\\\'refdoc\\\'], node[\\\'reftarget\\\'],\\n                            node[\\\'refid\\\'], contnode)\\n\\n    return None\\n\\n\\ndef collect_pages(app: Sphinx) -> Generator[Tuple[str, Dict[str, Any], str], None, None]:\\n    env = app.builder.env\\n    if not hasattr(env, \\\'_viewcode_modules\\\'):\\n        return\\n\\n    builder_name = getattr(app.builder, \\\'name\\\', \\\'\\\')\\n    if not should_view_code(builder_name, env.config.viewcode_enable_epub):\\n        return\\n\\n    highlighter = app.builder.highlighter  # type: ignore\\n    urito = app.builder.get_relative_uri\\n\\n    modnames = set(env._viewcode_modules)  # type: ignore\\n\\n    # Create or clean up the _modules directory\\n    modules_dir = os.path.join(app.builder.outdir, OUTPUT_DIRNAME)\\n    if should_view_code(builder_name, env.config.viewcode_enable_epub):\\n        if path.exists(modules_dir):\\n            shutil.rmtree(modules_dir)\\n        os.makedirs(modules_dir)\\n\\n    for modname, entry in status_iterator(\\n            sorted(env._viewcode_modules.items()),  # type: ignore\\n            __(\\\'highlighting module code... \\\'), "blue",\\n            len(env._viewcode_modules),  # type: ignore\\n            app.verbosity, lambda x: x[0]):\\n        if not entry:\\n            continue\\n\\n        code, tags, used, refname = entry\\n        pagename = posixpath.join(OUTPUT_DIRNAME, modname.replace(\\\'.\\\', \\\'/\\\'))\\n\\n        if env.config.highlight_language in (\\\'python3\\\', \\\'default\\\', \\\'none\\\'):\\n            lexer = env.config.highlight_language\\n        else:\\n            lexer = \\\'python\\\'\\n        highlighted = highlighter.highlight_block(code, lexer, linenos=False)\\n        lines = highlighted.splitlines()\\n        before, after = lines[0].split(\\\'<pre>\\\')\\n        lines[0:1] = [before + \\\'<pre>\\\', after]\\n\\n        maxindex = len(lines) - 1\\n        for name, docname in used.items():\\n            type, start, end = tags[name]\\n            backlink = urito(pagename, docname) + \\\'#\\\' + refname + \\\'.\\\' + name\\n            lines[start] = (\\n                \\\'<div class="viewcode-block" id="%s"><a class="viewcode-back" \\\'\\n                \\\'href="%s">%s</a>\\\' % (name, backlink, _(\\\'[docs]\\\')) +\\n                lines[start])\\n            lines[min(end, maxindex)] += \\\'</div>\\\'\\n\\n        parents = []\\n        parent = modname\\n        while \\\'.\\\' in parent:\\n            parent = parent.rsplit(\\\'.\\\', 1)[0]\\n            if parent in modnames:\\n                parents.append({\\n                    \\\'link\\\': urito(pagename,\\n                                  posixpath.join(OUTPUT_DIRNAME, parent.replace(\\\'.\\\', \\\'/\\\'))),\\n                    \\\'title\\\': parent})\\n        parents.append({\\\'link\\\': urito(pagename, posixpath.join(OUTPUT_DIRNAME, \\\'index\\\')),\\n                        \\\'title\\\': _(\\\'Module code\\\')})\\n        parents.reverse()\\n\\n        context = {\\n            \\\'parents\\\': parents,\\n            \\\'title\\\': modname,\\n            \\\'body\\\': (_(\\\'<h1>Source code for %s</h1>\\\') % modname +\\n                     \\\'\\\\n\\\'.join(lines)),\\n        }\\n        yield (pagename, context, \\\'page.html\\\')\\n\\n    if not modnames:\\n        return\\n\\n    html = [\\\'\\\\n\\\']\\n    stack = [\\\'\\\']\\n    for modname in sorted(modnames):\\n        if modname.startswith(stack[-1]):\\n            stack.append(modname + \\\'.\\\')\\n            html.append(\\\'<ul>\\\')\\n        else:\\n            stack.pop()\\n            stack.append(modname + \\\'.\\\')\\n            html.append(\\\'</ul>\\\' * (len(stack) - 1) + \\\'<ul>\\\')\\n        if modname in env._viewcode_modules and env._viewcode_modules[modname]:  # type: ignore\\n            pagename = posixpath.join(OUTPUT_DIRNAME, modname.replace(\\\'.\\\', \\\'/\\\'))\\n            html.append(\\\'<li><a href="%s">%s</a></li>\\\\n\\\' % (\\n                urito(OUTPUT_DIRNAME + \\\'/index\\\', pagename), modname))\\n\\n    if html == [\\\'\\\\n\\\']:  # no documented Python objects\\n        return\\n\\n    html.append(\\\'</ul>\\\' * len(stack))\\n    context = {\\n        \\\'title\\\': _(\\\'Overview: module code\\\'),\\n        \\\'body\\\': (_(\\\'<h1>All modules for which code is available</h1>\\\') +\\n                 \\\'\\\'.join(html)),\\n    }\\n    yield (posixpath.join(OUTPUT_DIRNAME, \\\'index\\\'), context, \\\'page.html\\\')\\n\\n\\ndef builder_inited(app: Sphinx) -> None:\\n    # Early cleanup of _modules directory to avoid any stale content\\n    if not hasattr(app.builder, \\\'outdir\\\'):\\n        return\\n\\n    modules_dir = path.join(app.builder.outdir, OUTPUT_DIRNAME)\\n    if not should_view_code(getattr(app.builder, \\\'name\\\', \\\'\\\'),\\n                          app.builder.env.config.viewcode_enable_epub):\\n        if path.exists(modules_dir):\\n            shutil.rmtree(modules_dir)\\n\\n\\ndef setup(app: Sphinx) -> Dict[str, Any]:\\n    app.add_config_value(\\\'viewcode_enable_epub\\\', False, False)\\n    app.add_config_value(\\\'viewcode_follow_imported_members\\\', True, False)\\n    app.add_event(\\\'viewcode-find-source\\\')\\n    app.add_event(\\\'viewcode-follow-imported\\\')\\n    \\n    app.connect(\\\'builder-inited\\\', builder_inited)\\n    app.connect(\\\'doctree-read\\\', doctree_read)\\n    app.connect(\\\'env-merge-info\\\', env_merge_info)\\n    app.connect(\\\'html-collect-pages\\\', collect_pages)\\n    app.connect(\\\'missing-reference\\\', missing_reference)\\n\\n    return {\\n        \\\'version\\\': sphinx.__display_version__,\\n        \\\'parallel_read_safe\\\': True\\n    }\'}}\n</tool_use>'}]}, {'role': 'user', 'content': [{'type': 'text', 'text': 'Tool Result: File at /testbed/sphinx/ext/viewcode.py has been overwritten with new content.'}]}, {'role': 'assistant', 'content': [{'type': 'text', 'text': "Let's run the tests again:"}, {'type': 'text', 'text': "<tool_use>\n{'tool_name': bash, 'tool_input': {'command': 'cd /testbed/ && tox --current-env -epy39 -v -- tests/test_ext_viewcode.py'}}\n</tool_use>"}]}, {'role': 'user', 'content': [{'type': 'text', 'text': 'Tool Result: py39: commands[0]> python -X dev -m pytest -rA --durations 25 tests/test_ext_viewcode.py\n\x1b[1m============================= test session starts ==============================\x1b[0m\nplatform linux -- Python 3.9.21, pytest-8.3.4, pluggy-1.5.0\ncachedir: .tox/py39/.pytest_cache\nlibraries: Sphinx-3.5.0+/82ef497a8, docutils-0.21.2\nbase tempdir: /tmp/pytest-of-root/pytest-9\nrootdir: /testbed\nconfigfile: setup.cfg\nplugins: cov-6.0.0\ncollected 5 items\n\ntests/test_ext_viewcode.py \x1b[31mF\x1b[0m\x1b[31mF\x1b[0m\x1b[32m.\x1b[0m\x1b[32m.\x1b[0m\x1b[32m.\x1b[0m\x1b[31m                                         [100%]\x1b[0m\n\n=================================== FAILURES ===================================\n\x1b[31m\x1b[1m________________________________ test_viewcode _________________________________\x1b[0m\n\napp = <SphinxTestApp buildername=\'html\'>\nstatus = <_io.StringIO object at 0x7fe51fa320f0>\nwarning = <_io.StringIO object at 0x7fe51fa32190>\n\n    \x1b[0m\x1b[37m@pytest\x1b[39;49;00m.mark.sphinx(testroot=\x1b[33m\'\x1b[39;49;00m\x1b[33mext-viewcode\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m)\x1b[90m\x1b[39;49;00m\n    \x1b[94mdef\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[92mtest_viewcode\x1b[39;49;00m(app, status, warning):\x1b[90m\x1b[39;49;00m\n        app.builder.build_all()\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        warnings = re.sub(\x1b[33mr\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[33m\\\\\x1b[39;49;00m\x1b[33m+\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m, \x1b[33m\'\x1b[39;49;00m\x1b[33m/\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m, warning.getvalue())\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m re.findall(\x1b[90m\x1b[39;49;00m\n            \x1b[33mr\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33mindex.rst:\x1b[39;49;00m\x1b[33m\\\x1b[39;49;00m\x1b[33md+: WARNING: Object named \x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[33mfunc1\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[33m not found in include \x1b[39;49;00m\x1b[33m"\x1b[39;49;00m +\x1b[90m\x1b[39;49;00m\n            \x1b[33mr\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33mfile .*/spam/__init__.py\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m,\x1b[90m\x1b[39;49;00m\n            warnings\x1b[90m\x1b[39;49;00m\n        )\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        result = (app.outdir / \x1b[33m\'\x1b[39;49;00m\x1b[33mindex.html\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m).read_text()\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m result.count(\x1b[33m\'\x1b[39;49;00m\x1b[33mhref=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m_modules/spam/mod1.html#func1\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) == \x1b[94m2\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m result.count(\x1b[33m\'\x1b[39;49;00m\x1b[33mhref=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m_modules/spam/mod2.html#func2\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) == \x1b[94m2\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m result.count(\x1b[33m\'\x1b[39;49;00m\x1b[33mhref=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m_modules/spam/mod1.html#Class1\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) == \x1b[94m2\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m result.count(\x1b[33m\'\x1b[39;49;00m\x1b[33mhref=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m_modules/spam/mod2.html#Class2\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) == \x1b[94m2\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m result.count(\x1b[33m\'\x1b[39;49;00m\x1b[33m@decorator\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) == \x1b[94m1\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        \x1b[90m# test that the class attribute is correctly documented\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m result.count(\x1b[33m\'\x1b[39;49;00m\x1b[33mthis is Class3\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) == \x1b[94m2\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m \x1b[33m\'\x1b[39;49;00m\x1b[33mthis is the class attribute class_attr\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m \x1b[95min\x1b[39;49;00m result\x1b[90m\x1b[39;49;00m\n        \x1b[90m# the next assert fails, until the autodoc bug gets fixed\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        \x1b[94massert\x1b[39;49;00m result.count(\x1b[33m\'\x1b[39;49;00m\x1b[33mthis is the class attribute class_attr\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) == \x1b[94m2\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        result = (app.outdir / \x1b[33m\'\x1b[39;49;00m\x1b[33m_modules/spam/mod1.html\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m).read_text()\x1b[90m\x1b[39;49;00m\n        result = re.sub(\x1b[33m\'\x1b[39;49;00m\x1b[33m<span class=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m.*?\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m>\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m, \x1b[33m\'\x1b[39;49;00m\x1b[33m<span>\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m, result)  \x1b[90m# filter pygments classes\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n>       \x1b[94massert\x1b[39;49;00m (\x1b[33m\'\x1b[39;49;00m\x1b[33m<div class=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33mviewcode-block\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m id=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33mClass1\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m><a class=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33mviewcode-back\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m \x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                \x1b[33m\'\x1b[39;49;00m\x1b[33mhref=\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m../../index.html#spam.Class1\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[33m>[docs]</a>\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                \x1b[33m\'\x1b[39;49;00m\x1b[33m<span>@decorator</span>\x1b[39;49;00m\x1b[33m\\n\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                \x1b[33m\'\x1b[39;49;00m\x1b[33m<span>class</span> <span>Class1</span>\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                \x1b[33m\'\x1b[39;49;00m\x1b[33m<span>(</span><span>object</span><span>):</span>\x1b[39;49;00m\x1b[33m\\n\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                \x1b[33m\'\x1b[39;49;00m\x1b[33m    <span>&quot;&quot;&quot;</span>\x1b[39;49;00m\x1b[33m\\n\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                \x1b[33m\'\x1b[39;49;00m\x1b[33m<span>    this is Class1</span>\x1b[39;49;00m\x1b[33m\\n\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n                \x1b[33m\'\x1b[39;49;00m\x1b[33m<span>    &quot;&quot;&quot;</span></div>\x1b[39;49;00m\x1b[33m\\n\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m) \x1b[95min\x1b[39;49;00m result\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31mE       assert \'<div class="viewcode-block" id="Class1"><a class="viewcode-back" href="../../index.html#spam.Class1">[docs]</a><span>...an>\\n    <span>&quot;&quot;&quot;</span>\\n<span>    this is Class1</span>\\n<span>    &quot;&quot;&quot;</span></div>\\n\' in \'\\n<!DOCTYPE html>\\n\\n<html>\\n  <head>\\n    <meta charset="utf-8" />\\n    <meta name="viewport" content="width=device-..."https://github.com/bitprophet/alabaster">Alabaster 0.7.11</a>\\n      \\n    </div>\\n\\n    \\n\\n    \\n  </body>\\n</html>\'\x1b[0m\n\n\x1b[1m\x1b[31mtests/test_ext_viewcode.py\x1b[0m:43: AssertionError\n--------------------------- Captured stdout teardown ---------------------------\n# testroot: root\n# builder: html\n# srcdir: /tmp/pytest-of-root/pytest-9/ext-viewcode\n# outdir: /tmp/pytest-of-root/pytest-9/ext-viewcode/_build/html\n# status: \n\x1b[01mRunning Sphinx v3.5.0+/82ef497a8\x1b[39;49;00m\n\x1b[01mbuilding [html]: \x1b[39;49;00mall source files\n\x1b[01mupdating environment: \x1b[39;49;00m[new config] 2 added, 0 changed, 0 removed\n\x1b[01mreading sources... \x1b[39;49;00m[ 50%] \x1b[35mindex\x1b[39;49;00m                                                \r\x1b[01mreading sources... \x1b[39;49;00m[100%] \x1b[35mobjects\x1b[39;49;00m                                              \r\n\x1b[01mlooking for now-outdated files... \x1b[39;49;00mnone found\n\x1b[01mpickling environment... \x1b[39;49;00mdone\n\x1b[01mchecking consistency... \x1b[39;49;00mdone\n\x1b[01mpreparing documents... \x1b[39;49;00mdone\n\x1b[01mwriting output... \x1b[39;49;00m[ 50%] \x1b[32mindex\x1b[39;49;00m                                                 \r\x1b[01mwriting output... \x1b[39;49;00m[100%] \x1b[32mobjects\x1b[39;49;00m                                               \r\n\x1b[01mgenerating indices... \x1b[39;49;00mgenindex py-modindex done\n\x1b[01mhighlighting module code... \x1b[39;49;00m[ 50%] \x1b[94mspam.mod1\x1b[39;49;00m                                   \r\x1b[01mhighlighting module code... \x1b[39;49;00m[100%] \x1b[94mspam.mod2\x1b[39;49;00m                                   \r\n\x1b[01mwriting additional pages... \x1b[39;49;00msearch done\n\x1b[01mcopying static files... \x1b[39;49;00mdone\n\x1b[01mcopying extra files... \x1b[39;49;00mdone\n\x1b[01mdumping search index in English (code: en)... \x1b[39;49;00mdone\n\x1b[01mdumping object inventory... \x1b[39;49;00mdone\n\n# warning: \n\x1b[91mWARNING: while setting up extension sphinx.addnodes: node class \'meta\' is already registered, its visitors will be overridden\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-9/ext-viewcode/index.rst:23: WARNING: Object named \'func1\' not found in include file \'/tmp/pytest-of-root/pytest-9/ext-viewcode/spam/__init__.py\'\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-9/ext-viewcode/spam/mod1.py:docstring of spam.mod1.Class3:1: WARNING: duplicate object description of spam.mod3.Class3, other instance in index, use :noindex: for one of them\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-9/ext-viewcode/spam/mod1.py:docstring of spam.mod3.Class3.class_attr:1: WARNING: duplicate object description of spam.mod3.Class3.class_attr, other instance in index, use :noindex: for one of them\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-9/ext-viewcode/objects.rst:84: WARNING: Error in declarator\nIf declarator-id with parameters (e.g., \'void f(int arg)\'):\n  Invalid C declaration: Expected identifier in nested name. [error at 18]\n    Sphinx_DoSomething()\n    ------------------^\nIf parenthesis in noptr-declarator (e.g., \'void (*f(int arg))(double)\'):\n  Error in declarator or parameters\n  Invalid C declaration: Expected identifier in nested name. [error at 19]\n    Sphinx_DoSomething()\n    -------------------^\n\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-9/ext-viewcode/objects.rst:86: WARNING: Error in declarator or parameters\nInvalid C declaration: Expected identifier in nested name. [error at 19]\n  SphinxStruct.member\n  -------------------^\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-9/ext-viewcode/objects.rst:92: WARNING: Error in declarator or parameters\nInvalid C declaration: Expected identifier in nested name. [error at 13]\n  sphinx_global\n  -------------^\x1b[39;49;00m\n\x1b[31m/tmp/pytest-of-root/pytest-9/ext-viewcode/objects.rst:155: WARNING: Unknown directive type "userdesc".\n\n.. userdesc:: myobj:parameter\n\n   Description of userdesc.\x1b[39;49;00m\n\x1b[31m/tmp/pytest-of-root/pytest-9/ext-viewcode/objects.rst:160: WARNING: Unknown interpreted text role "userdescrole".\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-9/ext-viewcode/objects.rst:166: WARNING: Too many template argument lists compared to parameter lists. Argument lists: 1, Parameter lists: 0, Extra empty parameters lists prepended: 1. Declaration:\n\tn::Array<T, d>\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-9/ext-viewcode/objects.rst:117: WARNING: Unparseable C cross-reference: \'SphinxType *\'\nInvalid C declaration: Expected end of definition. [error at 11]\n  SphinxType *\n  -----------^\x1b[39;49;00m\n\n\x1b[31m\x1b[1m_________________________ test_viewcode_epub_disabled __________________________\x1b[0m\n\napp = <SphinxTestApp buildername=\'epub\'>\nstatus = <_io.StringIO object at 0x7fe51e638690>\nwarning = <_io.StringIO object at 0x7fe51e638730>\n\n    \x1b[0m\x1b[37m@pytest\x1b[39;49;00m.mark.sphinx(testroot=\x1b[33m\'\x1b[39;49;00m\x1b[33mext-viewcode\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m, confoverrides={\x1b[33m\'\x1b[39;49;00m\x1b[33mviewcode_enable_epub\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m: \x1b[94mFalse\x1b[39;49;00m})\x1b[90m\x1b[39;49;00m\n    \x1b[94mdef\x1b[39;49;00m\x1b[90m \x1b[39;49;00m\x1b[92mtest_viewcode_epub_disabled\x1b[39;49;00m(app, status, warning):\x1b[90m\x1b[39;49;00m\n        \x1b[90m# Change to epub builder\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        app.builder.name = \x1b[33m"\x1b[39;49;00m\x1b[33mepub\x1b[39;49;00m\x1b[33m"\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        app.builder.build_all()\x1b[90m\x1b[39;49;00m\n    \x1b[90m\x1b[39;49;00m\n        \x1b[90m# Check that _modules directory is not created when viewcode_enable_epub is False\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n        modules_dir = Path(app.outdir) / \x1b[33m\'\x1b[39;49;00m\x1b[33m_modules\x1b[39;49;00m\x1b[33m\'\x1b[39;49;00m\x1b[90m\x1b[39;49;00m\n>       \x1b[94massert\x1b[39;49;00m \x1b[95mnot\x1b[39;49;00m modules_dir.exists()\x1b[90m\x1b[39;49;00m\n\x1b[1m\x1b[31mE       AssertionError: assert not True\x1b[0m\n\x1b[1m\x1b[31mE        +  where True = exists()\x1b[0m\n\x1b[1m\x1b[31mE        +    where exists = PosixPath(\'/tmp/pytest-of-root/pytest-9/ext-viewcode/_build/html/_modules\').exists\x1b[0m\n\n\x1b[1m\x1b[31mtests/test_ext_viewcode.py\x1b[0m:61: AssertionError\n--------------------------- Captured stdout teardown ---------------------------\n# testroot: root\n# builder: epub\n# srcdir: /tmp/pytest-of-root/pytest-9/ext-viewcode\n# outdir: /tmp/pytest-of-root/pytest-9/ext-viewcode/_build/html\n# status: \n\x1b[01mRunning Sphinx v3.5.0+/82ef497a8\x1b[39;49;00m\n\x1b[01mloading pickled environment... \x1b[39;49;00mdone\n\x1b[01mbuilding [epub]: \x1b[39;49;00mall source files\n\x1b[01mupdating environment: \x1b[39;49;00m0 added, 0 changed, 0 removed\n\x1b[01mlooking for now-outdated files... \x1b[39;49;00mnone found\n\x1b[01mpreparing documents... \x1b[39;49;00mdone\n\x1b[01mwriting output... \x1b[39;49;00m[ 50%] \x1b[32mindex\x1b[39;49;00m                                                 \r\x1b[01mwriting output... \x1b[39;49;00m[100%] \x1b[32mobjects\x1b[39;49;00m                                               \r\n\x1b[01mgenerating indices... \x1b[39;49;00mgenindex py-modindex done\n\x1b[01mwriting additional pages... \x1b[39;49;00msearch done\n\x1b[01mcopying static files... \x1b[39;49;00mdone\n\x1b[01mcopying extra files... \x1b[39;49;00mdone\n\x1b[01mdumping search index in English (code: en)... \x1b[39;49;00mdone\n\x1b[01mdumping object inventory... \x1b[39;49;00mdone\n\n# warning: \n\x1b[91mWARNING: while setting up extension sphinx.addnodes: node class \'meta\' is already registered, its visitors will be overridden\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-9/ext-viewcode/objects.rst:117: WARNING: Unparseable C cross-reference: \'SphinxType *\'\nInvalid C declaration: Expected end of definition. [error at 11]\n  SphinxType *\n  -----------^\x1b[39;49;00m\n\n\x1b[33m=============================== warnings summary ===============================\x1b[0m\nsphinx/util/docutils.py:45\n  /testbed/sphinx/util/docutils.py:45: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.\n    __version_info__ = tuple(LooseVersion(docutils.__version__).version)\n\nsphinx/registry.py:22\n  /testbed/sphinx/registry.py:22: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n    from pkg_resources import iter_entry_points\n\n../opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pkg_resources/__init__.py:3142\n../opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pkg_resources/__init__.py:3142\n../opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pkg_resources/__init__.py:3142\n../opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pkg_resources/__init__.py:3142\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pkg_resources/__init__.py:3142: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace(\'sphinxcontrib\')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n    declare_namespace(pkg)\n\nsphinx/directives/patches.py:14\n  /testbed/sphinx/directives/patches.py:14: DeprecationWarning: The `docutils.parsers.rst.directive.html` module will be removed in Docutils 2.0. Since Docutils 0.18, the "Meta" node is defined in `docutils.parsers.rst.directives.misc`.\n    from docutils.parsers.rst.directives import html, images, tables\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:210: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse():  # type: Node\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/i18n.py:95: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.translatable):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:110: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for ref in self.document.traverse(nodes.substitution_reference):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:131: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.target):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:150: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.block_quote):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:175: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.Element):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:222: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.index):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:189: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.section):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:279: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.doctest_block):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/domains/citation.py:116: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.citation):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/domains/citation.py:135: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.citation_reference):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/builders/latex/transforms.py:36: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(matcher):  # type: nodes.Element\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:291: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(matcher):  # type: Element\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/util/compat.py:44: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.index):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/domains/index.py:51: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in document.traverse(addnodes.index):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/domains/math.py:84: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    self.data[\'has_equations\'][docname] = any(document.traverse(math_node))\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/environment/collectors/asset.py:46: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in doctree.traverse(nodes.image):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/environment/collectors/asset.py:127: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in doctree.traverse(addnodes.download_reference):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/environment/collectors/title.py:46: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in doctree.traverse(nodes.section):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/ext/viewcode.py:114: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for objnode in doctree.traverse(addnodes.desc):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:301: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.system_message):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/__init__.py:390: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.manpage):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/i18n.py:488: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for inline in self.document.traverse(matcher):  # type: nodes.inline\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/domains/python.py:283: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in result.traverse(nodes.Text):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/builders/html/__init__.py:422: DeprecationWarning: The frontend.OptionParser class will be replaced by a subclass of argparse.ArgumentParser in Docutils 0.21 or later.\n    self.docsettings = OptionParser(\n\ntests/test_ext_viewcode.py: 360 warnings\n  /opt/miniconda3/envs/testbed/lib/python3.9/optparse.py:1000: DeprecationWarning: The frontend.Option class will be removed in Docutils 0.21 or later.\n    option = self.option_class(*args, **kwargs)\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/domains/c.py:3494: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(AliasNode):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/domains/cpp.py:7070: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(AliasNode):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/post_transforms/__init__.py:69: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.pending_xref):\n\ntests/test_ext_viewcode.py: 48 warnings\n  /testbed/sphinx/util/nodes.py:598: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in document.traverse(addnodes.only):\n\ntests/test_ext_viewcode.py: 18 warnings\n  /testbed/sphinx/transforms/post_transforms/images.py:33: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.image):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/post_transforms/__init__.py:216: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.desc_sig_element):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/builders/latex/transforms.py:48: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.substitution_definition):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/builders/html/transforms.py:44: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(matcher):  # type: nodes.literal\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/builders/latex/transforms.py:606: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(nodes.title):\n\ntests/test_ext_viewcode.py: 33 warnings\n  /testbed/sphinx/builders/latex/transforms.py:608: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for i, index in enumerate(node.traverse(addnodes.index)):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/post_transforms/code.py:43: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in self.document.traverse(addnodes.highlightlang):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/post_transforms/code.py:95: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for lbnode in self.document.traverse(nodes.literal_block):  # type: nodes.literal_block\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/transforms/post_transforms/code.py:99: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for dbnode in self.document.traverse(nodes.doctest_block):  # type: nodes.doctest_block\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/environment/__init__.py:541: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for toctreenode in doctree.traverse(addnodes.toctree):\n\ntests/test_ext_viewcode.py: 30 warnings\n  /testbed/sphinx/environment/adapters/toctree.py:203: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for subtocnode in toc.traverse(addnodes.toctree):\n\ntests/test_ext_viewcode.py: 30 warnings\n  /testbed/sphinx/environment/adapters/toctree.py:261: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for refnode in newnode.traverse(nodes.reference):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/builders/__init__.py:181: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in doctree.traverse(nodes.image):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/builders/html/__init__.py:844: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in doctree.traverse(nodes.image):\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  /testbed/sphinx/environment/adapters/toctree.py:312: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for node in toc.traverse(nodes.reference):\n\ntests/test_ext_viewcode.py: 33 warnings\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/alabaster/layout.html:114: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n    _gaq.push([\'_setAllowLinker\', true]);\n\ntests/test_ext_viewcode.py: 33 warnings\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/alabaster/about.html:70: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py: 33 warnings\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/alabaster/about.html:99: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py: 33 warnings\n  /testbed/sphinx/environment/adapters/toctree.py:328: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for toctreenode in doctree.traverse(addnodes.toctree):\n\ntests/test_ext_viewcode.py: 33 warnings\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/alabaster/layout.html:215: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py: 33 warnings\n  /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/alabaster/layout.html:238: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  <template>:33: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  <template>:224: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  <template>:386: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py::test_viewcode\ntests/test_ext_viewcode.py::test_viewcode_epub_disabled\ntests/test_ext_viewcode.py::test_viewcode_epub_enabled\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_local_source_files\n  <template>:401: DeprecationWarning: \'soft_unicode\' has been renamed to \'soft_str\'. The old name will be removed in MarkupSafe 2.1.\n\ntests/test_ext_viewcode.py: 18 warnings\n  /testbed/sphinx/util/nodes.py:350: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for img in node.traverse(nodes.image):\n\ntests/test_ext_viewcode.py: 18 warnings\n  /testbed/sphinx/util/nodes.py:352: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for raw in node.traverse(nodes.raw):\n\ntests/test_ext_viewcode.py::test_linkcode\ntests/test_ext_viewcode.py::test_linkcode\n  /testbed/sphinx/ext/linkcode.py:42: PendingDeprecationWarning: nodes.Node.traverse() is obsoleted by Node.findall().\n    for objnode in doctree.traverse(addnodes.desc):\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n==================================== PASSES ====================================\n--------------------------- Captured stdout teardown ---------------------------\n# testroot: root\n# builder: epub\n# srcdir: /tmp/pytest-of-root/pytest-9/ext-viewcode\n# outdir: /tmp/pytest-of-root/pytest-9/ext-viewcode/_build/html\n# status: \n\x1b[01mRunning Sphinx v3.5.0+/82ef497a8\x1b[39;49;00m\n\x1b[01mloading pickled environment... \x1b[39;49;00mdone\n\x1b[01mbuilding [epub]: \x1b[39;49;00mall source files\n\x1b[01mupdating environment: \x1b[39;49;00m0 added, 0 changed, 0 removed\n\x1b[01mlooking for now-outdated files... \x1b[39;49;00mnone found\n\x1b[01mpreparing documents... \x1b[39;49;00mdone\n\x1b[01mwriting output... \x1b[39;49;00m[ 50%] \x1b[32mindex\x1b[39;49;00m                                                 \r\x1b[01mwriting output... \x1b[39;49;00m[100%] \x1b[32mobjects\x1b[39;49;00m                                               \r\n\x1b[01mgenerating indices... \x1b[39;49;00mgenindex py-modindex done\n\x1b[01mhighlighting module code... \x1b[39;49;00m[ 50%] \x1b[94mspam.mod1\x1b[39;49;00m                                   \r\x1b[01mhighlighting module code... \x1b[39;49;00m[100%] \x1b[94mspam.mod2\x1b[39;49;00m                                   \r\n\x1b[01mwriting additional pages... \x1b[39;49;00msearch done\n\x1b[01mcopying static files... \x1b[39;49;00mdone\n\x1b[01mcopying extra files... \x1b[39;49;00mdone\n\x1b[01mdumping search index in English (code: en)... \x1b[39;49;00mdone\n\x1b[01mdumping object inventory... \x1b[39;49;00mdone\n\n# warning: \n\x1b[91mWARNING: while setting up extension sphinx.addnodes: node class \'meta\' is already registered, its visitors will be overridden\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-9/ext-viewcode/objects.rst:117: WARNING: Unparseable C cross-reference: \'SphinxType *\'\nInvalid C declaration: Expected end of definition. [error at 11]\n  SphinxType *\n  -----------^\x1b[39;49;00m\n\n--------------------------- Captured stdout teardown ---------------------------\n# testroot: root\n# builder: html\n# srcdir: /tmp/pytest-of-root/pytest-9/ext-viewcode\n# outdir: /tmp/pytest-of-root/pytest-9/ext-viewcode/_build/html\n# status: \n\x1b[01mRunning Sphinx v3.5.0+/82ef497a8\x1b[39;49;00m\n\x1b[01mloading pickled environment... \x1b[39;49;00mdone\n\x1b[01mupdating environment: \x1b[39;49;00m[extensions changed (\'2\')] 2 added, 0 changed, 0 removed\n\x1b[01mreading sources... \x1b[39;49;00m[ 50%] \x1b[35mindex\x1b[39;49;00m                                                \r\x1b[01mreading sources... \x1b[39;49;00m[100%] \x1b[35mobjects\x1b[39;49;00m                                              \r\n\x1b[01mlooking for now-outdated files... \x1b[39;49;00mnone found\n\x1b[01mpickling environment... \x1b[39;49;00mdone\n\x1b[01mchecking consistency... \x1b[39;49;00mdone\n\x1b[01mpreparing documents... \x1b[39;49;00mdone\n\x1b[01mwriting output... \x1b[39;49;00m[ 50%] \x1b[32mindex\x1b[39;49;00m                                                 \r\x1b[01mwriting output... \x1b[39;49;00m[100%] \x1b[32mobjects\x1b[39;49;00m                                               \r\n\x1b[01mgenerating indices... \x1b[39;49;00mgenindex py-modindex done\n\x1b[01mwriting additional pages... \x1b[39;49;00msearch done\n\x1b[01mcopying static files... \x1b[39;49;00mdone\n\x1b[01mcopying extra files... \x1b[39;49;00mdone\n\x1b[01mdumping search index in English (code: en)... \x1b[39;49;00mdone\n\x1b[01mdumping object inventory... \x1b[39;49;00mdone\n\n# warning: \n\x1b[91mWARNING: while setting up extension sphinx.addnodes: node class \'meta\' is already registered, its visitors will be overridden\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-9/ext-viewcode/index.rst:23: WARNING: Object named \'func1\' not found in include file \'/tmp/pytest-of-root/pytest-9/ext-viewcode/spam/__init__.py\'\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-9/ext-viewcode/spam/mod1.py:docstring of spam.mod1.Class3:1: WARNING: duplicate object description of spam.mod3.Class3, other instance in index, use :noindex: for one of them\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-9/ext-viewcode/spam/mod1.py:docstring of spam.mod3.Class3.class_attr:1: WARNING: duplicate object description of spam.mod3.Class3.class_attr, other instance in index, use :noindex: for one of them\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-9/ext-viewcode/objects.rst:84: WARNING: Error in declarator\nIf declarator-id with parameters (e.g., \'void f(int arg)\'):\n  Invalid C declaration: Expected identifier in nested name. [error at 18]\n    Sphinx_DoSomething()\n    ------------------^\nIf parenthesis in noptr-declarator (e.g., \'void (*f(int arg))(double)\'):\n  Error in declarator or parameters\n  Invalid C declaration: Expected identifier in nested name. [error at 19]\n    Sphinx_DoSomething()\n    -------------------^\n\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-9/ext-viewcode/objects.rst:86: WARNING: Error in declarator or parameters\nInvalid C declaration: Expected identifier in nested name. [error at 19]\n  SphinxStruct.member\n  -------------------^\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-9/ext-viewcode/objects.rst:92: WARNING: Error in declarator or parameters\nInvalid C declaration: Expected identifier in nested name. [error at 13]\n  sphinx_global\n  -------------^\x1b[39;49;00m\n\x1b[31m/tmp/pytest-of-root/pytest-9/ext-viewcode/objects.rst:155: WARNING: Unknown directive type "userdesc".\n\n.. userdesc:: myobj:parameter\n\n   Description of userdesc.\x1b[39;49;00m\n\x1b[31m/tmp/pytest-of-root/pytest-9/ext-viewcode/objects.rst:160: WARNING: Unknown interpreted text role "userdescrole".\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-9/ext-viewcode/objects.rst:166: WARNING: Too many template argument lists compared to parameter lists. Argument lists: 1, Parameter lists: 0, Extra empty parameters lists prepended: 1. Declaration:\n\tn::Array<T, d>\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-9/ext-viewcode/objects.rst:117: WARNING: Unparseable C cross-reference: \'SphinxType *\'\nInvalid C declaration: Expected end of definition. [error at 11]\n  SphinxType *\n  -----------^\x1b[39;49;00m\n\n--------------------------- Captured stdout teardown ---------------------------\n# testroot: root\n# builder: html\n# srcdir: /tmp/pytest-of-root/pytest-9/ext-viewcode-find\n# outdir: /tmp/pytest-of-root/pytest-9/ext-viewcode-find/_build/html\n# status: \n\x1b[01mRunning Sphinx v3.5.0+/82ef497a8\x1b[39;49;00m\n\x1b[01mbuilding [html]: \x1b[39;49;00mall source files\n\x1b[01mupdating environment: \x1b[39;49;00m[new config] 1 added, 0 changed, 0 removed\n\x1b[01mreading sources... \x1b[39;49;00m[100%] \x1b[35mindex\x1b[39;49;00m                                                \r\n\x1b[01mlooking for now-outdated files... \x1b[39;49;00mnone found\n\x1b[01mpickling environment... \x1b[39;49;00mdone\n\x1b[01mchecking consistency... \x1b[39;49;00mdone\n\x1b[01mpreparing documents... \x1b[39;49;00mdone\n\x1b[01mwriting output... \x1b[39;49;00m[100%] \x1b[32mindex\x1b[39;49;00m                                                 \r\n\x1b[01mgenerating indices... \x1b[39;49;00mgenindex py-modindex done\n\x1b[01mhighlighting module code... \x1b[39;49;00m[ 50%] \x1b[94mnot_a_package\x1b[39;49;00m                               \r\x1b[01mhighlighting module code... \x1b[39;49;00m[100%] \x1b[94mnot_a_package.submodule\x1b[39;49;00m                     \r\n\x1b[01mwriting additional pages... \x1b[39;49;00msearch done\n\x1b[01mcopying static files... \x1b[39;49;00mdone\n\x1b[01mcopying extra files... \x1b[39;49;00mdone\n\x1b[01mdumping search index in English (code: en)... \x1b[39;49;00mdone\n\x1b[01mdumping object inventory... \x1b[39;49;00mdone\n\n# warning: \n\x1b[91mWARNING: while setting up extension sphinx.addnodes: node class \'meta\' is already registered, its visitors will be overridden\x1b[39;49;00m\n\x1b[91m/tmp/pytest-of-root/pytest-9/ext-viewcode-find/index.rst:28: WARNING: Object named \'func1\' not found in include file \'/tmp/pytest-of-root/pytest-9/ext-viewcode-find/not_a_package/__init__.py\'\x1b[39;49;00m\n\n============================= slowest 25 durations =============================\n0.36s call     tests/test_ext_viewcode.py::test_viewcode\n0.26s call     tests/test_ext_viewcode.py::test_linkcode\n0.22s call     tests/test_ext_viewcode.py::test_viewcode_epub_enabled\n0.18s call     tests/test_ext_viewcode.py::test_local_source_files\n0.17s call     tests/test_ext_viewcode.py::test_viewcode_epub_disabled\n0.15s setup    tests/test_ext_viewcode.py::test_viewcode\n0.01s setup    tests/test_ext_viewcode.py::test_viewcode_epub_enabled\n0.01s setup    tests/test_ext_viewcode.py::test_viewcode_epub_disabled\n0.01s setup    tests/test_ext_viewcode.py::test_linkcode\n0.01s setup    tests/test_ext_viewcode.py::test_local_source_files\n\n(5 durations < 0.005s hidden.  Use -vv to show these durations.)\n\x1b[36m\x1b[1m=========================== short test summary info ============================\x1b[0m\n\x1b[32mPASSED\x1b[0m tests/test_ext_viewcode.py::\x1b[1mtest_viewcode_epub_enabled\x1b[0m\n\x1b[32mPASSED\x1b[0m tests/test_ext_viewcode.py::\x1b[1mtest_linkcode\x1b[0m\n\x1b[32mPASSED\x1b[0m tests/test_ext_viewcode.py::\x1b[1mtest_local_source_files\x1b[0m\n\x1b[31mFAILED\x1b[0m tests/test_ext_viewcode.py::\x1b[1mtest_viewcode\x1b[0m - assert \'<div class="viewcode-block" id="Class1"><a class="viewcode-back" hr...\n\x1b[31mFAILED\x1b[0m tests/test_ext_viewcode.py::\x1b[1mtest_viewcode_epub_disabled\x1b[0m - AssertionError: assert not True\n\x1b[31m================== \x1b[31m\x1b[1m2 failed\x1b[0m, \x1b[32m3 passed\x1b[0m, \x1b[33m1024 warnings\x1b[0m\x1b[31m in 1.49s\x1b[0m\x1b[31m ==================\x1b[0m\npy39: exit 1 (1.95 seconds) /testbed> python -X dev -m pytest -rA --durations 25 tests/test_ext_viewcode.py pid=870\n  py39: FAIL code 1 (1.96=setup[0.01]+cmd[1.95] seconds)\n  evaluation failed :( (2.04 seconds)'}]}]
